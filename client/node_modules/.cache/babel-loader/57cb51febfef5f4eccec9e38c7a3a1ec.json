{"ast":null,"code":"import _slicedToArray from\"D:/Programming/Project/Music_Recommend_System/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Suspense,useEffect,useState}from'react';import{Layout,Menu,Skeleton}from'antd';import axios from'axios';import PubSub from'pubsub-js';import{PlusCircleOutlined}from'@ant-design/icons';import{renderRoutes}from'react-router-config';import{getToken}from'../../utils/auth';import{SERVER_URL}from'../../utils/constant';import{showNotification}from\"../../utils/common\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Content=Layout.Content,Sider=Layout.Sider;var SubMenu=Menu.SubMenu;export default function MyMusic(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),collectionLists=_useState2[0],setCollectionLists=_useState2[1];useEffect(function(){PubSub.subscribe('getCollectionList',getCollectionList);getCollectionList();return function(){PubSub.unsubscribe('getCollectionList');};// eslint-disable-next-line\n},[]);var handleClick=function handleClick(obj){if(obj.key==='recommend'){props.history.push('/my_music/recommend');}else if(obj.key==='newList'){PubSub.publish('showNewCollectionListModal');getCollectionList();}else if(obj.key==='ranking'){props.history.push('/my_music/ranking');}else{props.history.push('/my_music/collection_list/'+obj.key);}};var getCollectionList=function getCollectionList(){axios({method:'GET',url:SERVER_URL+'collection_list',headers:{Authorization:getToken()}}).then(function(response){if(response.data.status===401){PubSub.publish('logout');props.history.push('/');showNotification('请先登录');}else if(response.data.status===200){setCollectionLists(response.data.data);}else{props.history.push('/error');}});};return/*#__PURE__*/_jsxs(Layout,{style:{minHeight:'100vh'},children:[/*#__PURE__*/_jsx(Sider,{children:/*#__PURE__*/_jsxs(Menu,{mode:\"inline\",defaultSelectedKeys:\"ranking\",style:{height:'100%'},onClick:handleClick,defaultOpenKeys:['collection_list'],children:[/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u542C\\u6B4C\\u6392\\u884C\"},\"ranking\"),/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u6BCF\\u65E5\\u63A8\\u8350\"},\"recommend\"),/*#__PURE__*/_jsxs(SubMenu,{title:\"\\u6211\\u7684\\u6B4C\\u5355\",children:[/*#__PURE__*/_jsx(Menu.Item,{icon:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),children:\"\\u521B\\u5EFA\\u65B0\\u6B4C\\u5355\"},\"newList\"),/*#__PURE__*/_jsx(Menu.Divider,{}),collectionLists.map(function(list){return/*#__PURE__*/_jsx(Menu.Item,{style:{paddingLeft:'10px',height:'50px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{height:'40px',display:'flex'},children:[/*#__PURE__*/_jsx(\"img\",{alt:list.collectionListName,src:list.collectionListImg,style:{width:'40px',height:'40px',marginRight:'10px'}}),/*#__PURE__*/_jsxs(\"div\",{style:{height:'40px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{height:'20px',lineHeight:'15px',fontSize:'15px'},children:list.collectionListName}),/*#__PURE__*/_jsxs(\"div\",{style:{height:'20px',lineHeight:'21px',fontSize:'13px',color:'#999'},children:[list.collectionListLength,\"\\u9996\"]})]})]})},list.collectionListId);})]},\"collection_list\")]})}),/*#__PURE__*/_jsx(Content,{style:{padding:'0',minHeight:280},children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(Skeleton,{}),children:renderRoutes(props.route.routes)})})]});}","map":{"version":3,"sources":["D:/Programming/Project/Music_Recommend_System/client/src/pages/MyMusic/index.jsx"],"names":["React","Suspense","useEffect","useState","Layout","Menu","Skeleton","axios","PubSub","PlusCircleOutlined","renderRoutes","getToken","SERVER_URL","showNotification","Content","Sider","SubMenu","MyMusic","props","collectionLists","setCollectionLists","subscribe","getCollectionList","unsubscribe","handleClick","obj","key","history","push","publish","method","url","headers","Authorization","then","response","data","status","minHeight","height","map","list","paddingLeft","display","collectionListName","collectionListImg","width","marginRight","lineHeight","fontSize","color","collectionListLength","collectionListId","padding","route","routes"],"mappings":"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","sourcesContent":["import React, { Suspense, useEffect, useState } from 'react'\r\nimport { Layout, Menu, Skeleton } from 'antd'\r\nimport axios from 'axios';\r\nimport PubSub from 'pubsub-js';\r\nimport {PlusCircleOutlined} from '@ant-design/icons';\r\nimport {renderRoutes} from 'react-router-config';\r\nimport { getToken } from '../../utils/auth';\r\nimport { SERVER_URL } from '../../utils/constant';\r\nimport {showNotification} from \"../../utils/common\";\r\n\r\nconst { Content, Sider } = Layout;\r\nconst {SubMenu} = Menu;\r\n\r\nexport default function MyMusic(props) {\r\n    const [collectionLists, setCollectionLists] = useState([]);\r\n\r\n    useEffect(() => {\r\n        PubSub.subscribe('getCollectionList', getCollectionList);\r\n        getCollectionList();  \r\n        return () => {\r\n            PubSub.unsubscribe('getCollectionList');\r\n        }  // eslint-disable-next-line\r\n    }, []);\r\n\r\n    const handleClick = (obj) => {\r\n        if (obj.key === 'recommend') {\r\n            props.history.push('/my_music/recommend');\r\n        } else if (obj.key === 'newList') {\r\n            PubSub.publish('showNewCollectionListModal');\r\n            getCollectionList();\r\n        } else if (obj.key === 'ranking') {\r\n            props.history.push('/my_music/ranking');\r\n        } else {\r\n            props.history.push('/my_music/collection_list/' + obj.key);\r\n        }\r\n    }\r\n\r\n    const getCollectionList = () => {\r\n        axios({\r\n            method: 'GET',\r\n            url: SERVER_URL + 'collection_list',\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 401) {\r\n                PubSub.publish('logout');\r\n                props.history.push('/');\r\n                showNotification('请先登录');\r\n            } else if (response.data.status === 200) {\r\n                setCollectionLists(response.data.data);\r\n            } else {\r\n                props.history.push('/error');\r\n            }\r\n        });\r\n    }\r\n\r\n    return (\r\n        <Layout style={{minHeight: '100vh'}}>\r\n            <Sider>\r\n                <Menu mode=\"inline\" defaultSelectedKeys=\"ranking\" style={{height: '100%'}} onClick={handleClick} defaultOpenKeys={['collection_list']}>\r\n                    <Menu.Item key=\"ranking\">听歌排行</Menu.Item>\r\n                    <Menu.Item key=\"recommend\">每日推荐</Menu.Item>\r\n                    <SubMenu key=\"collection_list\" title=\"我的歌单\">\r\n                        <Menu.Item key=\"newList\" icon={<PlusCircleOutlined />}>创建新歌单</Menu.Item>\r\n                        <Menu.Divider />\r\n                        {collectionLists.map((list) => {\r\n                            return (\r\n                                <Menu.Item key={list.collectionListId} style={{paddingLeft: '10px', height: '50px'}}>\r\n                                    <div style={{height: '40px', display: 'flex'}}>\r\n                                        <img alt={list.collectionListName} src={list.collectionListImg} style={{width: '40px', height: '40px', marginRight: '10px'}} />\r\n                                        <div style={{height: '40px'}}>\r\n                                            <div style={{height: '20px', lineHeight: '15px', fontSize: '15px'}}>{list.collectionListName}</div>\r\n                                            <div style={{height: '20px', lineHeight: '21px', fontSize: '13px', color: '#999'}}>{list.collectionListLength}首</div>\r\n                                        </div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                            );\r\n                        })}\r\n                    </SubMenu>\r\n                </Menu>\r\n            </Sider>\r\n            <Content style={{ padding: '0', minHeight: 280}}>\r\n                <Suspense fallback={<Skeleton />}>{renderRoutes(props.route.routes)}</Suspense>\r\n            </Content>\r\n        </Layout>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}