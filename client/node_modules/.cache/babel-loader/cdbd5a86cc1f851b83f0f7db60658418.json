{"ast":null,"code":"var _jsxFileName = \"D:\\\\Programming\\\\React\\\\Music_Recommend_System\\\\front\\\\src\\\\pages\\\\MyMusic\\\\CollectionList\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { Image, Button, Table, Card, Modal } from 'antd';\nimport { SERVER_URL } from '../../../utils/constant';\nimport { getToken, removeToken } from '../../../utils/auth';\nimport { DeleteOutlined, ExclamationCircleOutlined, PlayCircleOutlined } from \"@ant-design/icons\";\nimport PubSub from \"pubsub-js\";\nimport { observer, useLocalObservable } from \"mobx-react\";\nimport { playBarStore } from \"../../../stores/playBarStore\";\nimport { userStore } from \"../../../stores/userStore\";\nimport { showNotification } from \"../../../utils/common\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst {\n  confirm\n} = Modal;\nconst collectionListColomns = [{\n  key: 'index',\n  render: (text, record, index) => {\n    return index + 1;\n  },\n  width: '50px'\n}, {\n  dataIndex: 'musicName',\n  key: 'musicName',\n  title: '歌曲',\n  ellipsis: true,\n  render: (text, record, index) => {\n    return /*#__PURE__*/_jsxDEV(Button, {\n      type: \"link\",\n      onClick: () => {\n        playBarStore.addMusic(record);\n      },\n      style: {\n        padding: '0'\n      },\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 21\n    }, this);\n  },\n  width: '300px'\n}, {\n  dataIndex: 'artistName',\n  key: 'artistName',\n  title: '歌手',\n  ellipsis: true,\n  render: (text, record, index) => {\n    return /*#__PURE__*/_jsxDEV(Link, {\n      to: `/artist/${record.artistId}`,\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 21\n    }, this);\n  },\n  width: '150px'\n}, {\n  dataIndex: 'albumName',\n  key: 'albumName',\n  title: '专辑',\n  ellipsis: true,\n  render: (text, record, index) => {\n    return /*#__PURE__*/_jsxDEV(Link, {\n      to: `/album/${record.albumId}`,\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 21\n    }, this);\n  },\n  width: '150px'\n}, {\n  dataIndex: 'timeLength',\n  key: 'timeLength',\n  title: '时长',\n  render: text => {\n    text = parseInt(text);\n    text /= 1000;\n    var min = Math.floor(text / 60);\n\n    if (min < 10) {\n      min = '0' + min;\n    }\n\n    var sec = Math.floor(text % 60);\n\n    if (sec < 10) {\n      sec = '0' + sec;\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      children: min + ':' + sec\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 21\n    }, this);\n  },\n  width: '100px'\n}];\n\nfunction CollectionList(props) {\n  _s();\n\n  const {\n    user,\n    setUser\n  } = useLocalObservable(() => userStore);\n  const [collectionList, setCollectionList] = useState({});\n  useEffect(() => {\n    if (user) {\n      axios({\n        method: 'GET',\n        url: SERVER_URL + 'collection_list/' + props.match.params.collection_list_id,\n        headers: {\n          Authorization: getToken()\n        }\n      }).then(response => {\n        if (response.data.status === 401) {\n          removeToken();\n          setUser(undefined);\n          props.history.push('/');\n          showNotification('请先登录');\n        } else if (response.data.status === 200) {\n          setCollectionList(response.data.data);\n        } else {\n          props.history.push('/error');\n        }\n      });\n    } else {\n      props.history.push('/');\n      showNotification('请先登录');\n    } // eslint-disable-next-line\n\n  }, [props]);\n\n  const deleteCollectionList = collectionList => {\n    confirm({\n      title: '确认删除',\n      icon: /*#__PURE__*/_jsxDEV(ExclamationCircleOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 19\n      }, this),\n      okText: '确认',\n      cancelText: '取消',\n\n      onOk() {\n        axios({\n          method: 'DELETE',\n          url: SERVER_URL + 'collection_list/' + collectionList.collectionListId,\n          headers: {\n            Authorization: getToken()\n          }\n        }).then(response => {\n          if (response.data.status === 401) {\n            removeToken();\n            setUser(undefined);\n            props.history.push('/');\n            showNotification('请先登录');\n          } else if (response.data.status === 200) {\n            PubSub.publish('getCollectionList');\n            props.history.replace('/my_music');\n          } else {\n            props.history.replace('/error');\n          }\n        });\n      }\n\n    });\n  };\n\n  const playCollectionList = collectionList => {\n    console.log(collectionList);\n\n    if (collectionList.musicVOList.length > 0) {\n      PubSub.publish('playMusicList', collectionList.musicVOList);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        height: '200px',\n        backgroundColor: 'white',\n        padding: '0 10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Image, {\n        alt: collectionList.collectionListName,\n        src: collectionList.collectionListImg,\n        width: \"200px\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '0 10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          title: collectionList.collectionListName,\n          style: {\n            width: '100%',\n            height: '120px'\n          },\n          bordered: false,\n          children: [collectionList.createDate, \" \\u521B\\u5EFA\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '40px 20px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            icon: /*#__PURE__*/_jsxDEV(PlayCircleOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 39\n            }, this),\n            type: \"primary\",\n            onClick: () => playCollectionList(collectionList),\n            style: {\n              marginRight: '20px'\n            },\n            children: \"\\u64AD\\u653E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            icon: /*#__PURE__*/_jsxDEV(DeleteOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 39\n            }, this),\n            type: \"danger\",\n            onClick: () => deleteCollectionList(collectionList),\n            children: \"\\u5220\\u9664\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      columns: collectionListColomns,\n      dataSource: collectionList.musicVOList,\n      rowKey: record => record.musicId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(CollectionList, \"YKvGY2eDTIJsiJvVqikhnbZCjXE=\", false, function () {\n  return [useLocalObservable];\n});\n\n_c = CollectionList;\nexport default _c2 = observer(CollectionList);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CollectionList\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["D:/Programming/React/Music_Recommend_System/front/src/pages/MyMusic/CollectionList/index.jsx"],"names":["React","useEffect","useState","Link","axios","Image","Button","Table","Card","Modal","SERVER_URL","getToken","removeToken","DeleteOutlined","ExclamationCircleOutlined","PlayCircleOutlined","PubSub","observer","useLocalObservable","playBarStore","userStore","showNotification","confirm","collectionListColomns","key","render","text","record","index","width","dataIndex","title","ellipsis","addMusic","padding","artistId","albumId","parseInt","min","Math","floor","sec","CollectionList","props","user","setUser","collectionList","setCollectionList","method","url","match","params","collection_list_id","headers","Authorization","then","response","data","status","undefined","history","push","deleteCollectionList","icon","okText","cancelText","onOk","collectionListId","publish","replace","playCollectionList","console","log","musicVOList","length","display","height","backgroundColor","collectionListName","collectionListImg","createDate","marginRight","musicId"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport {Link} from 'react-router-dom'\r\nimport axios from 'axios';\r\nimport {Image, Button, Table, Card, Modal} from 'antd';\r\nimport { SERVER_URL } from '../../../utils/constant';\r\nimport { getToken, removeToken } from '../../../utils/auth';\r\nimport {DeleteOutlined, ExclamationCircleOutlined, PlayCircleOutlined} from \"@ant-design/icons\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {observer, useLocalObservable} from \"mobx-react\";\r\nimport {playBarStore} from \"../../../stores/playBarStore\";\r\nimport {userStore} from \"../../../stores/userStore\";\r\nimport {showNotification} from \"../../../utils/common\";\r\n\r\nconst {confirm} = Modal;\r\nconst collectionListColomns = [\r\n    {\r\n        key: 'index',\r\n        render: (text, record, index) => {\r\n            return index + 1;\r\n        },\r\n        width: '50px'\r\n    },\r\n    {\r\n        dataIndex: 'musicName',\r\n        key: 'musicName',\r\n        title: '歌曲',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Button type=\"link\" onClick={() => {\r\n                playBarStore.addMusic(record);\r\n            }} style={{padding: '0'}}>{text}</Button>);\r\n        },\r\n        width: '300px'\r\n    },\r\n    {\r\n        dataIndex: 'artistName',\r\n        key: 'artistName',\r\n        title: '歌手',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/artist/${record.artistId}`}>{text}</Link>);\r\n        },\r\n        width: '150px'\r\n    },\r\n    {\r\n        dataIndex: 'albumName',\r\n        key: 'albumName',\r\n        title: '专辑',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/album/${record.albumId}`}>{text}</Link>);\r\n        },\r\n        width: '150px'\r\n    },\r\n    {\r\n        dataIndex: 'timeLength',\r\n        key: 'timeLength',\r\n        title: '时长',\r\n        render: (text) => {\r\n            text = parseInt(text);\r\n            text /= 1000;\r\n            var min = Math.floor(text / 60);\r\n            if (min < 10) {\r\n                min = '0' + min;\r\n            }\r\n            var sec = Math.floor(text % 60);\r\n            if (sec < 10) {\r\n                sec = '0' + sec;\r\n            }\r\n            return (<span>{min + ':' + sec}</span>);\r\n        },\r\n        width: '100px'\r\n    }\r\n];\r\n\r\nfunction CollectionList(props) {\r\n    const {user, setUser} = useLocalObservable(() => userStore);\r\n\r\n    const [collectionList, setCollectionList] = useState({});\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            axios({\r\n                method: 'GET',\r\n                url: SERVER_URL + 'collection_list/' + props.match.params.collection_list_id,\r\n                headers: {\r\n                    Authorization: getToken()\r\n                }\r\n            }).then((response) => {\r\n                if (response.data.status === 401) {\r\n                    removeToken();\r\n                    setUser(undefined);\r\n                    props.history.push('/');\r\n                    showNotification('请先登录');\r\n                } else if (response.data.status === 200) {\r\n                    setCollectionList(response.data.data);\r\n                } else {\r\n                    props.history.push('/error');\r\n                }\r\n            });\r\n        } else {\r\n            props.history.push('/');\r\n            showNotification('请先登录');\r\n        }\r\n        // eslint-disable-next-line\r\n    }, [props]);\r\n\r\n    const deleteCollectionList = (collectionList) => {\r\n        confirm({\r\n            title: '确认删除',\r\n            icon: <ExclamationCircleOutlined />,\r\n            okText: '确认',\r\n            cancelText: '取消',\r\n            onOk() {\r\n                axios({\r\n                    method: 'DELETE',\r\n                    url: SERVER_URL + 'collection_list/' + collectionList.collectionListId,\r\n                    headers: {\r\n                        Authorization: getToken()\r\n                    }\r\n                }).then((response) => {\r\n                    if (response.data.status === 401) {\r\n                        removeToken();\r\n                        setUser(undefined);\r\n                        props.history.push('/');\r\n                        showNotification('请先登录');\r\n                    } else if (response.data.status === 200) {\r\n                        PubSub.publish('getCollectionList');\r\n                        props.history.replace('/my_music');\r\n                    } else {\r\n                        props.history.replace('/error');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    const playCollectionList = (collectionList) => {\r\n        console.log(collectionList);\r\n        if (collectionList.musicVOList.length > 0) {\r\n            PubSub.publish('playMusicList', collectionList.musicVOList);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div style={{display: 'flex', height: '200px', backgroundColor: 'white', padding: '0 10px'}}>\r\n                <Image alt={collectionList.collectionListName} src={collectionList.collectionListImg} width=\"200px\"/>\r\n                <div style={{padding: '0 10px'}}>\r\n                    <Card title={collectionList.collectionListName} style={{width: '100%', height: '120px'}} bordered={false}>\r\n                        {collectionList.createDate} 创建\r\n                    </Card>\r\n                    <div style={{padding: '40px 20px'}}>\r\n                        <Button icon={<PlayCircleOutlined />} type=\"primary\" onClick={() => playCollectionList(collectionList)} style={{marginRight: '20px'}}>播放</Button>\r\n                        <Button icon={<DeleteOutlined />} type=\"danger\" onClick={() =>deleteCollectionList(collectionList)}>删除</Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <Table columns={collectionListColomns} dataSource={collectionList.musicVOList} rowKey={record => record.musicId} />\r\n        </>\r\n    );\r\n}\r\n\r\nexport default observer(CollectionList);\r\n"]},"metadata":{},"sourceType":"module"}