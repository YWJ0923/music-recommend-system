{"ast":null,"code":"import _slicedToArray from\"D:/Programming/Project/Music_Recommend_System/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import axios from'axios';import{Image,Button,Table,Card,Modal}from'antd';import{SERVER_URL}from'../../../utils/constant';import{getToken}from'../../../utils/auth';import{DeleteOutlined,ExclamationCircleOutlined,PlayCircleOutlined}from\"@ant-design/icons\";import PubSub from\"pubsub-js\";import{playBarStore}from\"../../../stores/playBarStore\";import{showNotification}from\"../../../utils/common\";import{useLocalObservable}from\"mobx-react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var confirm=Modal.confirm;var collectionListColomns=[{key:'index',render:function render(text,record,index){return index+1;},width:'50px'},{dataIndex:'musicName',key:'musicName',title:'歌曲',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:function onClick(){playBarStore.addMusic(record);},style:{padding:'0'},children:text});},width:'300px'},{dataIndex:'artistName',key:'artistName',title:'歌手',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/artist/\".concat(record.artistId),children:text});},width:'150px'},{dataIndex:'albumName',key:'albumName',title:'专辑',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/album/\".concat(record.albumId),children:text});},width:'150px'},{dataIndex:'timeLength',key:'timeLength',title:'时长',render:function render(text){text=parseInt(text);text/=1000;var min=Math.floor(text/60);if(min<10){min='0'+min;}var sec=Math.floor(text%60);if(sec<10){sec='0'+sec;}return/*#__PURE__*/_jsx(\"span\",{children:min+':'+sec});},width:'100px'}];export default function CollectionList(props){var _useLocalObservable=useLocalObservable(function(){return playBarStore;}),addPlayList=_useLocalObservable.addPlayList;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),collectionList=_useState2[0],setCollectionList=_useState2[1];useEffect(function(){axios({method:'GET',url:SERVER_URL+'collection_list/'+props.match.params.collection_list_id,headers:{Authorization:getToken()}}).then(function(response){if(response.data.status===401){PubSub.publish('logout');props.history.push('/');showNotification('请先登录');}else if(response.data.status===200){setCollectionList(response.data.data);}else{props.history.push('/error');}});// eslint-disable-next-line\n},[props]);var deleteCollectionList=function deleteCollectionList(collectionList){confirm({title:'确认删除',icon:/*#__PURE__*/_jsx(ExclamationCircleOutlined,{}),okText:'确认',cancelText:'取消',onOk:function onOk(){axios({method:'DELETE',url:SERVER_URL+'collection_list/'+collectionList.collectionListId,headers:{Authorization:getToken()}}).then(function(response){if(response.data.status===401){PubSub.publish('logout');props.history.push('/');showNotification('请先登录');}else if(response.data.status===200){PubSub.publish('getCollectionList');props.history.replace('/my_music');}else{props.history.replace('/error');}});}});};var playCollectionList=function playCollectionList(collectionList){console.log(collectionList);if(collectionList.musicVOList.length>0){addPlayList(collectionList.musicVOList);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',height:'200px',backgroundColor:'white',padding:'0 10px'},children:[/*#__PURE__*/_jsx(Image,{alt:collectionList.collectionListName,src:collectionList.collectionListImg,width:\"200px\"}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'0 10px'},children:[/*#__PURE__*/_jsxs(Card,{title:collectionList.collectionListName,style:{width:'100%',height:'120px'},bordered:false,children:[collectionList.createDate,\" \\u521B\\u5EFA\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'40px 20px'},children:[/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(PlayCircleOutlined,{}),type:\"primary\",onClick:function onClick(){return playCollectionList(collectionList);},style:{marginRight:'20px'},children:\"\\u64AD\\u653E\\u5168\\u90E8\"}),/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),type:\"danger\",onClick:function onClick(){return deleteCollectionList(collectionList);},children:\"\\u5220\\u9664\\u6B4C\\u5355\"})]})]})]}),/*#__PURE__*/_jsx(Table,{columns:collectionListColomns,dataSource:collectionList.musicVOList,rowKey:function rowKey(record){return record.musicId;}})]});}","map":{"version":3,"sources":["D:/Programming/Project/Music_Recommend_System/client/src/pages/MyMusic/CollectionList/index.jsx"],"names":["React","useEffect","useState","Link","axios","Image","Button","Table","Card","Modal","SERVER_URL","getToken","DeleteOutlined","ExclamationCircleOutlined","PlayCircleOutlined","PubSub","playBarStore","showNotification","useLocalObservable","confirm","collectionListColomns","key","render","text","record","index","width","dataIndex","title","ellipsis","addMusic","padding","artistId","albumId","parseInt","min","Math","floor","sec","CollectionList","props","addPlayList","collectionList","setCollectionList","method","url","match","params","collection_list_id","headers","Authorization","then","response","data","status","publish","history","push","deleteCollectionList","icon","okText","cancelText","onOk","collectionListId","replace","playCollectionList","console","log","musicVOList","length","display","height","backgroundColor","collectionListName","collectionListImg","createDate","marginRight","musicId"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport {Link} from 'react-router-dom'\r\nimport axios from 'axios';\r\nimport {Image, Button, Table, Card, Modal} from 'antd';\r\nimport { SERVER_URL } from '../../../utils/constant';\r\nimport { getToken } from '../../../utils/auth';\r\nimport {DeleteOutlined, ExclamationCircleOutlined, PlayCircleOutlined} from \"@ant-design/icons\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {playBarStore} from \"../../../stores/playBarStore\";\r\nimport {showNotification} from \"../../../utils/common\";\r\nimport {useLocalObservable} from \"mobx-react\";\r\n\r\nconst {confirm} = Modal;\r\nconst collectionListColomns = [\r\n    {\r\n        key: 'index',\r\n        render: (text, record, index) => {\r\n            return index + 1;\r\n        },\r\n        width: '50px'\r\n    },\r\n    {\r\n        dataIndex: 'musicName',\r\n        key: 'musicName',\r\n        title: '歌曲',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Button type=\"link\" onClick={() => {\r\n                playBarStore.addMusic(record);\r\n            }} style={{padding: '0'}}>{text}</Button>);\r\n        },\r\n        width: '300px'\r\n    },\r\n    {\r\n        dataIndex: 'artistName',\r\n        key: 'artistName',\r\n        title: '歌手',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/artist/${record.artistId}`}>{text}</Link>);\r\n        },\r\n        width: '150px'\r\n    },\r\n    {\r\n        dataIndex: 'albumName',\r\n        key: 'albumName',\r\n        title: '专辑',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/album/${record.albumId}`}>{text}</Link>);\r\n        },\r\n        width: '150px'\r\n    },\r\n    {\r\n        dataIndex: 'timeLength',\r\n        key: 'timeLength',\r\n        title: '时长',\r\n        render: (text) => {\r\n            text = parseInt(text);\r\n            text /= 1000;\r\n            var min = Math.floor(text / 60);\r\n            if (min < 10) {\r\n                min = '0' + min;\r\n            }\r\n            var sec = Math.floor(text % 60);\r\n            if (sec < 10) {\r\n                sec = '0' + sec;\r\n            }\r\n            return (<span>{min + ':' + sec}</span>);\r\n        },\r\n        width: '100px'\r\n    }\r\n];\r\n\r\nexport default function CollectionList(props) {\r\n    const {addPlayList} = useLocalObservable(() => playBarStore);\r\n\r\n    const [collectionList, setCollectionList] = useState({});\r\n\r\n    useEffect(() => {\r\n        axios({\r\n            method: 'GET',\r\n            url: SERVER_URL + 'collection_list/' + props.match.params.collection_list_id,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 401) {\r\n                PubSub.publish('logout');\r\n                props.history.push('/');\r\n                showNotification('请先登录');\r\n            } else if (response.data.status === 200) {\r\n                setCollectionList(response.data.data);\r\n            } else {\r\n                props.history.push('/error');\r\n            }\r\n        });\r\n        // eslint-disable-next-line\r\n    }, [props]);\r\n\r\n    const deleteCollectionList = (collectionList) => {\r\n        confirm({\r\n            title: '确认删除',\r\n            icon: <ExclamationCircleOutlined />,\r\n            okText: '确认',\r\n            cancelText: '取消',\r\n            onOk() {\r\n                axios({\r\n                    method: 'DELETE',\r\n                    url: SERVER_URL + 'collection_list/' + collectionList.collectionListId,\r\n                    headers: {\r\n                        Authorization: getToken()\r\n                    }\r\n                }).then((response) => {\r\n                    if (response.data.status === 401) {\r\n                        PubSub.publish('logout');\r\n                        props.history.push('/');\r\n                        showNotification('请先登录');\r\n                    } else if (response.data.status === 200) {\r\n                        PubSub.publish('getCollectionList');\r\n                        props.history.replace('/my_music');\r\n                    } else {\r\n                        props.history.replace('/error');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    const playCollectionList = (collectionList) => {\r\n        console.log(collectionList);\r\n        if (collectionList.musicVOList.length > 0) {\r\n            addPlayList(collectionList.musicVOList);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div style={{display: 'flex', height: '200px', backgroundColor: 'white', padding: '0 10px'}}>\r\n                <Image alt={collectionList.collectionListName} src={collectionList.collectionListImg} width=\"200px\"/>\r\n                <div style={{padding: '0 10px'}}>\r\n                    <Card title={collectionList.collectionListName} style={{width: '100%', height: '120px'}} bordered={false}>\r\n                        {collectionList.createDate} 创建\r\n                    </Card>\r\n                    <div style={{padding: '40px 20px'}}>\r\n                        <Button icon={<PlayCircleOutlined />} type=\"primary\" onClick={() => playCollectionList(collectionList)} style={{marginRight: '20px'}}>播放全部</Button>\r\n                        <Button icon={<DeleteOutlined />} type=\"danger\" onClick={() =>deleteCollectionList(collectionList)}>删除歌单</Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <Table columns={collectionListColomns} dataSource={collectionList.musicVOList} rowKey={record => record.musicId} />\r\n        </>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}