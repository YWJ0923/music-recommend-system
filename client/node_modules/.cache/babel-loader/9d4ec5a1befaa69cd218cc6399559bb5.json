{"ast":null,"code":"var _jsxFileName = \"D:\\\\Programming\\\\Project\\\\MusicRecommendSystem\\\\front\\\\src\\\\components\\\\PlayBar\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification, Slider } from 'antd';\nimport PubSub from 'pubsub-js';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { getToken, removeToken } from '../../utils/auth';\nimport { SERVER_URL } from '../../utils/constant';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function PlayBar(props) {\n  _s();\n\n  const [playList, setPlayList] = useState([]);\n  const [index, setIndex] = useState(undefined);\n  const [isPaused, setIsPaused] = useState(true);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [beginTime, setBeginTime] = useState(undefined);\n  const [duration, setDuration] = useState(0);\n  const [volume, setVolume] = useState(0.8);\n  const [collectionList, setCollectionList] = useState([]);\n  const [isCollectionListModalVisible, setIsCollectionListModalVisible] = useState(false);\n  const [isNewCollectionListModalVisible, setIsNewCollectionListModalVisible] = useState(false);\n  const audio1 = useRef(null);\n  useEffect(() => {\n    PubSub.subscribe('play', playMusic);\n    return () => {\n      PubSub.unsubscribe('play');\n    }; // eslint-disable-next-line\n  }, []); // 收到通知，播放音乐，data为music对象\n\n  const playMusic = (message, data) => {\n    console.log(data);\n    addPlayTimes();\n\n    for (let i = 0; i < playList.length; i++) {\n      if (playList[i].musicId === data.musicId) {\n        setIndex(i);\n        return;\n      }\n    }\n\n    console.log([...playList, data]);\n    setPlayList(...playList, data);\n    setIndex(playList.length - 1);\n    console.log(index);\n    console.log(playList);\n  };\n\n  const playBackward = () => {\n    addPlayTimes();\n\n    if (playList.length === 1) {\n      audio1.current.currentTime = 0;\n      audio1.current.play();\n    } else {\n      const newIndex = (index - 1 + playList.length) % playList.length;\n      setIndex(newIndex);\n    }\n  };\n\n  const playOrPause = () => {\n    isPaused ? audio1.current.play() : audio1.current.pause();\n    setIsPaused(!isPaused);\n  };\n\n  const playForward = () => {\n    addPlayTimes();\n\n    if (playList.length === 1) {\n      audio1.current.currentTime = 0;\n      audio1.current.play();\n    } else {\n      const newIndex = (index + 1) % playList.length;\n      setIndex(newIndex);\n    }\n  }; // 播放列表切换歌\n\n\n  const changeMusic = obj => {\n    // console.log(obj.key);\n    addPlayTimes();\n    const newIndex = playList.findIndex(music => {\n      return music.musicId === obj.key;\n    });\n    setIndex(newIndex);\n  }; // 播放列表\n\n\n  const createPlayList = () => {\n    if (playList.length > 0) {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        selectedKeys: [playList[index].musicId],\n        onClick: changeMusic,\n        style: {\n          width: '800px',\n          height: '300px',\n          overflow: 'scroll',\n          overflowX: 'hidden'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          style: {\n            width: '750px'\n          },\n          children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", playList.length, \")\"]\n        }, \"title\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 21\n        }, this), playList.map(music => {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '450px'\n                  },\n                  children: music.musicName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 99,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '250px'\n                  },\n                  children: music.artistName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 100,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '50px'\n                  },\n                  children: parseTime(music.timeLength / 1000)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 37\n              }, this)\n            }, music.musicId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          style: {\n            width: '650px'\n          },\n          children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", playList.length, \")\"]\n        }, \"title\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this);\n    }\n  }; // 音乐加载完毕，可以播放\n\n\n  const canPlay = () => {\n    setIsPaused(false);\n    setBeginTime(new Date().getTime());\n    setDuration(audio1.current.duration);\n    audio1.current.play();\n  }; // audio更新state时间\n\n\n  const updatePlayTime = () => {\n    setCurrentTime(audio1.current.currentTime);\n  }; // 停留时间超过30秒，增加播放量、用户播放量，换歌的时候执行\n\n\n  const addPlayTimes = () => {\n    if (playList.length > 0) {\n      const endTime = new Date().getTime();\n\n      if (endTime - beginTime >= 30000) {\n        axios({\n          method: 'POST',\n          url: SERVER_URL + 'music/play_times/' + playList[index].musicId\n        }).then(response => {// console.log(response.data);\n        });\n\n        if (props.user) {\n          axios({\n            method: 'POST',\n            url: SERVER_URL + 'user/music/play_times/' + playList[index].musicId,\n            headers: {\n              Authorization: getToken()\n            }\n          }).then(response => {\n            if (response.data.status === 2) {\n              removeToken();\n            }\n          });\n        }\n      }\n    }\n  }; // 拖动条改变时间\n\n\n  const changePlayTime = value => {\n    audio1.current.currentTime = value;\n  }; // 解析时间成00:00格式, time以秒为单位\n\n\n  const parseTime = time => {\n    var min = Math.floor(time / 60);\n\n    if (min < 10) {\n      min = '0' + min;\n    }\n\n    var sec = Math.floor(time % 60);\n\n    if (sec < 10) {\n      sec = '0' + sec;\n    }\n\n    return min + ':' + sec;\n  }; // audio更新音量\n\n\n  const updateVolume = () => {\n    setVolume(audio1.current.volume);\n  }; // 静音或者音量最大\n\n\n  const mute = () => {\n    audio1.current.volume = audio1.current.volume > 0 ? 0 : 1;\n  }; // 拖动条改变音量\n\n\n  const changeVolume = value => {\n    audio1.current.volume = value;\n  };\n\n  const showCollectionListModal = () => {\n    if (!props.user) {\n      PubSub.publish('showLoginModal');\n    } else {\n      axios({\n        method: 'GET',\n        url: SERVER_URL + 'server/collection_list',\n        headers: {\n          Authorization: getToken()\n        }\n      }).then(response => {\n        if (response.data.status !== 1) {\n          PubSub.publish('logout');\n          PubSub.publish('showLoginModal');\n        } else {\n          setCollectionList(response.data.data);\n          setIsCollectionListModalVisible(true);\n        }\n      });\n    }\n  };\n\n  const closeCollectionListModal = () => {\n    setIsCollectionListModalVisible(false);\n  };\n\n  const showNewCollectionListModal = () => {\n    setIsCollectionListModalVisible(false);\n    setIsNewCollectionListModalVisible(true);\n  };\n\n  const closeNewCollectionListModal = () => {\n    setIsNewCollectionListModalVisible(false);\n  };\n\n  const handleCollection = obj => {\n    if (playList.length > 0) {\n      const music = playList[index];\n\n      if (obj.key === 'newList') {\n        showNewCollectionListModal();\n      } else {\n        insertMusicToCollectionList(obj.key, music.musicId);\n      }\n    }\n\n    closeCollectionListModal();\n  };\n\n  const insertMusicToCollectionList = (collectionListId, musicId) => {\n    axios({\n      method: 'POST',\n      url: SERVER_URL + 'collection_list/' + collectionListId + '/' + musicId,\n      headers: {\n        Authorization: getToken()\n      }\n    }).then(response => {\n      if (response.data.status === 2) {\n        PubSub.publish('logout');\n      } else if (response.data.status === 1) {\n        showNotification(response.data.message);\n      }\n    });\n  };\n\n  const insertCollectionList = values => {\n    axios({\n      method: 'POST',\n      url: SERVER_URL + 'server/collection_list/' + values.collectionListName,\n      headers: {\n        Authorization: getToken()\n      }\n    }).then(response => {\n      if (response.data.status === 2) {\n        PubSub.publish('logout');\n      } else if (response.data.status === 1) {\n        insertMusicToCollectionList(response.data.data, playList[index].musicId);\n      }\n    });\n    closeNewCollectionListModal();\n  };\n\n  const showNotification = message => {\n    notification.open({\n      message: message,\n      placement: 'bottomRight',\n      duration: 2\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        left: 0,\n        bottom: 0,\n        height: '60px',\n        backgroundColor: 'black',\n        width: '100%'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: '5px auto',\n          width: '1000px',\n          display: 'flex'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playBackward,\n          children: /*#__PURE__*/_jsxDEV(StepBackwardOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '25px',\n              marginTop: '-2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playOrPause,\n          size: \"large\",\n          children: isPaused ? /*#__PURE__*/_jsxDEV(CaretRightOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '32px',\n              marginLeft: '4px',\n              marginTop: '-4px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 37\n          }, this) : /*#__PURE__*/_jsxDEV(PauseOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '32px',\n              marginLeft: '0',\n              marginTop: '-4.5px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 143\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playForward,\n          children: /*#__PURE__*/_jsxDEV(StepForwardOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '25px',\n              marginTop: '-2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 21\n        }, this), playList.length > 0 ? /*#__PURE__*/_jsxDEV(Link, {\n          to: `/album/${playList[index].albumId}`,\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: playList[index].musicName,\n            src: playList[index].albumImg,\n            style: {\n              width: '50px',\n              height: '50px',\n              margin: '0 10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"718\\u97F3\\u4E50\",\n          src: \"/favicon.ico\",\n          style: {\n            width: '50px',\n            height: '50px',\n            margin: '0 10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '550px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#e8e8e8'\n            },\n            children: [playList.length > 0 ? playList[index].musicName : '718音乐', playList.length > 0 && /*#__PURE__*/_jsxDEV(Link, {\n              to: `/artist/${playList[index].artistId}`,\n              style: {\n                color: '#9b9b9b'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: '10px',\n                  marginLeft: '20px'\n                },\n                children: playList[index].artistName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 129\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 53\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"barAndTime\",\n            style: {\n              marginTop: '8px',\n              width: '550px',\n              display: 'flex'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bar\",\n              style: {\n                width: '450px',\n                height: '10px',\n                marginTop: '7px',\n                display: 'flex'\n              },\n              children: /*#__PURE__*/_jsxDEV(Slider, {\n                max: duration,\n                value: currentTime,\n                style: {\n                  height: '10px',\n                  width: '450px',\n                  marginTop: '1px'\n                },\n                onChange: changePlayTime\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"time\",\n              style: {\n                color: 'white',\n                marginLeft: '5px'\n              },\n              children: [parseTime(currentTime), \"/\", parseTime(duration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: 'auto 5px'\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            icon: /*#__PURE__*/_jsxDEV(HeartOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 39\n            }, this),\n            title: \"\\u6536\\u85CF\",\n            ghost: true,\n            size: \"small\",\n            style: {\n              border: '0'\n            },\n            onClick: showCollectionListModal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n          overlay: createPlayList,\n          placement: \"topCenter\",\n          arrow: true,\n          getPopupContainer: () => document.getElementById('playBar'),\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              marginTop: '10px',\n              border: '0'\n            },\n            icon: /*#__PURE__*/_jsxDEV(UnorderedListOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 80\n            }, this),\n            ghost: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"volumeCtrl\",\n          style: {\n            marginLeft: '10px',\n            display: 'flex'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            icon: volume !== 0 ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-volume-up\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 54\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-volume-off\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 92\n            }, this),\n            style: {\n              marginTop: '10px',\n              border: '0'\n            },\n            ghost: true,\n            onClick: mute\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            max: 1,\n            value: volume,\n            onChange: changeVolume,\n            step: 0.01,\n            style: {\n              width: '100px',\n              marginTop: '20px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      src: playList.length > 0 ? playList[index].playUrl : '',\n      proload: \"auto\",\n      onCanPlay: canPlay,\n      onTimeUpdate: updatePlayTime,\n      onVolumeChange: updateVolume,\n      onEnded: playForward,\n      ref: audio1\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u6DFB\\u52A0\\u5230\\u6B4C\\u5355\",\n      onCancel: closeCollectionListModal,\n      visible: isCollectionListModalVisible,\n      okText: \"\\u786E\\u8BA4\",\n      cancelText: \"\\u53D6\\u6D88\",\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(Menu, {\n        onClick: handleCollection,\n        style: {\n          width: '480px',\n          height: '400px',\n          overflow: 'scroll',\n          overflowX: 'hidden'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          icon: /*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 52\n          }, this),\n          children: \"\\u65B0\\u6B4C\\u5355\"\n        }, \"newList\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 21\n        }, this), collectionList.map(list => {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n              style: {\n                height: '50px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Image, {\n                  style: {\n                    width: '50px',\n                    height: '50px'\n                  },\n                  src: list.collectionListImg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '250px',\n                    margin: 'auto 20px'\n                  },\n                  children: list.collectionListName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '100px',\n                    margin: 'auto 10px'\n                  },\n                  children: list.musicVOList.length + '首'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 37\n              }, this)\n            }, list.collectionListId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u65B0\\u5EFA\\u6B4C\\u5355\",\n      onCancel: closeNewCollectionListModal,\n      visible: isNewCollectionListModalVisible,\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        onFinish: insertCollectionList,\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u6B4C\\u5355\\u540D\",\n          name: \"collectionListName\",\n          rules: [{\n            required: true,\n            message: '歌单名不能为空'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          wrapperCol: {\n            offset: 8,\n            span: 16\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            children: \"\\u65B0\\u5EFA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(PlayBar, \"cFAgLvXa///2CZVTGV5jSvZVOlQ=\");\n\n_c = PlayBar;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlayBar\");","map":{"version":3,"sources":["D:/Programming/Project/MusicRecommendSystem/front/src/components/PlayBar/index.jsx"],"names":["React","useEffect","useState","useRef","StepBackwardOutlined","StepForwardOutlined","CaretRightOutlined","PauseOutlined","UnorderedListOutlined","HeartOutlined","PlusCircleOutlined","Button","Dropdown","Menu","Modal","Image","Form","Input","notification","Slider","PubSub","axios","Link","getToken","removeToken","SERVER_URL","PlayBar","props","playList","setPlayList","index","setIndex","undefined","isPaused","setIsPaused","currentTime","setCurrentTime","beginTime","setBeginTime","duration","setDuration","volume","setVolume","collectionList","setCollectionList","isCollectionListModalVisible","setIsCollectionListModalVisible","isNewCollectionListModalVisible","setIsNewCollectionListModalVisible","audio1","subscribe","playMusic","unsubscribe","message","data","console","log","addPlayTimes","i","length","musicId","playBackward","current","play","newIndex","playOrPause","pause","playForward","changeMusic","obj","findIndex","music","key","createPlayList","width","height","overflow","overflowX","map","display","musicName","artistName","parseTime","timeLength","canPlay","Date","getTime","updatePlayTime","endTime","method","url","then","response","user","headers","Authorization","status","changePlayTime","value","time","min","Math","floor","sec","updateVolume","mute","changeVolume","showCollectionListModal","publish","closeCollectionListModal","showNewCollectionListModal","closeNewCollectionListModal","handleCollection","insertMusicToCollectionList","collectionListId","showNotification","insertCollectionList","values","collectionListName","open","placement","position","left","bottom","backgroundColor","margin","borderWidth","color","fontSize","marginTop","marginLeft","albumId","albumImg","artistId","border","document","getElementById","playUrl","list","collectionListImg","musicVOList","required","offset","span"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,MAArC,QAAmD,OAAnD;AACA,SAAQC,oBAAR,EAA8BC,mBAA9B,EAAmDC,kBAAnD,EAAuEC,aAAvE,EAAsFC,qBAAtF,EAA6GC,aAA7G,EAA4HC,kBAA5H,QAAqJ,mBAArJ;AACA,SAASC,MAAT,EAAiBC,QAAjB,EAA2BC,IAA3B,EAAiCC,KAAjC,EAAwCC,KAAxC,EAA+CC,IAA/C,EAAqDC,KAArD,EAA4DC,YAA5D,EAA0EC,MAA1E,QAAwF,MAAxF;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,QAAT,EAAmBC,WAAnB,QAAsC,kBAAtC;AACA,SAASC,UAAT,QAA2B,sBAA3B;;;AAEA,eAAe,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;AAAA;;AACnC,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0B3B,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAAC4B,KAAD,EAAQC,QAAR,IAAoB7B,QAAQ,CAAC8B,SAAD,CAAlC;AACA,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BhC,QAAQ,CAAC,IAAD,CAAxC;AACA,QAAM,CAACiC,WAAD,EAAcC,cAAd,IAAgClC,QAAQ,CAAC,CAAD,CAA9C;AACA,QAAM,CAACmC,SAAD,EAAYC,YAAZ,IAA4BpC,QAAQ,CAAC8B,SAAD,CAA1C;AACA,QAAM,CAACO,QAAD,EAAWC,WAAX,IAA0BtC,QAAQ,CAAC,CAAD,CAAxC;AACA,QAAM,CAACuC,MAAD,EAASC,SAAT,IAAsBxC,QAAQ,CAAC,GAAD,CAApC;AACA,QAAM,CAACyC,cAAD,EAAiBC,iBAAjB,IAAsC1C,QAAQ,CAAC,EAAD,CAApD;AACA,QAAM,CAAC2C,4BAAD,EAA+BC,+BAA/B,IAAkE5C,QAAQ,CAAC,KAAD,CAAhF;AACA,QAAM,CAAC6C,+BAAD,EAAkCC,kCAAlC,IAAwE9C,QAAQ,CAAC,KAAD,CAAtF;AAEA,QAAM+C,MAAM,GAAG9C,MAAM,CAAC,IAAD,CAArB;AAEAF,EAAAA,SAAS,CAAC,MAAM;AACZmB,IAAAA,MAAM,CAAC8B,SAAP,CAAiB,MAAjB,EAAyBC,SAAzB;AACA,WAAO,MAAM;AACT/B,MAAAA,MAAM,CAACgC,WAAP,CAAmB,MAAnB;AACH,KAFD,CAFY,CAIT;AACN,GALQ,EAKN,EALM,CAAT,CAdmC,CAqBnC;;AACA,QAAMD,SAAS,GAAG,CAACE,OAAD,EAAUC,IAAV,KAAmB;AACjCC,IAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACAG,IAAAA,YAAY;;AACZ,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG9B,QAAQ,CAAC+B,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtC,UAAI9B,QAAQ,CAAC8B,CAAD,CAAR,CAAYE,OAAZ,KAAwBN,IAAI,CAACM,OAAjC,EAA0C;AACtC7B,QAAAA,QAAQ,CAAC2B,CAAD,CAAR;AACA;AACH;AACJ;;AACDH,IAAAA,OAAO,CAACC,GAAR,CAAY,CAAC,GAAG5B,QAAJ,EAAc0B,IAAd,CAAZ;AACAzB,IAAAA,WAAW,CAAC,GAAGD,QAAJ,EAAc0B,IAAd,CAAX;AACAvB,IAAAA,QAAQ,CAACH,QAAQ,CAAC+B,MAAT,GAAkB,CAAnB,CAAR;AACAJ,IAAAA,OAAO,CAACC,GAAR,CAAY1B,KAAZ;AACAyB,IAAAA,OAAO,CAACC,GAAR,CAAY5B,QAAZ;AACH,GAdD;;AAgBA,QAAMiC,YAAY,GAAG,MAAM;AACvBJ,IAAAA,YAAY;;AACZ,QAAI7B,QAAQ,CAAC+B,MAAT,KAAoB,CAAxB,EAA2B;AACvBV,MAAAA,MAAM,CAACa,OAAP,CAAe3B,WAAf,GAA6B,CAA7B;AACAc,MAAAA,MAAM,CAACa,OAAP,CAAeC,IAAf;AACH,KAHD,MAIK;AACD,YAAMC,QAAQ,GAAG,CAAClC,KAAK,GAAG,CAAR,GAAYF,QAAQ,CAAC+B,MAAtB,IAAgC/B,QAAQ,CAAC+B,MAA1D;AACA5B,MAAAA,QAAQ,CAACiC,QAAD,CAAR;AACH;AACJ,GAVD;;AAYA,QAAMC,WAAW,GAAG,MAAM;AACtBhC,IAAAA,QAAQ,GAAGgB,MAAM,CAACa,OAAP,CAAeC,IAAf,EAAH,GAA2Bd,MAAM,CAACa,OAAP,CAAeI,KAAf,EAAnC;AACAhC,IAAAA,WAAW,CAAC,CAACD,QAAF,CAAX;AACH,GAHD;;AAKA,QAAMkC,WAAW,GAAG,MAAM;AACtBV,IAAAA,YAAY;;AACZ,QAAI7B,QAAQ,CAAC+B,MAAT,KAAoB,CAAxB,EAA2B;AACvBV,MAAAA,MAAM,CAACa,OAAP,CAAe3B,WAAf,GAA6B,CAA7B;AACAc,MAAAA,MAAM,CAACa,OAAP,CAAeC,IAAf;AACH,KAHD,MAIK;AACD,YAAMC,QAAQ,GAAG,CAAClC,KAAK,GAAG,CAAT,IAAcF,QAAQ,CAAC+B,MAAxC;AACA5B,MAAAA,QAAQ,CAACiC,QAAD,CAAR;AACH;AACJ,GAVD,CAvDmC,CAmEnC;;;AACA,QAAMI,WAAW,GAAIC,GAAD,IAAS;AACzB;AACAZ,IAAAA,YAAY;AACZ,UAAMO,QAAQ,GAAGpC,QAAQ,CAAC0C,SAAT,CAAoBC,KAAD,IAAW;AAC3C,aAAOA,KAAK,CAACX,OAAN,KAAkBS,GAAG,CAACG,GAA7B;AACH,KAFgB,CAAjB;AAGAzC,IAAAA,QAAQ,CAACiC,QAAD,CAAR;AACH,GAPD,CApEmC,CA6EnC;;;AACA,QAAMS,cAAc,GAAG,MAAM;AACzB,QAAI7C,QAAQ,CAAC+B,MAAT,GAAkB,CAAtB,EAAyB;AACrB,0BACI,QAAC,IAAD;AAAM,QAAA,YAAY,EAAE,CAAC/B,QAAQ,CAACE,KAAD,CAAR,CAAgB8B,OAAjB,CAApB;AAA+C,QAAA,OAAO,EAAEQ,WAAxD;AAAqE,QAAA,KAAK,EAAE;AAACM,UAAAA,KAAK,EAAE,OAAR;AAAiBC,UAAAA,MAAM,EAAE,OAAzB;AAAkCC,UAAAA,QAAQ,EAAE,QAA5C;AAAsDC,UAAAA,SAAS,EAAE;AAAjE,SAA5E;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAuB,UAAA,KAAK,EAAE;AAACH,YAAAA,KAAK,EAAE;AAAR,WAA9B;AAAA,mDAAuD9C,QAAQ,CAAC+B,MAAhE;AAAA,WAAe,OAAf;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,gBAFJ,EAGK/B,QAAQ,CAACkD,GAAT,CAAcP,KAAD,IAAW;AACrB,8BACI;AAAA,oCACI,QAAC,IAAD,CAAM,IAAN;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAE;AAACQ,kBAAAA,OAAO,EAAE;AAAV,iBAAZ;AAAA,wCACI;AAAK,kBAAA,KAAK,EAAE;AAACL,oBAAAA,KAAK,EAAE;AAAR,mBAAZ;AAAA,4BAA+BH,KAAK,CAACS;AAArC;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAK,kBAAA,KAAK,EAAE;AAACN,oBAAAA,KAAK,EAAE;AAAR,mBAAZ;AAAA,4BAA+BH,KAAK,CAACU;AAArC;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI;AAAK,kBAAA,KAAK,EAAE;AAACP,oBAAAA,KAAK,EAAE;AAAR,mBAAZ;AAAA,4BAA8BQ,SAAS,CAACX,KAAK,CAACY,UAAN,GAAmB,IAApB;AAAvC;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ,eAAgBZ,KAAK,CAACX,OAAtB;AAAA;AAAA;AAAA;AAAA,oBADJ,eAQI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,oBARJ;AAAA,0BADJ;AAYH,SAbA,CAHL;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ;AAoBH,KArBD,MAqBO;AACH,0BACI,QAAC,IAAD;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAuB,UAAA,KAAK,EAAE;AAACc,YAAAA,KAAK,EAAE;AAAR,WAA9B;AAAA,mDAAuD9C,QAAQ,CAAC+B,MAAhE;AAAA,WAAe,OAAf;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ;AAMH;AAEJ,GA/BD,CA9EmC,CA+GnC;;;AACA,QAAMyB,OAAO,GAAG,MAAM;AAClBlD,IAAAA,WAAW,CAAC,KAAD,CAAX;AACAI,IAAAA,YAAY,CAAC,IAAI+C,IAAJ,GAAWC,OAAX,EAAD,CAAZ;AACA9C,IAAAA,WAAW,CAACS,MAAM,CAACa,OAAP,CAAevB,QAAhB,CAAX;AACAU,IAAAA,MAAM,CAACa,OAAP,CAAeC,IAAf;AACH,GALD,CAhHmC,CAuHnC;;;AACA,QAAMwB,cAAc,GAAG,MAAM;AACzBnD,IAAAA,cAAc,CAACa,MAAM,CAACa,OAAP,CAAe3B,WAAhB,CAAd;AACH,GAFD,CAxHmC,CA4HnC;;;AACA,QAAMsB,YAAY,GAAG,MAAM;AACvB,QAAI7B,QAAQ,CAAC+B,MAAT,GAAkB,CAAtB,EAAyB;AACrB,YAAM6B,OAAO,GAAG,IAAIH,IAAJ,GAAWC,OAAX,EAAhB;;AACA,UAAIE,OAAO,GAAGnD,SAAV,IAAuB,KAA3B,EAAkC;AAC9BhB,QAAAA,KAAK,CAAC;AACFoE,UAAAA,MAAM,EAAE,MADN;AAEFC,UAAAA,GAAG,EAAEjE,UAAU,GAAI,mBAAd,GAAoCG,QAAQ,CAACE,KAAD,CAAR,CAAgB8B;AAFvD,SAAD,CAAL,CAGG+B,IAHH,CAGSC,QAAD,IAAc,CAClB;AACH,SALD;;AAMA,YAAIjE,KAAK,CAACkE,IAAV,EAAgB;AACZxE,UAAAA,KAAK,CAAC;AACFoE,YAAAA,MAAM,EAAE,MADN;AAEFC,YAAAA,GAAG,EAAEjE,UAAU,GAAI,wBAAd,GAAyCG,QAAQ,CAACE,KAAD,CAAR,CAAgB8B,OAF5D;AAGFkC,YAAAA,OAAO,EAAE;AACLC,cAAAA,aAAa,EAAExE,QAAQ;AADlB;AAHP,WAAD,CAAL,CAMGoE,IANH,CAMSC,QAAD,IAAc;AAClB,gBAAIA,QAAQ,CAACtC,IAAT,CAAc0C,MAAd,KAAyB,CAA7B,EAAgC;AAC5BxE,cAAAA,WAAW;AACd;AACJ,WAVD;AAWH;AACJ;AACJ;AACJ,GAzBD,CA7HmC,CAwJnC;;;AACA,QAAMyE,cAAc,GAAIC,KAAD,IAAW;AAC9BjD,IAAAA,MAAM,CAACa,OAAP,CAAe3B,WAAf,GAA6B+D,KAA7B;AACH,GAFD,CAzJmC,CA6JnC;;;AACA,QAAMhB,SAAS,GAAIiB,IAAD,IAAU;AACxB,QAAIC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWH,IAAI,GAAG,EAAlB,CAAV;;AACA,QAAIC,GAAG,GAAG,EAAV,EAAc;AACVA,MAAAA,GAAG,GAAG,MAAMA,GAAZ;AACH;;AACD,QAAIG,GAAG,GAAGF,IAAI,CAACC,KAAL,CAAWH,IAAI,GAAG,EAAlB,CAAV;;AACA,QAAII,GAAG,GAAG,EAAV,EAAc;AACVA,MAAAA,GAAG,GAAG,MAAMA,GAAZ;AACH;;AACD,WAAOH,GAAG,GAAG,GAAN,GAAYG,GAAnB;AACH,GAVD,CA9JmC,CA0KnC;;;AACA,QAAMC,YAAY,GAAG,MAAM;AACvB9D,IAAAA,SAAS,CAACO,MAAM,CAACa,OAAP,CAAerB,MAAhB,CAAT;AACH,GAFD,CA3KmC,CA+KnC;;;AACA,QAAMgE,IAAI,GAAG,MAAM;AACfxD,IAAAA,MAAM,CAACa,OAAP,CAAerB,MAAf,GAAwBQ,MAAM,CAACa,OAAP,CAAerB,MAAf,GAAwB,CAAxB,GAA4B,CAA5B,GAAgC,CAAxD;AACH,GAFD,CAhLmC,CAoLnC;;;AACA,QAAMiE,YAAY,GAAIR,KAAD,IAAW;AAC5BjD,IAAAA,MAAM,CAACa,OAAP,CAAerB,MAAf,GAAwByD,KAAxB;AACH,GAFD;;AAIA,QAAMS,uBAAuB,GAAG,MAAM;AAClC,QAAI,CAAChF,KAAK,CAACkE,IAAX,EAAiB;AACbzE,MAAAA,MAAM,CAACwF,OAAP,CAAe,gBAAf;AACH,KAFD,MAEM;AACFvF,MAAAA,KAAK,CAAC;AACFoE,QAAAA,MAAM,EAAE,KADN;AAEFC,QAAAA,GAAG,EAAEjE,UAAU,GAAG,wBAFhB;AAGFqE,QAAAA,OAAO,EAAE;AACLC,UAAAA,aAAa,EAAExE,QAAQ;AADlB;AAHP,OAAD,CAAL,CAMGoE,IANH,CAMSC,QAAD,IAAc;AAClB,YAAIA,QAAQ,CAACtC,IAAT,CAAc0C,MAAd,KAAyB,CAA7B,EAAgC;AAC5B5E,UAAAA,MAAM,CAACwF,OAAP,CAAe,QAAf;AACAxF,UAAAA,MAAM,CAACwF,OAAP,CAAe,gBAAf;AACH,SAHD,MAGM;AACFhE,UAAAA,iBAAiB,CAACgD,QAAQ,CAACtC,IAAT,CAAcA,IAAf,CAAjB;AACAR,UAAAA,+BAA+B,CAAC,IAAD,CAA/B;AACH;AACJ,OAdD;AAeH;AACJ,GApBD;;AAsBA,QAAM+D,wBAAwB,GAAG,MAAM;AACnC/D,IAAAA,+BAA+B,CAAC,KAAD,CAA/B;AACH,GAFD;;AAIA,QAAMgE,0BAA0B,GAAG,MAAM;AACrChE,IAAAA,+BAA+B,CAAC,KAAD,CAA/B;AACAE,IAAAA,kCAAkC,CAAC,IAAD,CAAlC;AACH,GAHD;;AAKA,QAAM+D,2BAA2B,GAAG,MAAM;AACtC/D,IAAAA,kCAAkC,CAAC,KAAD,CAAlC;AACH,GAFD;;AAIA,QAAMgE,gBAAgB,GAAI3C,GAAD,IAAS;AAC9B,QAAIzC,QAAQ,CAAC+B,MAAT,GAAkB,CAAtB,EAAyB;AACrB,YAAMY,KAAK,GAAG3C,QAAQ,CAACE,KAAD,CAAtB;;AACA,UAAIuC,GAAG,CAACG,GAAJ,KAAY,SAAhB,EAA2B;AACvBsC,QAAAA,0BAA0B;AAC7B,OAFD,MAEO;AACHG,QAAAA,2BAA2B,CAAC5C,GAAG,CAACG,GAAL,EAAUD,KAAK,CAACX,OAAhB,CAA3B;AACH;AACJ;;AACDiD,IAAAA,wBAAwB;AAC3B,GAVD;;AAYA,QAAMI,2BAA2B,GAAG,CAACC,gBAAD,EAAmBtD,OAAnB,KAA+B;AAC/DvC,IAAAA,KAAK,CAAC;AACFoE,MAAAA,MAAM,EAAE,MADN;AAEFC,MAAAA,GAAG,EAAEjE,UAAU,GAAG,kBAAb,GAAkCyF,gBAAlC,GAAqD,GAArD,GAA2DtD,OAF9D;AAGFkC,MAAAA,OAAO,EAAE;AACLC,QAAAA,aAAa,EAAExE,QAAQ;AADlB;AAHP,KAAD,CAAL,CAMGoE,IANH,CAMSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAACtC,IAAT,CAAc0C,MAAd,KAAyB,CAA7B,EAAgC;AAC5B5E,QAAAA,MAAM,CAACwF,OAAP,CAAe,QAAf;AACH,OAFD,MAEO,IAAIhB,QAAQ,CAACtC,IAAT,CAAc0C,MAAd,KAAyB,CAA7B,EAAgC;AACnCmB,QAAAA,gBAAgB,CAACvB,QAAQ,CAACtC,IAAT,CAAcD,OAAf,CAAhB;AACH;AACJ,KAZD;AAaH,GAdD;;AAgBA,QAAM+D,oBAAoB,GAAIC,MAAD,IAAY;AACrChG,IAAAA,KAAK,CAAC;AACFoE,MAAAA,MAAM,EAAE,MADN;AAEFC,MAAAA,GAAG,EAAEjE,UAAU,GAAG,yBAAb,GAAyC4F,MAAM,CAACC,kBAFnD;AAGFxB,MAAAA,OAAO,EAAE;AACLC,QAAAA,aAAa,EAAExE,QAAQ;AADlB;AAHP,KAAD,CAAL,CAMGoE,IANH,CAMSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAACtC,IAAT,CAAc0C,MAAd,KAAyB,CAA7B,EAAgC;AAC5B5E,QAAAA,MAAM,CAACwF,OAAP,CAAe,QAAf;AACH,OAFD,MAEO,IAAIhB,QAAQ,CAACtC,IAAT,CAAc0C,MAAd,KAAyB,CAA7B,EAAgC;AACnCiB,QAAAA,2BAA2B,CAACrB,QAAQ,CAACtC,IAAT,CAAcA,IAAf,EAAqB1B,QAAQ,CAACE,KAAD,CAAR,CAAgB8B,OAArC,CAA3B;AACH;AACJ,KAZD;AAaAmD,IAAAA,2BAA2B;AAC9B,GAfD;;AAiBA,QAAMI,gBAAgB,GAAI9D,OAAD,IAAa;AAClCnC,IAAAA,YAAY,CAACqG,IAAb,CAAkB;AACdlE,MAAAA,OAAO,EAAEA,OADK;AAEdmE,MAAAA,SAAS,EAAE,aAFG;AAGdjF,MAAAA,QAAQ,EAAE;AAHI,KAAlB;AAKH,GAND;;AAQA,sBACI;AAAA,4BACI;AAAK,MAAA,KAAK,EAAE;AAACkF,QAAAA,QAAQ,EAAE,OAAX;AAAoBC,QAAAA,IAAI,EAAE,CAA1B;AAA6BC,QAAAA,MAAM,EAAE,CAArC;AAAwChD,QAAAA,MAAM,EAAE,MAAhD;AAAwDiD,QAAAA,eAAe,EAAE,OAAzE;AAAkFlD,QAAAA,KAAK,EAAE;AAAzF,OAAZ;AAAA,6BACI;AAAK,QAAA,KAAK,EAAE;AAACmD,UAAAA,MAAM,EAAE,UAAT;AAAqBnD,UAAAA,KAAK,EAAE,QAA5B;AAAsCK,UAAAA,OAAO,EAAE;AAA/C,SAAZ;AAAA,gCACI,QAAC,MAAD;AAAQ,UAAA,KAAK,EAAC,QAAd;AAAuB,UAAA,KAAK,EAAE;AAAC6C,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,MAAM,EAAE,UAAnC;AAA+CC,YAAAA,WAAW,EAAE;AAA5D,WAA9B;AAAkG,UAAA,OAAO,EAAEjE,YAA3G;AAAA,iCACI,QAAC,oBAAD;AAAsB,YAAA,KAAK,EAAE;AAACkE,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCC,cAAAA,SAAS,EAAE;AAA9C;AAA7B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,MAAD;AAAQ,UAAA,KAAK,EAAC,QAAd;AAAuB,UAAA,KAAK,EAAE;AAACL,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,MAAM,EAAE,UAAnC;AAA+CC,YAAAA,WAAW,EAAE;AAA5D,WAA9B;AAAkG,UAAA,OAAO,EAAE7D,WAA3G;AAAwH,UAAA,IAAI,EAAC,OAA7H;AAAA,oBACKhC,QAAQ,gBAAG,QAAC,kBAAD;AAAoB,YAAA,KAAK,EAAE;AAAC8F,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCE,cAAAA,UAAU,EAAE,KAA/C;AAAsDD,cAAAA,SAAS,EAAE;AAAjE;AAA3B;AAAA;AAAA;AAAA;AAAA,kBAAH,gBAA6G,QAAC,aAAD;AAAe,YAAA,KAAK,EAAE;AAACF,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCE,cAAAA,UAAU,EAAE,GAA/C;AAAoDD,cAAAA,SAAS,EAAE;AAA/D;AAAtB;AAAA;AAAA;AAAA;AAAA;AAD1H;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAOI,QAAC,MAAD;AAAQ,UAAA,KAAK,EAAC,QAAd;AAAuB,UAAA,KAAK,EAAE;AAACL,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,MAAM,EAAE,UAAnC;AAA+CC,YAAAA,WAAW,EAAE;AAA5D,WAA9B;AAAkG,UAAA,OAAO,EAAE3D,WAA3G;AAAA,iCACI,QAAC,mBAAD;AAAqB,YAAA,KAAK,EAAE;AAAC4D,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCC,cAAAA,SAAS,EAAE;AAA9C;AAA5B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAPJ,EAUKrG,QAAQ,CAAC+B,MAAT,GAAkB,CAAlB,gBACD,QAAC,IAAD;AAAM,UAAA,EAAE,EAAG,UAAS/B,QAAQ,CAACE,KAAD,CAAR,CAAgBqG,OAAQ,EAA5C;AAAA,iCACI;AAAK,YAAA,GAAG,EAAEvG,QAAQ,CAACE,KAAD,CAAR,CAAgBkD,SAA1B;AAAqC,YAAA,GAAG,EAAEpD,QAAQ,CAACE,KAAD,CAAR,CAAgBsG,QAA1D;AAAoE,YAAA,KAAK,EAAE;AAAC1D,cAAAA,KAAK,EAAE,MAAR;AAAgBC,cAAAA,MAAM,EAAE,MAAxB;AAAgCkD,cAAAA,MAAM,EAAE;AAAxC;AAA3E;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADC,gBAIC;AAAK,UAAA,GAAG,EAAC,iBAAT;AAAiB,UAAA,GAAG,EAAC,cAArB;AAAoC,UAAA,KAAK,EAAE;AAACnD,YAAAA,KAAK,EAAE,MAAR;AAAgBC,YAAAA,MAAM,EAAE,MAAxB;AAAgCkD,YAAAA,MAAM,EAAE;AAAxC;AAA3C;AAAA;AAAA;AAAA;AAAA,gBAdN,eAeI;AAAK,UAAA,KAAK,EAAE;AAACnD,YAAAA,KAAK,EAAE;AAAR,WAAZ;AAAA,kCACI;AAAK,YAAA,KAAK,EAAE;AAACqD,cAAAA,KAAK,EAAE;AAAR,aAAZ;AAAA,uBACKnG,QAAQ,CAAC+B,MAAT,GAAkB,CAAlB,GAAsB/B,QAAQ,CAACE,KAAD,CAAR,CAAgBkD,SAAtC,GAAkD,OADvD,EAEKpD,QAAQ,CAAC+B,MAAT,GAAkB,CAAlB,iBAAuB,QAAC,IAAD;AAAM,cAAA,EAAE,EAAG,WAAU/B,QAAQ,CAACE,KAAD,CAAR,CAAgBuG,QAAS,EAA9C;AAAiD,cAAA,KAAK,EAAE;AAACN,gBAAAA,KAAK,EAAE;AAAR,eAAxD;AAAA,qCAA4E;AAAM,gBAAA,KAAK,EAAE;AAACC,kBAAAA,QAAQ,EAAE,MAAX;AAAmBE,kBAAAA,UAAU,EAAE;AAA/B,iBAAb;AAAA,0BAAsDtG,QAAQ,CAACE,KAAD,CAAR,CAAgBmD;AAAtE;AAAA;AAAA;AAAA;AAAA;AAA5E;AAAA;AAAA;AAAA;AAAA,oBAF5B;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAKI;AAAK,YAAA,SAAS,EAAC,YAAf;AAA4B,YAAA,KAAK,EAAE;AAACgD,cAAAA,SAAS,EAAE,KAAZ;AAAmBvD,cAAAA,KAAK,EAAE,OAA1B;AAAmCK,cAAAA,OAAO,EAAE;AAA5C,aAAnC;AAAA,oCACI;AAAK,cAAA,SAAS,EAAC,KAAf;AAAqB,cAAA,KAAK,EAAE;AAACL,gBAAAA,KAAK,EAAE,OAAR;AAAiBC,gBAAAA,MAAM,EAAE,MAAzB;AAAiCsD,gBAAAA,SAAS,EAAE,KAA5C;AAAmDlD,gBAAAA,OAAO,EAAE;AAA5D,eAA5B;AAAA,qCAEI,QAAC,MAAD;AAAQ,gBAAA,GAAG,EAAExC,QAAb;AAAuB,gBAAA,KAAK,EAAEJ,WAA9B;AAA2C,gBAAA,KAAK,EAAE;AAACwC,kBAAAA,MAAM,EAAE,MAAT;AAAiBD,kBAAAA,KAAK,EAAE,OAAxB;AAAiCuD,kBAAAA,SAAS,EAAE;AAA5C,iBAAlD;AAAsG,gBAAA,QAAQ,EAAEhC;AAAhH;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,oBADJ,eAKI;AAAK,cAAA,SAAS,EAAC,MAAf;AAAsB,cAAA,KAAK,EAAE;AAAC8B,gBAAAA,KAAK,EAAE,OAAR;AAAiBG,gBAAAA,UAAU,EAAE;AAA7B,eAA7B;AAAA,yBAAmEhD,SAAS,CAAC/C,WAAD,CAA5E,OAA4F+C,SAAS,CAAC3C,QAAD,CAArG;AAAA;AAAA;AAAA;AAAA;AAAA,oBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAfJ,eA4BI;AAAK,UAAA,KAAK,EAAE;AAACsF,YAAAA,MAAM,EAAE;AAAT,WAAZ;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,IAAI,eAAE,QAAC,aAAD;AAAA;AAAA;AAAA;AAAA,oBAAd;AAAiC,YAAA,KAAK,EAAC,cAAvC;AAA4C,YAAA,KAAK,MAAjD;AAAkD,YAAA,IAAI,EAAC,OAAvD;AAA+D,YAAA,KAAK,EAAE;AAACS,cAAAA,MAAM,EAAE;AAAT,aAAtE;AAAqF,YAAA,OAAO,EAAE3B;AAA9F;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBA5BJ,eA+BI,QAAC,QAAD;AAAU,UAAA,OAAO,EAAElC,cAAnB;AAAmC,UAAA,SAAS,EAAC,WAA7C;AAAyD,UAAA,KAAK,MAA9D;AAA+D,UAAA,iBAAiB,EAAE,MAAM8D,QAAQ,CAACC,cAAT,CAAwB,SAAxB,CAAxF;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,KAAK,EAAE;AAACP,cAAAA,SAAS,EAAE,MAAZ;AAAoBK,cAAAA,MAAM,EAAE;AAA5B,aAAf;AAAiD,YAAA,IAAI,eAAE,QAAC,qBAAD;AAAA;AAAA;AAAA;AAAA,oBAAvD;AAAkF,YAAA,KAAK;AAAvF;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBA/BJ,eAkCI;AAAK,UAAA,SAAS,EAAC,YAAf;AAA4B,UAAA,KAAK,EAAE;AAACJ,YAAAA,UAAU,EAAE,MAAb;AAAqBnD,YAAAA,OAAO,EAAE;AAA9B,WAAnC;AAAA,kCACI,QAAC,MAAD;AAAQ,YAAA,IAAI,EAAEtC,MAAM,KAAK,CAAX,gBAAe;AAAG,cAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,oBAAf,gBAAqD;AAAG,cAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,oBAAnE;AAAyG,YAAA,KAAK,EAAE;AAACwF,cAAAA,SAAS,EAAE,MAAZ;AAAoBK,cAAAA,MAAM,EAAE;AAA5B,aAAhH;AAAkJ,YAAA,KAAK,MAAvJ;AAAwJ,YAAA,OAAO,EAAE7B;AAAjK;AAAA;AAAA;AAAA;AAAA,kBADJ,eAGI,QAAC,MAAD;AAAQ,YAAA,GAAG,EAAE,CAAb;AAAgB,YAAA,KAAK,EAAEhE,MAAvB;AAA+B,YAAA,QAAQ,EAAEiE,YAAzC;AAAuD,YAAA,IAAI,EAAE,IAA7D;AAAmE,YAAA,KAAK,EAAE;AAAChC,cAAAA,KAAK,EAAE,OAAR;AAAiBuD,cAAAA,SAAS,EAAE;AAA5B;AAA1E;AAAA;AAAA;AAAA;AAAA,kBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAlCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADJ,eA2CI;AAAO,MAAA,GAAG,EAAErG,QAAQ,CAAC+B,MAAT,GAAkB,CAAlB,GAAsB/B,QAAQ,CAACE,KAAD,CAAR,CAAgB2G,OAAtC,GAAgD,EAA5D;AAAgE,MAAA,OAAO,EAAC,MAAxE;AAA+E,MAAA,SAAS,EAAErD,OAA1F;AAAmG,MAAA,YAAY,EAAEG,cAAjH;AAAiI,MAAA,cAAc,EAAEiB,YAAjJ;AAA+J,MAAA,OAAO,EAAErC,WAAxK;AAAqL,MAAA,GAAG,EAAElB;AAA1L;AAAA;AAAA;AAAA;AAAA,YA3CJ,eA4CI,QAAC,KAAD;AAAO,MAAA,KAAK,EAAC,gCAAb;AAAqB,MAAA,QAAQ,EAAE4D,wBAA/B;AAAyD,MAAA,OAAO,EAAEhE,4BAAlE;AAAgG,MAAA,MAAM,EAAC,cAAvG;AAA4G,MAAA,UAAU,EAAC,cAAvH;AAA4H,MAAA,MAAM,EAAE,IAApI;AAAA,6BACI,QAAC,IAAD;AAAM,QAAA,OAAO,EAAEmE,gBAAf;AAAiC,QAAA,KAAK,EAAE;AAACtC,UAAAA,KAAK,EAAE,OAAR;AAAiBC,UAAAA,MAAM,EAAE,OAAzB;AAAkCC,UAAAA,QAAQ,EAAE,QAA5C;AAAsDC,UAAAA,SAAS,EAAE;AAAjE,SAAxC;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAyB,UAAA,IAAI,eAAE,QAAC,kBAAD;AAAA;AAAA;AAAA;AAAA,kBAA/B;AAAA;AAAA,WAAe,SAAf;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,gBAJJ,EAKKlC,cAAc,CAACmC,GAAf,CAAoB4D,IAAD,IAAU;AAC1B,8BACI;AAAA,oCACI,QAAC,IAAD,CAAM,IAAN;AAAuC,cAAA,KAAK,EAAE;AAAC/D,gBAAAA,MAAM,EAAE;AAAT,eAA9C;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAE;AAACI,kBAAAA,OAAO,EAAE;AAAV,iBAAZ;AAAA,wCACI,QAAC,KAAD;AAAO,kBAAA,KAAK,EAAE;AAACL,oBAAAA,KAAK,EAAE,MAAR;AAAgBC,oBAAAA,MAAM,EAAE;AAAxB,mBAAd;AAA+C,kBAAA,GAAG,EAAE+D,IAAI,CAACC;AAAzD;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAK,kBAAA,KAAK,EAAE;AAACjE,oBAAAA,KAAK,EAAE,OAAR;AAAiBmD,oBAAAA,MAAM,EAAE;AAAzB,mBAAZ;AAAA,4BAAoDa,IAAI,CAACpB;AAAzD;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI;AAAK,kBAAA,KAAK,EAAE;AAAC5C,oBAAAA,KAAK,EAAE,OAAR;AAAiBmD,oBAAAA,MAAM,EAAE;AAAzB,mBAAZ;AAAA,4BAAoDa,IAAI,CAACE,WAAL,CAAiBjF,MAAjB,GAA0B;AAA9E;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ,eAAgB+E,IAAI,CAACxB,gBAArB;AAAA;AAAA;AAAA;AAAA,oBADJ,eAQI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,oBARJ;AAAA,0BADJ;AAYH,SAbA,CALL;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YA5CJ,eAkEI,QAAC,KAAD;AAAO,MAAA,KAAK,EAAC,0BAAb;AAAoB,MAAA,QAAQ,EAAEH,2BAA9B;AAA2D,MAAA,OAAO,EAAEhE,+BAApE;AAAqG,MAAA,MAAM,EAAE,IAA7G;AAAA,6BACI,QAAC,IAAD;AAAM,QAAA,QAAQ,EAAEqE,oBAAhB;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAW,UAAA,KAAK,EAAC,oBAAjB;AAAuB,UAAA,IAAI,EAAC,oBAA5B;AAAiD,UAAA,KAAK,EAAE,CAAC;AAAEyB,YAAAA,QAAQ,EAAE,IAAZ;AAAkBxF,YAAAA,OAAO,EAAE;AAA3B,WAAD,CAAxD;AAAA,iCACI,QAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,IAAD,CAAM,IAAN;AAAW,UAAA,UAAU,EAAE;AAAEyF,YAAAA,MAAM,EAAE,CAAV;AAAaC,YAAAA,IAAI,EAAE;AAAnB,WAAvB;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,IAAI,EAAC,SAAb;AAAuB,YAAA,QAAQ,EAAC,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YAlEJ;AAAA,kBADJ;AA+EH;;GAhWuBrH,O;;KAAAA,O","sourcesContent":["import React, { useEffect, useState, useRef } from 'react'\r\nimport {StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined} from '@ant-design/icons';\r\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification, Slider } from 'antd'\r\nimport PubSub from 'pubsub-js';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport { getToken, removeToken } from '../../utils/auth';\r\nimport { SERVER_URL } from '../../utils/constant';\r\n\r\nexport default function PlayBar(props) {\r\n    const [playList, setPlayList] = useState([]);\r\n    const [index, setIndex] = useState(undefined);\r\n    const [isPaused, setIsPaused] = useState(true);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [beginTime, setBeginTime] = useState(undefined);\r\n    const [duration, setDuration] = useState(0);\r\n    const [volume, setVolume] = useState(0.8);\r\n    const [collectionList, setCollectionList] = useState([]);\r\n    const [isCollectionListModalVisible, setIsCollectionListModalVisible] = useState(false);\r\n    const [isNewCollectionListModalVisible, setIsNewCollectionListModalVisible] = useState(false);\r\n\r\n    const audio1 = useRef(null);\r\n\r\n    useEffect(() => {\r\n        PubSub.subscribe('play', playMusic);\r\n        return () => {\r\n            PubSub.unsubscribe('play');\r\n        }  // eslint-disable-next-line\r\n    }, [])\r\n\r\n    // 收到通知，播放音乐，data为music对象\r\n    const playMusic = (message, data) => {\r\n        console.log(data);\r\n        addPlayTimes();\r\n        for (let i = 0; i < playList.length; i++) {\r\n            if (playList[i].musicId === data.musicId) {\r\n                setIndex(i);\r\n                return;\r\n            }\r\n        }\r\n        console.log([...playList, data]);\r\n        setPlayList(...playList, data);\r\n        setIndex(playList.length - 1);\r\n        console.log(index);\r\n        console.log(playList);  \r\n    }\r\n\r\n    const playBackward = () => {\r\n        addPlayTimes();\r\n        if (playList.length === 1) {\r\n            audio1.current.currentTime = 0\r\n            audio1.current.play();\r\n        }\r\n        else {\r\n            const newIndex = (index - 1 + playList.length) % playList.length;\r\n            setIndex(newIndex);\r\n        }\r\n    }\r\n    \r\n    const playOrPause = () => {\r\n        isPaused ? audio1.current.play() : audio1.current.pause();\r\n        setIsPaused(!isPaused);\r\n    }\r\n\r\n    const playForward = () => {\r\n        addPlayTimes();\r\n        if (playList.length === 1) {\r\n            audio1.current.currentTime = 0\r\n            audio1.current.play();\r\n        }\r\n        else {\r\n            const newIndex = (index + 1) % playList.length;\r\n            setIndex(newIndex);\r\n        }\r\n    }\r\n\r\n    // 播放列表切换歌\r\n    const changeMusic = (obj) => {\r\n        // console.log(obj.key);\r\n        addPlayTimes();\r\n        const newIndex = playList.findIndex((music) => {\r\n            return music.musicId === obj.key;\r\n        });\r\n        setIndex(newIndex);\r\n    }\r\n\r\n    // 播放列表\r\n    const createPlayList = () => {\r\n        if (playList.length > 0) {\r\n            return (\r\n                <Menu selectedKeys={[playList[index].musicId]} onClick={changeMusic} style={{width: '800px', height: '300px', overflow: 'scroll', overflowX: 'hidden'}}>\r\n                    <Menu.Item key=\"title\" style={{width: '750px'}}>播放列表 ({playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                    {playList.map((music) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={music.musicId}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <div style={{width: '450px'}}>{music.musicName}</div>\r\n                                        <div style={{width: '250px'}}>{music.artistName}</div>\r\n                                        <div style={{width: '50px'}}>{parseTime(music.timeLength / 1000)}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu>\r\n            );\r\n        } else {\r\n            return (\r\n                <Menu>\r\n                    <Menu.Item key=\"title\" style={{width: '650px'}}>播放列表 ({playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                </Menu>\r\n            );\r\n        }\r\n        \r\n    }\r\n\r\n    // 音乐加载完毕，可以播放\r\n    const canPlay = () => {\r\n        setIsPaused(false);\r\n        setBeginTime(new Date().getTime());\r\n        setDuration(audio1.current.duration);\r\n        audio1.current.play();\r\n    }\r\n\r\n    // audio更新state时间\r\n    const updatePlayTime = () => {\r\n        setCurrentTime(audio1.current.currentTime);\r\n    }\r\n\r\n    // 停留时间超过30秒，增加播放量、用户播放量，换歌的时候执行\r\n    const addPlayTimes = () => {\r\n        if (playList.length > 0) {\r\n            const endTime = new Date().getTime();\r\n            if (endTime - beginTime >= 30000) {\r\n                axios({\r\n                    method: 'POST',\r\n                    url: SERVER_URL +  'music/play_times/' + playList[index].musicId\r\n                }).then((response) => {\r\n                    // console.log(response.data);\r\n                });\r\n                if (props.user) {\r\n                    axios({\r\n                        method: 'POST',\r\n                        url: SERVER_URL +  'user/music/play_times/' + playList[index].musicId,\r\n                        headers: {\r\n                            Authorization: getToken()\r\n                        }\r\n                    }).then((response) => {\r\n                        if (response.data.status === 2) {\r\n                            removeToken();\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    // 拖动条改变时间\r\n    const changePlayTime = (value) => {\r\n        audio1.current.currentTime = value;\r\n    }\r\n    \r\n    // 解析时间成00:00格式, time以秒为单位\r\n    const parseTime = (time) => {\r\n        var min = Math.floor(time / 60);\r\n        if (min < 10) {\r\n            min = '0' + min;\r\n        }\r\n        var sec = Math.floor(time % 60);\r\n        if (sec < 10) {\r\n            sec = '0' + sec;\r\n        }\r\n        return min + ':' + sec;\r\n    }\r\n    \r\n    // audio更新音量\r\n    const updateVolume = () => {\r\n        setVolume(audio1.current.volume);\r\n    }\r\n\r\n    // 静音或者音量最大\r\n    const mute = () => {\r\n        audio1.current.volume = audio1.current.volume > 0 ? 0 : 1;\r\n    }\r\n\r\n    // 拖动条改变音量\r\n    const changeVolume = (value) => {\r\n        audio1.current.volume = value;\r\n    }\r\n\r\n    const showCollectionListModal = () => {\r\n        if (!props.user) {\r\n            PubSub.publish('showLoginModal');\r\n        } else{\r\n            axios({\r\n                method: 'GET',\r\n                url: SERVER_URL + 'server/collection_list',\r\n                headers: {\r\n                    Authorization: getToken()\r\n                }\r\n            }).then((response) => {\r\n                if (response.data.status !== 1) {\r\n                    PubSub.publish('logout');\r\n                    PubSub.publish('showLoginModal');\r\n                } else{\r\n                    setCollectionList(response.data.data);\r\n                    setIsCollectionListModalVisible(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    const closeCollectionListModal = () => {\r\n        setIsCollectionListModalVisible(false);\r\n    }\r\n\r\n    const showNewCollectionListModal = () => {\r\n        setIsCollectionListModalVisible(false);\r\n        setIsNewCollectionListModalVisible(true);\r\n    }\r\n\r\n    const closeNewCollectionListModal = () => {\r\n        setIsNewCollectionListModalVisible(false);\r\n    }\r\n\r\n    const handleCollection = (obj) => {\r\n        if (playList.length > 0) {\r\n            const music = playList[index];\r\n            if (obj.key === 'newList') {\r\n                showNewCollectionListModal();\r\n            } else {\r\n                insertMusicToCollectionList(obj.key, music.musicId);\r\n            }\r\n        }\r\n        closeCollectionListModal();\r\n    }\r\n\r\n    const insertMusicToCollectionList = (collectionListId, musicId) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: SERVER_URL + 'collection_list/' + collectionListId + '/' + musicId,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 2) {\r\n                PubSub.publish('logout');\r\n            } else if (response.data.status === 1) {\r\n                showNotification(response.data.message);\r\n            }\r\n        })\r\n    }\r\n\r\n    const insertCollectionList = (values) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: SERVER_URL + 'server/collection_list/' + values.collectionListName,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 2) {\r\n                PubSub.publish('logout');\r\n            } else if (response.data.status === 1) {\r\n                insertMusicToCollectionList(response.data.data, playList[index].musicId);\r\n            }\r\n        });\r\n        closeNewCollectionListModal();\r\n    }\r\n\r\n    const showNotification = (message) => {\r\n        notification.open({\r\n            message: message,\r\n            placement: 'bottomRight',\r\n            duration: 2\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div style={{position: 'fixed', left: 0, bottom: 0, height: '60px', backgroundColor: 'black', width: '100%'}}>\r\n                <div style={{margin: '5px auto', width: '1000px', display: 'flex'}}>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playBackward}>\r\n                        <StepBackwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                    </Button>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playOrPause} size=\"large\">\r\n                        {isPaused ? <CaretRightOutlined style={{color: 'white', fontSize: '32px', marginLeft: '4px', marginTop: '-4px'}} /> : <PauseOutlined style={{color: 'white', fontSize: '32px', marginLeft: '0', marginTop: '-4.5px'}} />}\r\n                    </Button>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playForward}>\r\n                        <StepForwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                    </Button>\r\n                    {playList.length > 0 ? \r\n                    <Link to={`/album/${playList[index].albumId}`}>\r\n                        <img alt={playList[index].musicName} src={playList[index].albumImg} style={{width: '50px', height: '50px', margin: '0 10px'}} />\r\n                    </Link> \r\n                    : <img alt=\"718音乐\" src=\"/favicon.ico\" style={{width: '50px', height: '50px', margin: '0 10px'}} />}\r\n                    <div style={{width: '550px'}}>\r\n                        <div style={{color: '#e8e8e8'}}>\r\n                            {playList.length > 0 ? playList[index].musicName : '718音乐'}\r\n                            {playList.length > 0 && <Link to={`/artist/${playList[index].artistId}`} style={{color: '#9b9b9b'}}><span style={{fontSize: '10px', marginLeft: '20px'}}>{playList[index].artistName}</span></Link>}\r\n                        </div>\r\n                        <div className=\"barAndTime\" style={{marginTop: '8px', width: '550px', display: 'flex'}}>\r\n                            <div className=\"bar\" style={{width: '450px', height: '10px', marginTop: '7px', display: 'flex'}}>\r\n                                {/* <input type=\"range\" max={duration} value={currentTime} style={{backgroundColor: 'red', height: '10px', width: '450px', marginBottom: '5px'}} onChange={changePlayTime} /> */}\r\n                                <Slider max={duration} value={currentTime} style={{height: '10px', width: '450px', marginTop: '1px'}} onChange={changePlayTime} />\r\n                            </div>\r\n                            <div className=\"time\" style={{color: 'white', marginLeft: '5px'}}>{parseTime(currentTime)}/{parseTime(duration)}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{margin: 'auto 5px'}}>\r\n                        <Button icon={<HeartOutlined />} title=\"收藏\" ghost size=\"small\" style={{border: '0'}} onClick={showCollectionListModal} />\r\n                    </div>\r\n                    <Dropdown overlay={createPlayList} placement=\"topCenter\" arrow getPopupContainer={() => document.getElementById('playBar')}>\r\n                        <Button style={{marginTop: '10px', border: '0'}} icon={<UnorderedListOutlined />} ghost></Button>\r\n                    </Dropdown>\r\n                    <div className=\"volumeCtrl\" style={{marginLeft: '10px', display: 'flex'}}>\r\n                        <Button icon={volume !== 0 ? <i className=\"fa fa-volume-up\"></i> : <i className=\"fa fa-volume-off\"></i>} style={{marginTop: '10px', border: '0'}} ghost onClick={mute} />\r\n                        {/* <input type=\"range\" step=\"0.01\" max=\"1\" value={volume} onChange={changeVolume} /> */}\r\n                        <Slider max={1} value={volume} onChange={changeVolume} step={0.01} style={{width: '100px', marginTop: '20px'}} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <audio src={playList.length > 0 ? playList[index].playUrl : ''} proload=\"auto\" onCanPlay={canPlay} onTimeUpdate={updatePlayTime} onVolumeChange={updateVolume} onEnded={playForward} ref={audio1} />\r\n            <Modal title=\"添加到歌单\" onCancel={closeCollectionListModal} visible={isCollectionListModalVisible} okText=\"确认\" cancelText=\"取消\" footer={null}>\r\n                <Menu onClick={handleCollection} style={{width: '480px', height: '400px', overflow: 'scroll', overflowX: 'hidden'}}>\r\n                    <Menu.Item key=\"newList\" icon={<PlusCircleOutlined />}>\r\n                        新歌单\r\n                    </Menu.Item>\r\n                    <Menu.Divider />\r\n                    {collectionList.map((list) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={list.collectionListId} style={{height: '50px'}}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <Image style={{width: '50px', height: '50px'}} src={list.collectionListImg} />\r\n                                        <div style={{width: '250px', margin: 'auto 20px'}}>{list.collectionListName}</div>\r\n                                        <div style={{width: '100px', margin: 'auto 10px'}}>{list.musicVOList.length + '首'}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu> \r\n            </Modal>\r\n            <Modal title=\"新建歌单\" onCancel={closeNewCollectionListModal} visible={isNewCollectionListModalVisible} footer={null}>\r\n                <Form onFinish={insertCollectionList}>\r\n                    <Form.Item label=\"歌单名\" name=\"collectionListName\" rules={[{ required: true, message: '歌单名不能为空' }]}>\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item wrapperCol={{ offset: 8, span: 16 }}>\r\n                        <Button type=\"primary\" htmlType=\"submit\">新建</Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}