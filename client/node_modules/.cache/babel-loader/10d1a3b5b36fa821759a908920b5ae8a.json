{"ast":null,"code":"var _jsxFileName = \"D:\\\\Programming\\\\React\\\\Music_Recommend_System\\\\front\\\\src\\\\components\\\\PlayBar\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification, Slider } from 'antd';\nimport PubSub from 'pubsub-js';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { getToken, removeToken } from '../../utils/auth';\nimport { SERVER_URL } from '../../utils/constant';\nimport { getMusicUrl } from \"../../utils/play\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function PlayBar(props) {\n  _s();\n\n  const [playList, setPlayList] = useState([]);\n  const [index, setIndex] = useState(0);\n  const [isPaused, setIsPaused] = useState(true);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [beginTime, setBeginTime] = useState(undefined);\n  const [duration, setDuration] = useState(0);\n  const [volume, setVolume] = useState(0.5);\n  const [collectionList, setCollectionList] = useState([]);\n  const [isCollectionListModalVisible, setIsCollectionListModalVisible] = useState(false);\n  const [isNewCollectionListModalVisible, setIsNewCollectionListModalVisible] = useState(false);\n  const audio1 = useRef();\n  useEffect(() => {\n    PubSub.subscribe('playMusic', playMusic);\n    PubSub.subscribe('showNewCollectionListModal', showNewCollectionListModal);\n    PubSub.subscribe('playMusicList', playMusicList);\n    return () => {\n      PubSub.unsubscribe('play');\n      PubSub.unsubscribe('playMusicList');\n      PubSub.unsubscribe('showNewCollectionListModal');\n    }; // eslint-disable-next-line\n  }, []); // 收到通知，播放音乐，data为music对象\n\n  const playMusic = (message, data) => {\n    addPlayTimes(); // for (let i = 0; i < playList.length; i++) {\n    //     if (playList[i].musicId === data.musicId) {\n    //         setIndex(i);\n    //         return;\n    //     }\n    // }\n    // console.log(playList);\n\n    let tmp = playList;\n    let newIndex = tmp.findIndex(music => {\n      return music.musicId === data.musicId;\n    }); // console.log(newIndex);\n\n    let music = getMusicUrl(data);\n    console.log(music);\n    console.log(newIndex);\n\n    if (newIndex !== -1) {\n      tmp.splice(newIndex, 1, music);\n      setPlayList(tmp);\n      setIndex(newIndex);\n    } else {\n      setPlayList([...tmp, music]);\n      setIndex(tmp.length);\n    }\n  };\n\n  const playMusicList = (message, list) => {\n    let tmp = playList;\n\n    for (let i = 0; i < list.length; i++) {\n      let i = tmp.findIndex(music => music.musicId === list[i].musicId);\n\n      if (i !== -1) {\n        tmp.splice(i, 1);\n      }\n    }\n\n    let newIndex = tmp.length;\n    tmp.concat(list);\n    let music = getMusicUrl(tmp[newIndex]);\n    tmp.splice(newIndex, 1, music);\n    setPlayList(tmp);\n    setIndex(newIndex);\n  };\n\n  const playBackward = () => {\n    addPlayTimes();\n\n    if (playList.length === 1) {\n      audio1.current.currentTime = 0;\n      audio1.current.play();\n    } else {\n      const newIndex = (index - 1 + playList.length) % playList.length;\n      setIndex(newIndex);\n    }\n  };\n\n  const playOrPause = () => {\n    isPaused ? audio1.current.play() : audio1.current.pause();\n    setIsPaused(!isPaused);\n  };\n\n  const playForward = () => {\n    addPlayTimes();\n\n    if (playList.length === 1) {\n      audio1.current.currentTime = 0;\n      audio1.current.play();\n    } else {\n      const newIndex = (index + 1) % playList.length;\n      setIndex(newIndex);\n    }\n  }; // 播放列表切换歌\n\n\n  const changeMusic = obj => {\n    // console.log(obj.key);\n    addPlayTimes();\n    const newIndex = playList.findIndex(music => {\n      return music.musicId === obj.key;\n    });\n    setIndex(newIndex);\n  }; // 播放列表\n\n\n  const createPlayList = () => {\n    if (playList[index]) {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        selectedKeys: [playList[index].musicId],\n        onClick: changeMusic,\n        style: {\n          width: '800px',\n          height: '300px',\n          overflow: 'scroll',\n          overflowX: 'hidden'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          style: {\n            width: '750px'\n          },\n          children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", playList.length, \")\"]\n        }, \"title\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this), playList.map(music => {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '450px'\n                  },\n                  children: music.musicName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '250px'\n                  },\n                  children: music.artistName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '50px'\n                  },\n                  children: parseTime(music.timeLength / 1000)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 133,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 37\n              }, this)\n            }, music.musicId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          style: {\n            width: '650px'\n          },\n          children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", playList.length, \")\"]\n        }, \"title\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }, this);\n    }\n  }; // 音乐加载完毕，可以播放\n\n\n  const canPlay = () => {\n    setIsPaused(false);\n    setBeginTime(new Date().getTime()); // console.log(beginTime);\n\n    setDuration(audio1.current.duration);\n    audio1.current.play();\n  }; // audio更新state时间\n\n\n  const updatePlayTime = () => {\n    setCurrentTime(audio1.current.currentTime);\n  }; // 停留时间超过30秒，增加播放量、用户播放量，换歌的时候执行\n\n\n  const addPlayTimes = () => {\n    if (playList[index]) {\n      const endTime = new Date().getTime(); // console.log(beginTime);\n      // console.log(endTime);\n\n      if (endTime - beginTime >= 30000) {\n        console.log(endTime - beginTime);\n        axios({\n          method: 'POST',\n          url: SERVER_URL + 'play_times/' + playList[index].musicId\n        }).then(response => {\n          console.log(response.data);\n        });\n\n        if (props.user) {\n          axios({\n            method: 'POST',\n            url: SERVER_URL + 'user/play_times/' + playList[index].musicId,\n            headers: {\n              Authorization: getToken()\n            },\n            data: {\n              time_length: endTime - beginTime\n            }\n          }).then(response => {\n            if (response.data.status === 2) {\n              removeToken();\n            }\n          });\n        }\n      }\n    }\n  }; // 拖动条改变时间\n\n\n  const changePlayTime = value => {\n    audio1.current.currentTime = value;\n  }; // 解析时间成00:00格式, time以秒为单位\n\n\n  const parseTime = time => {\n    var min = Math.floor(time / 60);\n\n    if (min < 10) {\n      min = '0' + min;\n    }\n\n    var sec = Math.floor(time % 60);\n\n    if (sec < 10) {\n      sec = '0' + sec;\n    }\n\n    return min + ':' + sec;\n  }; // audio更新音量\n\n\n  const updateVolume = () => {\n    setVolume(audio1.current.volume);\n  }; // 静音或者音量最大\n\n\n  const mute = () => {\n    audio1.current.volume = audio1.current.volume > 0 ? 0 : 1;\n  }; // 拖动条改变音量\n\n\n  const changeVolume = value => {\n    audio1.current.volume = value;\n  };\n\n  const showCollectionListModal = () => {\n    if (!props.user) {\n      PubSub.publish('showLoginModal');\n    } else {\n      axios({\n        method: 'GET',\n        url: SERVER_URL + 'collection_list',\n        headers: {\n          Authorization: getToken()\n        }\n      }).then(response => {\n        if (response.data.status !== 1) {\n          PubSub.publish('logout');\n          PubSub.publish('showLoginModal');\n        } else {\n          setCollectionList(response.data.data);\n          setIsCollectionListModalVisible(true);\n        }\n      });\n    }\n  };\n\n  const closeCollectionListModal = () => {\n    setIsCollectionListModalVisible(false);\n  };\n\n  const showNewCollectionListModal = () => {\n    setIsCollectionListModalVisible(false);\n    setIsNewCollectionListModalVisible(true);\n  };\n\n  const closeNewCollectionListModal = () => {\n    setIsNewCollectionListModalVisible(false);\n  };\n\n  const handleCollection = obj => {\n    if (playList[index]) {\n      if (obj.key === 'newList') {\n        showNewCollectionListModal();\n      } else {\n        insertMusicToCollectionList(obj.key, playList[index].musicId);\n      }\n    }\n\n    closeCollectionListModal();\n  };\n\n  const insertMusicToCollectionList = (collectionListId, musicId) => {\n    axios({\n      method: 'POST',\n      url: SERVER_URL + 'collection_list/' + collectionListId + '/' + musicId,\n      headers: {\n        Authorization: getToken()\n      }\n    }).then(response => {\n      if (response.data.status === 2) {\n        PubSub.publish('logout');\n      } else if (response.data.status === 1) {\n        showNotification(response.data.message);\n      }\n    });\n  };\n\n  const insertCollectionList = values => {\n    axios({\n      method: 'POST',\n      url: SERVER_URL + 'collection_list/' + values.collectionListName,\n      headers: {\n        Authorization: getToken()\n      }\n    }).then(response => {\n      if (response.data.status === 2) {\n        PubSub.publish('logout');\n      } else if (response.data.status === 1) {\n        showNotification(response.data.message);\n        PubSub.publish('getCollectionList');\n      }\n    });\n    closeNewCollectionListModal();\n  };\n\n  const showNotification = message => {\n    notification.open({\n      message: message,\n      placement: 'bottomRight',\n      duration: 2\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        left: 0,\n        bottom: 0,\n        height: '60px',\n        backgroundColor: 'black',\n        width: '100%'\n      },\n      id: \"playbar\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: '5px auto',\n          width: '1000px',\n          display: 'flex'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playBackward,\n          children: /*#__PURE__*/_jsxDEV(StepBackwardOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '25px',\n              marginTop: '-2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playOrPause,\n          size: \"large\",\n          children: isPaused ? /*#__PURE__*/_jsxDEV(CaretRightOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '32px',\n              marginLeft: '4px',\n              marginTop: '-4px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 37\n          }, this) : /*#__PURE__*/_jsxDEV(PauseOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '32px',\n              marginLeft: '0',\n              marginTop: '-4.5px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 143\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playForward,\n          children: /*#__PURE__*/_jsxDEV(StepForwardOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '25px',\n              marginTop: '-2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 21\n        }, this), playList[index] ? /*#__PURE__*/_jsxDEV(Link, {\n          to: `/album/${playList[index].albumId}`,\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: playList[index].musicName,\n            src: playList[index].albumImg,\n            style: {\n              width: '50px',\n              height: '50px',\n              margin: '0 10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"718\\u97F3\\u4E50\",\n          src: \"/favicon.ico\",\n          style: {\n            width: '50px',\n            height: '50px',\n            margin: '0 10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '550px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#e8e8e8'\n            },\n            children: [playList[index] ? playList[index].musicName : '718音乐', playList[index] && /*#__PURE__*/_jsxDEV(Link, {\n              to: `/artist/${playList[index].artistId}`,\n              style: {\n                color: '#9b9b9b'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: '10px',\n                  marginLeft: '20px'\n                },\n                children: playList[index].artistName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 125\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 49\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"barAndTime\",\n            style: {\n              marginTop: '8px',\n              width: '550px',\n              display: 'flex'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bar\",\n              style: {\n                width: '450px',\n                height: '10px',\n                marginTop: '7px',\n                display: 'flex'\n              },\n              children: /*#__PURE__*/_jsxDEV(Slider, {\n                max: duration,\n                value: currentTime,\n                style: {\n                  height: '10px',\n                  width: '450px',\n                  marginTop: '-1px',\n                  marginLeft: '-1px'\n                },\n                onChange: changePlayTime\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 348,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"time\",\n              style: {\n                color: 'white',\n                marginLeft: '5px'\n              },\n              children: [parseTime(currentTime), \"/\", parseTime(duration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: 'auto 5px'\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            icon: /*#__PURE__*/_jsxDEV(HeartOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 39\n            }, this),\n            title: \"\\u6536\\u85CF\",\n            ghost: true,\n            size: \"small\",\n            style: {\n              border: '0'\n            },\n            onClick: showCollectionListModal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n          overlay: createPlayList,\n          placement: \"topCenter\",\n          arrow: true,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              marginTop: '10px',\n              border: '0'\n            },\n            icon: /*#__PURE__*/_jsxDEV(UnorderedListOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 80\n            }, this),\n            ghost: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"volumeCtrl\",\n          style: {\n            marginLeft: '10px',\n            display: 'flex'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            icon: volume !== 0 ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-volume-up\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 54\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-volume-off\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 92\n            }, this),\n            style: {\n              marginTop: '10px',\n              border: '0'\n            },\n            ghost: true,\n            onClick: mute\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            max: 1,\n            value: volume,\n            onChange: changeVolume,\n            step: 0.01,\n            style: {\n              width: '100px',\n              marginTop: '20px'\n            },\n            tooltipVisible: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      src: playList[index] ? playList[index].playUrl : '',\n      proload: \"auto\",\n      onCanPlay: canPlay,\n      onTimeUpdate: updatePlayTime,\n      onVolumeChange: updateVolume,\n      onEnded: playForward,\n      ref: audio1\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u6DFB\\u52A0\\u5230\\u6B4C\\u5355\",\n      onCancel: closeCollectionListModal,\n      visible: isCollectionListModalVisible,\n      okText: \"\\u786E\\u8BA4\",\n      cancelText: \"\\u53D6\\u6D88\",\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(Menu, {\n        onClick: handleCollection,\n        style: {\n          width: '480px',\n          height: '400px',\n          overflow: 'scroll',\n          overflowX: 'hidden'\n        },\n        defaultSelectedKeys: \"newList\",\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          icon: /*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 52\n          }, this),\n          children: \"\\u521B\\u5EFA\\u65B0\\u6B4C\\u5355\"\n        }, \"newList\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 21\n        }, this), collectionList.map(list => {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n              style: {\n                height: '50px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Image, {\n                  style: {\n                    width: '50px',\n                    height: '50px'\n                  },\n                  src: list.collectionListImg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 378,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '250px',\n                    margin: 'auto 20px'\n                  },\n                  children: list.collectionListName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 379,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '100px',\n                    margin: 'auto 10px'\n                  },\n                  children: list.collectionListLength + '首'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 380,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 37\n              }, this)\n            }, list.collectionListId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u521B\\u5EFA\\u65B0\\u6B4C\\u5355\",\n      onCancel: closeNewCollectionListModal,\n      visible: isNewCollectionListModalVisible,\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        onFinish: insertCollectionList,\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u6B4C\\u5355\\u540D\",\n          name: \"collectionListName\",\n          rules: [{\n            required: true,\n            message: '歌单名不能为空'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          wrapperCol: {\n            offset: 8,\n            span: 16\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            children: \"\\u65B0\\u5EFA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(PlayBar, \"gtx70F9JJ55ZmhTBfiaSPtH7Umw=\");\n\n_c = PlayBar;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlayBar\");","map":{"version":3,"sources":["D:/Programming/React/Music_Recommend_System/front/src/components/PlayBar/index.jsx"],"names":["React","useEffect","useState","useRef","StepBackwardOutlined","StepForwardOutlined","CaretRightOutlined","PauseOutlined","UnorderedListOutlined","HeartOutlined","PlusCircleOutlined","Button","Dropdown","Menu","Modal","Image","Form","Input","notification","Slider","PubSub","axios","Link","getToken","removeToken","SERVER_URL","getMusicUrl","PlayBar","props","playList","setPlayList","index","setIndex","isPaused","setIsPaused","currentTime","setCurrentTime","beginTime","setBeginTime","undefined","duration","setDuration","volume","setVolume","collectionList","setCollectionList","isCollectionListModalVisible","setIsCollectionListModalVisible","isNewCollectionListModalVisible","setIsNewCollectionListModalVisible","audio1","subscribe","playMusic","showNewCollectionListModal","playMusicList","unsubscribe","message","data","addPlayTimes","tmp","newIndex","findIndex","music","musicId","console","log","splice","length","list","i","concat","playBackward","current","play","playOrPause","pause","playForward","changeMusic","obj","key","createPlayList","width","height","overflow","overflowX","map","display","musicName","artistName","parseTime","timeLength","canPlay","Date","getTime","updatePlayTime","endTime","method","url","then","response","user","headers","Authorization","time_length","status","changePlayTime","value","time","min","Math","floor","sec","updateVolume","mute","changeVolume","showCollectionListModal","publish","closeCollectionListModal","closeNewCollectionListModal","handleCollection","insertMusicToCollectionList","collectionListId","showNotification","insertCollectionList","values","collectionListName","open","placement","position","left","bottom","backgroundColor","margin","borderWidth","color","fontSize","marginTop","marginLeft","albumId","albumImg","artistId","border","playUrl","collectionListImg","collectionListLength","required","offset","span"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,MAArC,QAAmD,OAAnD;AACA,SAAQC,oBAAR,EAA8BC,mBAA9B,EAAmDC,kBAAnD,EAAuEC,aAAvE,EAAsFC,qBAAtF,EAA6GC,aAA7G,EAA4HC,kBAA5H,QAAqJ,mBAArJ;AACA,SAASC,MAAT,EAAiBC,QAAjB,EAA2BC,IAA3B,EAAiCC,KAAjC,EAAwCC,KAAxC,EAA+CC,IAA/C,EAAqDC,KAArD,EAA4DC,YAA5D,EAA0EC,MAA1E,QAAwF,MAAxF;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,QAAT,EAAmBC,WAAnB,QAAsC,kBAAtC;AACA,SAASC,UAAT,QAA2B,sBAA3B;AACA,SAAQC,WAAR,QAA0B,kBAA1B;;;AAEA,eAAe,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;AAAA;;AACnC,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0B5B,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAAC6B,KAAD,EAAQC,QAAR,IAAoB9B,QAAQ,CAAC,CAAD,CAAlC;AACA,QAAM,CAAC+B,QAAD,EAAWC,WAAX,IAA0BhC,QAAQ,CAAC,IAAD,CAAxC;AACA,QAAM,CAACiC,WAAD,EAAcC,cAAd,IAAgClC,QAAQ,CAAC,CAAD,CAA9C;AACA,QAAM,CAACmC,SAAD,EAAYC,YAAZ,IAA4BpC,QAAQ,CAACqC,SAAD,CAA1C;AACA,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BvC,QAAQ,CAAC,CAAD,CAAxC;AACA,QAAM,CAACwC,MAAD,EAASC,SAAT,IAAsBzC,QAAQ,CAAC,GAAD,CAApC;AACA,QAAM,CAAC0C,cAAD,EAAiBC,iBAAjB,IAAsC3C,QAAQ,CAAC,EAAD,CAApD;AACA,QAAM,CAAC4C,4BAAD,EAA+BC,+BAA/B,IAAkE7C,QAAQ,CAAC,KAAD,CAAhF;AACA,QAAM,CAAC8C,+BAAD,EAAkCC,kCAAlC,IAAwE/C,QAAQ,CAAC,KAAD,CAAtF;AAEA,QAAMgD,MAAM,GAAG/C,MAAM,EAArB;AAEAF,EAAAA,SAAS,CAAC,MAAM;AACZmB,IAAAA,MAAM,CAAC+B,SAAP,CAAiB,WAAjB,EAA8BC,SAA9B;AACAhC,IAAAA,MAAM,CAAC+B,SAAP,CAAiB,4BAAjB,EAA+CE,0BAA/C;AACAjC,IAAAA,MAAM,CAAC+B,SAAP,CAAiB,eAAjB,EAAkCG,aAAlC;AACA,WAAO,MAAM;AACTlC,MAAAA,MAAM,CAACmC,WAAP,CAAmB,MAAnB;AACAnC,MAAAA,MAAM,CAACmC,WAAP,CAAmB,eAAnB;AACAnC,MAAAA,MAAM,CAACmC,WAAP,CAAmB,4BAAnB;AACH,KAJD,CAJY,CAQT;AACN,GATQ,EASN,EATM,CAAT,CAdmC,CAyBnC;;AACA,QAAMH,SAAS,GAAG,CAACI,OAAD,EAAUC,IAAV,KAAmB;AACjCC,IAAAA,YAAY,GADqB,CAEjC;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,QAAIC,GAAG,GAAG9B,QAAV;AACA,QAAI+B,QAAQ,GAAGD,GAAG,CAACE,SAAJ,CAAeC,KAAD,IAAW;AACpC,aAAOA,KAAK,CAACC,OAAN,KAAkBN,IAAI,CAACM,OAA9B;AACH,KAFc,CAAf,CAViC,CAajC;;AACA,QAAID,KAAK,GAAGpC,WAAW,CAAC+B,IAAD,CAAvB;AACAO,IAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAYL,QAAZ;;AACA,QAAIA,QAAQ,KAAK,CAAC,CAAlB,EAAqB;AACjBD,MAAAA,GAAG,CAACO,MAAJ,CAAWN,QAAX,EAAqB,CAArB,EAAwBE,KAAxB;AACAhC,MAAAA,WAAW,CAAC6B,GAAD,CAAX;AACA3B,MAAAA,QAAQ,CAAC4B,QAAD,CAAR;AACH,KAJD,MAIO;AACH9B,MAAAA,WAAW,CAAC,CAAC,GAAG6B,GAAJ,EAASG,KAAT,CAAD,CAAX;AACA9B,MAAAA,QAAQ,CAAC2B,GAAG,CAACQ,MAAL,CAAR;AACH;AACJ,GAzBD;;AA2BA,QAAMb,aAAa,GAAG,CAACE,OAAD,EAAUY,IAAV,KAAmB;AACrC,QAAIT,GAAG,GAAG9B,QAAV;;AACA,SAAK,IAAIwC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,IAAI,CAACD,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AAClC,UAAIA,CAAC,GAAGV,GAAG,CAACE,SAAJ,CAAcC,KAAK,IAAIA,KAAK,CAACC,OAAN,KAAkBK,IAAI,CAACC,CAAD,CAAJ,CAAQN,OAAjD,CAAR;;AACA,UAAIM,CAAC,KAAK,CAAC,CAAX,EAAc;AACVV,QAAAA,GAAG,CAACO,MAAJ,CAAWG,CAAX,EAAc,CAAd;AACH;AACJ;;AACD,QAAIT,QAAQ,GAAGD,GAAG,CAACQ,MAAnB;AACAR,IAAAA,GAAG,CAACW,MAAJ,CAAWF,IAAX;AACA,QAAIN,KAAK,GAAGpC,WAAW,CAACiC,GAAG,CAACC,QAAD,CAAJ,CAAvB;AACAD,IAAAA,GAAG,CAACO,MAAJ,CAAWN,QAAX,EAAqB,CAArB,EAAwBE,KAAxB;AACAhC,IAAAA,WAAW,CAAC6B,GAAD,CAAX;AACA3B,IAAAA,QAAQ,CAAC4B,QAAD,CAAR;AACH,GAdD;;AAgBA,QAAMW,YAAY,GAAG,MAAM;AACvBb,IAAAA,YAAY;;AACZ,QAAI7B,QAAQ,CAACsC,MAAT,KAAoB,CAAxB,EAA2B;AACvBjB,MAAAA,MAAM,CAACsB,OAAP,CAAerC,WAAf,GAA6B,CAA7B;AACAe,MAAAA,MAAM,CAACsB,OAAP,CAAeC,IAAf;AACH,KAHD,MAIK;AACD,YAAMb,QAAQ,GAAG,CAAC7B,KAAK,GAAG,CAAR,GAAYF,QAAQ,CAACsC,MAAtB,IAAgCtC,QAAQ,CAACsC,MAA1D;AACAnC,MAAAA,QAAQ,CAAC4B,QAAD,CAAR;AACH;AACJ,GAVD;;AAYA,QAAMc,WAAW,GAAG,MAAM;AACtBzC,IAAAA,QAAQ,GAAGiB,MAAM,CAACsB,OAAP,CAAeC,IAAf,EAAH,GAA2BvB,MAAM,CAACsB,OAAP,CAAeG,KAAf,EAAnC;AACAzC,IAAAA,WAAW,CAAC,CAACD,QAAF,CAAX;AACH,GAHD;;AAKA,QAAM2C,WAAW,GAAG,MAAM;AACtBlB,IAAAA,YAAY;;AACZ,QAAI7B,QAAQ,CAACsC,MAAT,KAAoB,CAAxB,EAA2B;AACvBjB,MAAAA,MAAM,CAACsB,OAAP,CAAerC,WAAf,GAA6B,CAA7B;AACAe,MAAAA,MAAM,CAACsB,OAAP,CAAeC,IAAf;AACH,KAHD,MAIK;AACD,YAAMb,QAAQ,GAAG,CAAC7B,KAAK,GAAG,CAAT,IAAcF,QAAQ,CAACsC,MAAxC;AACAnC,MAAAA,QAAQ,CAAC4B,QAAD,CAAR;AACH;AACJ,GAVD,CAtFmC,CAkGnC;;;AACA,QAAMiB,WAAW,GAAIC,GAAD,IAAS;AACzB;AACApB,IAAAA,YAAY;AACZ,UAAME,QAAQ,GAAG/B,QAAQ,CAACgC,SAAT,CAAoBC,KAAD,IAAW;AAC3C,aAAOA,KAAK,CAACC,OAAN,KAAkBe,GAAG,CAACC,GAA7B;AACH,KAFgB,CAAjB;AAGA/C,IAAAA,QAAQ,CAAC4B,QAAD,CAAR;AACH,GAPD,CAnGmC,CA4GnC;;;AACA,QAAMoB,cAAc,GAAG,MAAM;AACzB,QAAInD,QAAQ,CAACE,KAAD,CAAZ,EAAqB;AACjB,0BACI,QAAC,IAAD;AAAM,QAAA,YAAY,EAAE,CAACF,QAAQ,CAACE,KAAD,CAAR,CAAgBgC,OAAjB,CAApB;AAA+C,QAAA,OAAO,EAAEc,WAAxD;AAAqE,QAAA,KAAK,EAAE;AAACI,UAAAA,KAAK,EAAE,OAAR;AAAiBC,UAAAA,MAAM,EAAE,OAAzB;AAAkCC,UAAAA,QAAQ,EAAE,QAA5C;AAAsDC,UAAAA,SAAS,EAAE;AAAjE,SAA5E;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAuB,UAAA,KAAK,EAAE;AAACH,YAAAA,KAAK,EAAE;AAAR,WAA9B;AAAA,mDAAuDpD,QAAQ,CAACsC,MAAhE;AAAA,WAAe,OAAf;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,gBAFJ,EAGKtC,QAAQ,CAACwD,GAAT,CAAcvB,KAAD,IAAW;AACrB,8BACI;AAAA,oCACI,QAAC,IAAD,CAAM,IAAN;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAE;AAACwB,kBAAAA,OAAO,EAAE;AAAV,iBAAZ;AAAA,wCACI;AAAK,kBAAA,KAAK,EAAE;AAACL,oBAAAA,KAAK,EAAE;AAAR,mBAAZ;AAAA,4BAA+BnB,KAAK,CAACyB;AAArC;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAK,kBAAA,KAAK,EAAE;AAACN,oBAAAA,KAAK,EAAE;AAAR,mBAAZ;AAAA,4BAA+BnB,KAAK,CAAC0B;AAArC;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI;AAAK,kBAAA,KAAK,EAAE;AAACP,oBAAAA,KAAK,EAAE;AAAR,mBAAZ;AAAA,4BAA8BQ,SAAS,CAAC3B,KAAK,CAAC4B,UAAN,GAAmB,IAApB;AAAvC;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ,eAAgB5B,KAAK,CAACC,OAAtB;AAAA;AAAA;AAAA;AAAA,oBADJ,eAQI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,oBARJ;AAAA,0BADJ;AAYH,SAbA,CAHL;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ;AAoBH,KArBD,MAqBO;AACH,0BACI,QAAC,IAAD;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAuB,UAAA,KAAK,EAAE;AAACkB,YAAAA,KAAK,EAAE;AAAR,WAA9B;AAAA,mDAAuDpD,QAAQ,CAACsC,MAAhE;AAAA,WAAe,OAAf;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ;AAMH;AAEJ,GA/BD,CA7GmC,CA8InC;;;AACA,QAAMwB,OAAO,GAAG,MAAM;AAClBzD,IAAAA,WAAW,CAAC,KAAD,CAAX;AACAI,IAAAA,YAAY,CAAC,IAAIsD,IAAJ,GAAWC,OAAX,EAAD,CAAZ,CAFkB,CAGlB;;AACApD,IAAAA,WAAW,CAACS,MAAM,CAACsB,OAAP,CAAehC,QAAhB,CAAX;AACAU,IAAAA,MAAM,CAACsB,OAAP,CAAeC,IAAf;AACH,GAND,CA/ImC,CAuJnC;;;AACA,QAAMqB,cAAc,GAAG,MAAM;AACzB1D,IAAAA,cAAc,CAACc,MAAM,CAACsB,OAAP,CAAerC,WAAhB,CAAd;AACH,GAFD,CAxJmC,CA4JnC;;;AACA,QAAMuB,YAAY,GAAG,MAAM;AACvB,QAAI7B,QAAQ,CAACE,KAAD,CAAZ,EAAqB;AACjB,YAAMgE,OAAO,GAAG,IAAIH,IAAJ,GAAWC,OAAX,EAAhB,CADiB,CAEjB;AACA;;AACA,UAAIE,OAAO,GAAG1D,SAAV,IAAuB,KAA3B,EAAkC;AAC9B2B,QAAAA,OAAO,CAACC,GAAR,CAAY8B,OAAO,GAAG1D,SAAtB;AACAhB,QAAAA,KAAK,CAAC;AACF2E,UAAAA,MAAM,EAAE,MADN;AAEFC,UAAAA,GAAG,EAAExE,UAAU,GAAI,aAAd,GAA8BI,QAAQ,CAACE,KAAD,CAAR,CAAgBgC;AAFjD,SAAD,CAAL,CAGGmC,IAHH,CAGSC,QAAD,IAAc;AAClBnC,UAAAA,OAAO,CAACC,GAAR,CAAYkC,QAAQ,CAAC1C,IAArB;AACH,SALD;;AAMA,YAAI7B,KAAK,CAACwE,IAAV,EAAgB;AACZ/E,UAAAA,KAAK,CAAC;AACF2E,YAAAA,MAAM,EAAE,MADN;AAEFC,YAAAA,GAAG,EAAExE,UAAU,GAAI,kBAAd,GAAmCI,QAAQ,CAACE,KAAD,CAAR,CAAgBgC,OAFtD;AAGFsC,YAAAA,OAAO,EAAE;AACLC,cAAAA,aAAa,EAAE/E,QAAQ;AADlB,aAHP;AAMFkC,YAAAA,IAAI,EAAE;AACF8C,cAAAA,WAAW,EAAER,OAAO,GAAG1D;AADrB;AANJ,WAAD,CAAL,CASG6D,IATH,CASSC,QAAD,IAAc;AAClB,gBAAIA,QAAQ,CAAC1C,IAAT,CAAc+C,MAAd,KAAyB,CAA7B,EAAgC;AAC5BhF,cAAAA,WAAW;AACd;AACJ,WAbD;AAcH;AACJ;AACJ;AACJ,GA/BD,CA7JmC,CA8LnC;;;AACA,QAAMiF,cAAc,GAAIC,KAAD,IAAW;AAC9BxD,IAAAA,MAAM,CAACsB,OAAP,CAAerC,WAAf,GAA6BuE,KAA7B;AACH,GAFD,CA/LmC,CAmMnC;;;AACA,QAAMjB,SAAS,GAAIkB,IAAD,IAAU;AACxB,QAAIC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWH,IAAI,GAAG,EAAlB,CAAV;;AACA,QAAIC,GAAG,GAAG,EAAV,EAAc;AACVA,MAAAA,GAAG,GAAG,MAAMA,GAAZ;AACH;;AACD,QAAIG,GAAG,GAAGF,IAAI,CAACC,KAAL,CAAWH,IAAI,GAAG,EAAlB,CAAV;;AACA,QAAII,GAAG,GAAG,EAAV,EAAc;AACVA,MAAAA,GAAG,GAAG,MAAMA,GAAZ;AACH;;AACD,WAAOH,GAAG,GAAG,GAAN,GAAYG,GAAnB;AACH,GAVD,CApMmC,CAgNnC;;;AACA,QAAMC,YAAY,GAAG,MAAM;AACvBrE,IAAAA,SAAS,CAACO,MAAM,CAACsB,OAAP,CAAe9B,MAAhB,CAAT;AACH,GAFD,CAjNmC,CAqNnC;;;AACA,QAAMuE,IAAI,GAAG,MAAM;AACf/D,IAAAA,MAAM,CAACsB,OAAP,CAAe9B,MAAf,GAAwBQ,MAAM,CAACsB,OAAP,CAAe9B,MAAf,GAAwB,CAAxB,GAA4B,CAA5B,GAAgC,CAAxD;AACH,GAFD,CAtNmC,CA0NnC;;;AACA,QAAMwE,YAAY,GAAIR,KAAD,IAAW;AAC5BxD,IAAAA,MAAM,CAACsB,OAAP,CAAe9B,MAAf,GAAwBgE,KAAxB;AACH,GAFD;;AAIA,QAAMS,uBAAuB,GAAG,MAAM;AAClC,QAAI,CAACvF,KAAK,CAACwE,IAAX,EAAiB;AACbhF,MAAAA,MAAM,CAACgG,OAAP,CAAe,gBAAf;AACH,KAFD,MAEM;AACF/F,MAAAA,KAAK,CAAC;AACF2E,QAAAA,MAAM,EAAE,KADN;AAEFC,QAAAA,GAAG,EAAExE,UAAU,GAAG,iBAFhB;AAGF4E,QAAAA,OAAO,EAAE;AACLC,UAAAA,aAAa,EAAE/E,QAAQ;AADlB;AAHP,OAAD,CAAL,CAMG2E,IANH,CAMSC,QAAD,IAAc;AAClB,YAAIA,QAAQ,CAAC1C,IAAT,CAAc+C,MAAd,KAAyB,CAA7B,EAAgC;AAC5BpF,UAAAA,MAAM,CAACgG,OAAP,CAAe,QAAf;AACAhG,UAAAA,MAAM,CAACgG,OAAP,CAAe,gBAAf;AACH,SAHD,MAGM;AACFvE,UAAAA,iBAAiB,CAACsD,QAAQ,CAAC1C,IAAT,CAAcA,IAAf,CAAjB;AACAV,UAAAA,+BAA+B,CAAC,IAAD,CAA/B;AACH;AACJ,OAdD;AAeH;AACJ,GApBD;;AAsBA,QAAMsE,wBAAwB,GAAG,MAAM;AACnCtE,IAAAA,+BAA+B,CAAC,KAAD,CAA/B;AACH,GAFD;;AAIA,QAAMM,0BAA0B,GAAG,MAAM;AACrCN,IAAAA,+BAA+B,CAAC,KAAD,CAA/B;AACAE,IAAAA,kCAAkC,CAAC,IAAD,CAAlC;AACH,GAHD;;AAKA,QAAMqE,2BAA2B,GAAG,MAAM;AACtCrE,IAAAA,kCAAkC,CAAC,KAAD,CAAlC;AACH,GAFD;;AAIA,QAAMsE,gBAAgB,GAAIzC,GAAD,IAAS;AAC9B,QAAIjD,QAAQ,CAACE,KAAD,CAAZ,EAAqB;AACjB,UAAI+C,GAAG,CAACC,GAAJ,KAAY,SAAhB,EAA2B;AACvB1B,QAAAA,0BAA0B;AAC7B,OAFD,MAEO;AACHmE,QAAAA,2BAA2B,CAAC1C,GAAG,CAACC,GAAL,EAAUlD,QAAQ,CAACE,KAAD,CAAR,CAAgBgC,OAA1B,CAA3B;AACH;AACJ;;AACDsD,IAAAA,wBAAwB;AAC3B,GATD;;AAWA,QAAMG,2BAA2B,GAAG,CAACC,gBAAD,EAAmB1D,OAAnB,KAA+B;AAC/D1C,IAAAA,KAAK,CAAC;AACF2E,MAAAA,MAAM,EAAE,MADN;AAEFC,MAAAA,GAAG,EAAExE,UAAU,GAAG,kBAAb,GAAkCgG,gBAAlC,GAAqD,GAArD,GAA2D1D,OAF9D;AAGFsC,MAAAA,OAAO,EAAE;AACLC,QAAAA,aAAa,EAAE/E,QAAQ;AADlB;AAHP,KAAD,CAAL,CAMG2E,IANH,CAMSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAAC1C,IAAT,CAAc+C,MAAd,KAAyB,CAA7B,EAAgC;AAC5BpF,QAAAA,MAAM,CAACgG,OAAP,CAAe,QAAf;AACH,OAFD,MAEO,IAAIjB,QAAQ,CAAC1C,IAAT,CAAc+C,MAAd,KAAyB,CAA7B,EAAgC;AACnCkB,QAAAA,gBAAgB,CAACvB,QAAQ,CAAC1C,IAAT,CAAcD,OAAf,CAAhB;AACH;AACJ,KAZD;AAaH,GAdD;;AAgBA,QAAMmE,oBAAoB,GAAIC,MAAD,IAAY;AACrCvG,IAAAA,KAAK,CAAC;AACF2E,MAAAA,MAAM,EAAE,MADN;AAEFC,MAAAA,GAAG,EAAExE,UAAU,GAAG,kBAAb,GAAkCmG,MAAM,CAACC,kBAF5C;AAGFxB,MAAAA,OAAO,EAAE;AACLC,QAAAA,aAAa,EAAE/E,QAAQ;AADlB;AAHP,KAAD,CAAL,CAMG2E,IANH,CAMSC,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAAC1C,IAAT,CAAc+C,MAAd,KAAyB,CAA7B,EAAgC;AAC5BpF,QAAAA,MAAM,CAACgG,OAAP,CAAe,QAAf;AACH,OAFD,MAEO,IAAIjB,QAAQ,CAAC1C,IAAT,CAAc+C,MAAd,KAAyB,CAA7B,EAAgC;AACnCkB,QAAAA,gBAAgB,CAACvB,QAAQ,CAAC1C,IAAT,CAAcD,OAAf,CAAhB;AACApC,QAAAA,MAAM,CAACgG,OAAP,CAAe,mBAAf;AACH;AACJ,KAbD;AAcAE,IAAAA,2BAA2B;AAC9B,GAhBD;;AAkBA,QAAMI,gBAAgB,GAAIlE,OAAD,IAAa;AAClCtC,IAAAA,YAAY,CAAC4G,IAAb,CAAkB;AACdtE,MAAAA,OAAO,EAAEA,OADK;AAEduE,MAAAA,SAAS,EAAE,aAFG;AAGdvF,MAAAA,QAAQ,EAAE;AAHI,KAAlB;AAKH,GAND;;AAQA,sBACI;AAAA,4BACI;AAAK,MAAA,KAAK,EAAE;AAACwF,QAAAA,QAAQ,EAAE,OAAX;AAAoBC,QAAAA,IAAI,EAAE,CAA1B;AAA6BC,QAAAA,MAAM,EAAE,CAArC;AAAwChD,QAAAA,MAAM,EAAE,MAAhD;AAAwDiD,QAAAA,eAAe,EAAE,OAAzE;AAAkFlD,QAAAA,KAAK,EAAE;AAAzF,OAAZ;AAA8G,MAAA,EAAE,EAAC,SAAjH;AAAA,6BACI;AAAK,QAAA,KAAK,EAAE;AAACmD,UAAAA,MAAM,EAAE,UAAT;AAAqBnD,UAAAA,KAAK,EAAE,QAA5B;AAAsCK,UAAAA,OAAO,EAAE;AAA/C,SAAZ;AAAA,gCACI,QAAC,MAAD;AAAQ,UAAA,KAAK,EAAC,QAAd;AAAuB,UAAA,KAAK,EAAE;AAAC6C,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,MAAM,EAAE,UAAnC;AAA+CC,YAAAA,WAAW,EAAE;AAA5D,WAA9B;AAAkG,UAAA,OAAO,EAAE9D,YAA3G;AAAA,iCACI,QAAC,oBAAD;AAAsB,YAAA,KAAK,EAAE;AAAC+D,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCC,cAAAA,SAAS,EAAE;AAA9C;AAA7B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,MAAD;AAAQ,UAAA,KAAK,EAAC,QAAd;AAAuB,UAAA,KAAK,EAAE;AAACL,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,MAAM,EAAE,UAAnC;AAA+CC,YAAAA,WAAW,EAAE;AAA5D,WAA9B;AAAkG,UAAA,OAAO,EAAE3D,WAA3G;AAAwH,UAAA,IAAI,EAAC,OAA7H;AAAA,oBACKzC,QAAQ,gBAAG,QAAC,kBAAD;AAAoB,YAAA,KAAK,EAAE;AAACqG,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCE,cAAAA,UAAU,EAAE,KAA/C;AAAsDD,cAAAA,SAAS,EAAE;AAAjE;AAA3B;AAAA;AAAA;AAAA;AAAA,kBAAH,gBAA6G,QAAC,aAAD;AAAe,YAAA,KAAK,EAAE;AAACF,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCE,cAAAA,UAAU,EAAE,GAA/C;AAAoDD,cAAAA,SAAS,EAAE;AAA/D;AAAtB;AAAA;AAAA;AAAA;AAAA;AAD1H;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAOI,QAAC,MAAD;AAAQ,UAAA,KAAK,EAAC,QAAd;AAAuB,UAAA,KAAK,EAAE;AAACL,YAAAA,eAAe,EAAE,OAAlB;AAA2BC,YAAAA,MAAM,EAAE,UAAnC;AAA+CC,YAAAA,WAAW,EAAE;AAA5D,WAA9B;AAAkG,UAAA,OAAO,EAAEzD,WAA3G;AAAA,iCACI,QAAC,mBAAD;AAAqB,YAAA,KAAK,EAAE;AAAC0D,cAAAA,KAAK,EAAE,OAAR;AAAiBC,cAAAA,QAAQ,EAAE,MAA3B;AAAmCC,cAAAA,SAAS,EAAE;AAA9C;AAA5B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAPJ,EAUK3G,QAAQ,CAACE,KAAD,CAAR,gBACD,QAAC,IAAD;AAAM,UAAA,EAAE,EAAG,UAASF,QAAQ,CAACE,KAAD,CAAR,CAAgB2G,OAAQ,EAA5C;AAAA,iCACI;AAAK,YAAA,GAAG,EAAE7G,QAAQ,CAACE,KAAD,CAAR,CAAgBwD,SAA1B;AAAqC,YAAA,GAAG,EAAE1D,QAAQ,CAACE,KAAD,CAAR,CAAgB4G,QAA1D;AAAoE,YAAA,KAAK,EAAE;AAAC1D,cAAAA,KAAK,EAAE,MAAR;AAAgBC,cAAAA,MAAM,EAAE,MAAxB;AAAgCkD,cAAAA,MAAM,EAAE;AAAxC;AAA3E;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADC,gBAIC;AAAK,UAAA,GAAG,EAAC,iBAAT;AAAiB,UAAA,GAAG,EAAC,cAArB;AAAoC,UAAA,KAAK,EAAE;AAACnD,YAAAA,KAAK,EAAE,MAAR;AAAgBC,YAAAA,MAAM,EAAE,MAAxB;AAAgCkD,YAAAA,MAAM,EAAE;AAAxC;AAA3C;AAAA;AAAA;AAAA;AAAA,gBAdN,eAeI;AAAK,UAAA,KAAK,EAAE;AAACnD,YAAAA,KAAK,EAAE;AAAR,WAAZ;AAAA,kCACI;AAAK,YAAA,KAAK,EAAE;AAACqD,cAAAA,KAAK,EAAE;AAAR,aAAZ;AAAA,uBACKzG,QAAQ,CAACE,KAAD,CAAR,GAAkBF,QAAQ,CAACE,KAAD,CAAR,CAAgBwD,SAAlC,GAA8C,OADnD,EAEK1D,QAAQ,CAACE,KAAD,CAAR,iBAAmB,QAAC,IAAD;AAAM,cAAA,EAAE,EAAG,WAAUF,QAAQ,CAACE,KAAD,CAAR,CAAgB6G,QAAS,EAA9C;AAAiD,cAAA,KAAK,EAAE;AAACN,gBAAAA,KAAK,EAAE;AAAR,eAAxD;AAAA,qCAA4E;AAAM,gBAAA,KAAK,EAAE;AAACC,kBAAAA,QAAQ,EAAE,MAAX;AAAmBE,kBAAAA,UAAU,EAAE;AAA/B,iBAAb;AAAA,0BAAsD5G,QAAQ,CAACE,KAAD,CAAR,CAAgByD;AAAtE;AAAA;AAAA;AAAA;AAAA;AAA5E;AAAA;AAAA;AAAA;AAAA,oBAFxB;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAKI;AAAK,YAAA,SAAS,EAAC,YAAf;AAA4B,YAAA,KAAK,EAAE;AAACgD,cAAAA,SAAS,EAAE,KAAZ;AAAmBvD,cAAAA,KAAK,EAAE,OAA1B;AAAmCK,cAAAA,OAAO,EAAE;AAA5C,aAAnC;AAAA,oCACI;AAAK,cAAA,SAAS,EAAC,KAAf;AAAqB,cAAA,KAAK,EAAE;AAACL,gBAAAA,KAAK,EAAE,OAAR;AAAiBC,gBAAAA,MAAM,EAAE,MAAzB;AAAiCsD,gBAAAA,SAAS,EAAE,KAA5C;AAAmDlD,gBAAAA,OAAO,EAAE;AAA5D,eAA5B;AAAA,qCAEI,QAAC,MAAD;AAAQ,gBAAA,GAAG,EAAE9C,QAAb;AAAuB,gBAAA,KAAK,EAAEL,WAA9B;AAA2C,gBAAA,KAAK,EAAE;AAAC+C,kBAAAA,MAAM,EAAE,MAAT;AAAiBD,kBAAAA,KAAK,EAAE,OAAxB;AAAiCuD,kBAAAA,SAAS,EAAE,MAA5C;AAAoDC,kBAAAA,UAAU,EAAE;AAAhE,iBAAlD;AAA2H,gBAAA,QAAQ,EAAEhC;AAArI;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,oBADJ,eAKI;AAAK,cAAA,SAAS,EAAC,MAAf;AAAsB,cAAA,KAAK,EAAE;AAAC6B,gBAAAA,KAAK,EAAE,OAAR;AAAiBG,gBAAAA,UAAU,EAAE;AAA7B,eAA7B;AAAA,yBAAmEhD,SAAS,CAACtD,WAAD,CAA5E,OAA4FsD,SAAS,CAACjD,QAAD,CAArG;AAAA;AAAA;AAAA;AAAA;AAAA,oBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAfJ,eA4BI;AAAK,UAAA,KAAK,EAAE;AAAC4F,YAAAA,MAAM,EAAE;AAAT,WAAZ;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,IAAI,eAAE,QAAC,aAAD;AAAA;AAAA;AAAA;AAAA,oBAAd;AAAiC,YAAA,KAAK,EAAC,cAAvC;AAA4C,YAAA,KAAK,MAAjD;AAAkD,YAAA,IAAI,EAAC,OAAvD;AAA+D,YAAA,KAAK,EAAE;AAACS,cAAAA,MAAM,EAAE;AAAT,aAAtE;AAAqF,YAAA,OAAO,EAAE1B;AAA9F;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBA5BJ,eA+BI,QAAC,QAAD;AAAU,UAAA,OAAO,EAAEnC,cAAnB;AAAmC,UAAA,SAAS,EAAC,WAA7C;AAAyD,UAAA,KAAK,MAA9D;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,KAAK,EAAE;AAACwD,cAAAA,SAAS,EAAE,MAAZ;AAAoBK,cAAAA,MAAM,EAAE;AAA5B,aAAf;AAAiD,YAAA,IAAI,eAAE,QAAC,qBAAD;AAAA;AAAA;AAAA;AAAA,oBAAvD;AAAkF,YAAA,KAAK;AAAvF;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBA/BJ,eAkCI;AAAK,UAAA,SAAS,EAAC,YAAf;AAA4B,UAAA,KAAK,EAAE;AAACJ,YAAAA,UAAU,EAAE,MAAb;AAAqBnD,YAAAA,OAAO,EAAE;AAA9B,WAAnC;AAAA,kCACI,QAAC,MAAD;AAAQ,YAAA,IAAI,EAAE5C,MAAM,KAAK,CAAX,gBAAe;AAAG,cAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,oBAAf,gBAAqD;AAAG,cAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,oBAAnE;AAAyG,YAAA,KAAK,EAAE;AAAC8F,cAAAA,SAAS,EAAE,MAAZ;AAAoBK,cAAAA,MAAM,EAAE;AAA5B,aAAhH;AAAkJ,YAAA,KAAK,MAAvJ;AAAwJ,YAAA,OAAO,EAAE5B;AAAjK;AAAA;AAAA;AAAA;AAAA,kBADJ,eAGI,QAAC,MAAD;AAAQ,YAAA,GAAG,EAAE,CAAb;AAAgB,YAAA,KAAK,EAAEvE,MAAvB;AAA+B,YAAA,QAAQ,EAAEwE,YAAzC;AAAuD,YAAA,IAAI,EAAE,IAA7D;AAAmE,YAAA,KAAK,EAAE;AAACjC,cAAAA,KAAK,EAAE,OAAR;AAAiBuD,cAAAA,SAAS,EAAE;AAA5B,aAA1E;AAA+G,YAAA,cAAc,EAAE;AAA/H;AAAA;AAAA;AAAA;AAAA,kBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAlCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADJ,eA2CI;AAAO,MAAA,GAAG,EAAE3G,QAAQ,CAACE,KAAD,CAAR,GAAkBF,QAAQ,CAACE,KAAD,CAAR,CAAgB+G,OAAlC,GAA4C,EAAxD;AAA4D,MAAA,OAAO,EAAC,MAApE;AAA2E,MAAA,SAAS,EAAEnD,OAAtF;AAA+F,MAAA,YAAY,EAAEG,cAA7G;AAA6H,MAAA,cAAc,EAAEkB,YAA7I;AAA2J,MAAA,OAAO,EAAEpC,WAApK;AAAiL,MAAA,GAAG,EAAE1B;AAAtL;AAAA;AAAA;AAAA;AAAA,YA3CJ,eA4CI,QAAC,KAAD;AAAO,MAAA,KAAK,EAAC,gCAAb;AAAqB,MAAA,QAAQ,EAAEmE,wBAA/B;AAAyD,MAAA,OAAO,EAAEvE,4BAAlE;AAAgG,MAAA,MAAM,EAAC,cAAvG;AAA4G,MAAA,UAAU,EAAC,cAAvH;AAA4H,MAAA,MAAM,EAAE,IAApI;AAAA,6BACI,QAAC,IAAD;AAAM,QAAA,OAAO,EAAEyE,gBAAf;AAAiC,QAAA,KAAK,EAAE;AAACtC,UAAAA,KAAK,EAAE,OAAR;AAAiBC,UAAAA,MAAM,EAAE,OAAzB;AAAkCC,UAAAA,QAAQ,EAAE,QAA5C;AAAsDC,UAAAA,SAAS,EAAE;AAAjE,SAAxC;AAAoH,QAAA,mBAAmB,EAAC,SAAxI;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAyB,UAAA,IAAI,eAAE,QAAC,kBAAD;AAAA;AAAA;AAAA;AAAA,kBAA/B;AAAA;AAAA,WAAe,SAAf;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,gBAJJ,EAKKxC,cAAc,CAACyC,GAAf,CAAoBjB,IAAD,IAAU;AAC1B,8BACI;AAAA,oCACI,QAAC,IAAD,CAAM,IAAN;AAAuC,cAAA,KAAK,EAAE;AAACc,gBAAAA,MAAM,EAAE;AAAT,eAA9C;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAE;AAACI,kBAAAA,OAAO,EAAE;AAAV,iBAAZ;AAAA,wCACI,QAAC,KAAD;AAAO,kBAAA,KAAK,EAAE;AAACL,oBAAAA,KAAK,EAAE,MAAR;AAAgBC,oBAAAA,MAAM,EAAE;AAAxB,mBAAd;AAA+C,kBAAA,GAAG,EAAEd,IAAI,CAAC2E;AAAzD;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAK,kBAAA,KAAK,EAAE;AAAC9D,oBAAAA,KAAK,EAAE,OAAR;AAAiBmD,oBAAAA,MAAM,EAAE;AAAzB,mBAAZ;AAAA,4BAAoDhE,IAAI,CAACyD;AAAzD;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI;AAAK,kBAAA,KAAK,EAAE;AAAC5C,oBAAAA,KAAK,EAAE,OAAR;AAAiBmD,oBAAAA,MAAM,EAAE;AAAzB,mBAAZ;AAAA,4BAAoDhE,IAAI,CAAC4E,oBAAL,GAA4B;AAAhF;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ,eAAgB5E,IAAI,CAACqD,gBAArB;AAAA;AAAA;AAAA;AAAA,oBADJ,eAQI,QAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA,oBARJ;AAAA,0BADJ;AAYH,SAbA,CALL;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YA5CJ,eAkEI,QAAC,KAAD;AAAO,MAAA,KAAK,EAAC,gCAAb;AAAqB,MAAA,QAAQ,EAAEH,2BAA/B;AAA4D,MAAA,OAAO,EAAEtE,+BAArE;AAAsG,MAAA,MAAM,EAAE,IAA9G;AAAA,6BACI,QAAC,IAAD;AAAM,QAAA,QAAQ,EAAE2E,oBAAhB;AAAA,gCACI,QAAC,IAAD,CAAM,IAAN;AAAW,UAAA,KAAK,EAAC,oBAAjB;AAAuB,UAAA,IAAI,EAAC,oBAA5B;AAAiD,UAAA,KAAK,EAAE,CAAC;AAAEsB,YAAAA,QAAQ,EAAE,IAAZ;AAAkBzF,YAAAA,OAAO,EAAE;AAA3B,WAAD,CAAxD;AAAA,iCACI,QAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,IAAD,CAAM,IAAN;AAAW,UAAA,UAAU,EAAE;AAAE0F,YAAAA,MAAM,EAAE,CAAV;AAAaC,YAAAA,IAAI,EAAE;AAAnB,WAAvB;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,IAAI,EAAC,SAAb;AAAuB,YAAA,QAAQ,EAAC,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YAlEJ;AAAA,kBADJ;AA+EH;;GAtYuBxH,O;;KAAAA,O","sourcesContent":["import React, { useEffect, useState, useRef } from 'react'\r\nimport {StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined} from '@ant-design/icons';\r\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification, Slider } from 'antd'\r\nimport PubSub from 'pubsub-js';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport { getToken, removeToken } from '../../utils/auth';\r\nimport { SERVER_URL } from '../../utils/constant';\r\nimport {getMusicUrl} from \"../../utils/play\";\r\n\r\nexport default function PlayBar(props) {\r\n    const [playList, setPlayList] = useState([]);\r\n    const [index, setIndex] = useState(0);\r\n    const [isPaused, setIsPaused] = useState(true);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [beginTime, setBeginTime] = useState(undefined);\r\n    const [duration, setDuration] = useState(0);\r\n    const [volume, setVolume] = useState(0.5);\r\n    const [collectionList, setCollectionList] = useState([]);\r\n    const [isCollectionListModalVisible, setIsCollectionListModalVisible] = useState(false);\r\n    const [isNewCollectionListModalVisible, setIsNewCollectionListModalVisible] = useState(false);\r\n\r\n    const audio1 = useRef();\r\n\r\n    useEffect(() => {\r\n        PubSub.subscribe('playMusic', playMusic);\r\n        PubSub.subscribe('showNewCollectionListModal', showNewCollectionListModal);\r\n        PubSub.subscribe('playMusicList', playMusicList);\r\n        return () => {\r\n            PubSub.unsubscribe('play');\r\n            PubSub.unsubscribe('playMusicList');\r\n            PubSub.unsubscribe('showNewCollectionListModal');\r\n        }  // eslint-disable-next-line\r\n    }, []);\r\n\r\n    // 收到通知，播放音乐，data为music对象\r\n    const playMusic = (message, data) => {\r\n        addPlayTimes();\r\n        // for (let i = 0; i < playList.length; i++) {\r\n        //     if (playList[i].musicId === data.musicId) {\r\n        //         setIndex(i);\r\n        //         return;\r\n        //     }\r\n        // }\r\n        // console.log(playList);\r\n        let tmp = playList;\r\n        let newIndex = tmp.findIndex((music) => {\r\n            return music.musicId === data.musicId;\r\n        });\r\n        // console.log(newIndex);\r\n        let music = getMusicUrl(data);\r\n        console.log(music);\r\n        console.log(newIndex);\r\n        if (newIndex !== -1) {\r\n            tmp.splice(newIndex, 1, music);\r\n            setPlayList(tmp);\r\n            setIndex(newIndex);\r\n        } else {\r\n            setPlayList([...tmp, music]);\r\n            setIndex(tmp.length);\r\n        }\r\n    }\r\n\r\n    const playMusicList = (message, list) => {\r\n        let tmp = playList;\r\n        for (let i = 0; i < list.length; i++) {\r\n            let i = tmp.findIndex(music => music.musicId === list[i].musicId);\r\n            if (i !== -1) {\r\n                tmp.splice(i, 1);\r\n            }\r\n        }\r\n        let newIndex = tmp.length;\r\n        tmp.concat(list);\r\n        let music = getMusicUrl(tmp[newIndex]);\r\n        tmp.splice(newIndex, 1, music);\r\n        setPlayList(tmp);\r\n        setIndex(newIndex);\r\n    }\r\n\r\n    const playBackward = () => {\r\n        addPlayTimes();\r\n        if (playList.length === 1) {\r\n            audio1.current.currentTime = 0\r\n            audio1.current.play();\r\n        }\r\n        else {\r\n            const newIndex = (index - 1 + playList.length) % playList.length;\r\n            setIndex(newIndex);\r\n        }\r\n    }\r\n    \r\n    const playOrPause = () => {\r\n        isPaused ? audio1.current.play() : audio1.current.pause();\r\n        setIsPaused(!isPaused);\r\n    }\r\n\r\n    const playForward = () => {\r\n        addPlayTimes();\r\n        if (playList.length === 1) {\r\n            audio1.current.currentTime = 0\r\n            audio1.current.play();\r\n        }\r\n        else {\r\n            const newIndex = (index + 1) % playList.length;\r\n            setIndex(newIndex);\r\n        }\r\n    }\r\n\r\n    // 播放列表切换歌\r\n    const changeMusic = (obj) => {\r\n        // console.log(obj.key);\r\n        addPlayTimes();\r\n        const newIndex = playList.findIndex((music) => {\r\n            return music.musicId === obj.key;\r\n        });\r\n        setIndex(newIndex);\r\n    }\r\n\r\n    // 播放列表\r\n    const createPlayList = () => {\r\n        if (playList[index]) {\r\n            return (\r\n                <Menu selectedKeys={[playList[index].musicId]} onClick={changeMusic} style={{width: '800px', height: '300px', overflow: 'scroll', overflowX: 'hidden'}}>\r\n                    <Menu.Item key=\"title\" style={{width: '750px'}}>播放列表 ({playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                    {playList.map((music) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={music.musicId}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <div style={{width: '450px'}}>{music.musicName}</div>\r\n                                        <div style={{width: '250px'}}>{music.artistName}</div>\r\n                                        <div style={{width: '50px'}}>{parseTime(music.timeLength / 1000)}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu>\r\n            );\r\n        } else {\r\n            return (\r\n                <Menu>\r\n                    <Menu.Item key=\"title\" style={{width: '650px'}}>播放列表 ({playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                </Menu>\r\n            );\r\n        }\r\n        \r\n    }\r\n\r\n    // 音乐加载完毕，可以播放\r\n    const canPlay = () => {\r\n        setIsPaused(false);\r\n        setBeginTime(new Date().getTime());\r\n        // console.log(beginTime);\r\n        setDuration(audio1.current.duration);\r\n        audio1.current.play();\r\n    }\r\n\r\n    // audio更新state时间\r\n    const updatePlayTime = () => {\r\n        setCurrentTime(audio1.current.currentTime);\r\n    }\r\n\r\n    // 停留时间超过30秒，增加播放量、用户播放量，换歌的时候执行\r\n    const addPlayTimes = () => {\r\n        if (playList[index]) {\r\n            const endTime = new Date().getTime();\r\n            // console.log(beginTime);\r\n            // console.log(endTime);\r\n            if (endTime - beginTime >= 30000) {\r\n                console.log(endTime - beginTime);\r\n                axios({\r\n                    method: 'POST',\r\n                    url: SERVER_URL +  'play_times/' + playList[index].musicId\r\n                }).then((response) => {\r\n                    console.log(response.data);\r\n                });\r\n                if (props.user) {\r\n                    axios({\r\n                        method: 'POST',\r\n                        url: SERVER_URL +  'user/play_times/' + playList[index].musicId,\r\n                        headers: {\r\n                            Authorization: getToken()\r\n                        },\r\n                        data: {\r\n                            time_length: endTime - beginTime\r\n                        }\r\n                    }).then((response) => {\r\n                        if (response.data.status === 2) {\r\n                            removeToken();\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    // 拖动条改变时间\r\n    const changePlayTime = (value) => {\r\n        audio1.current.currentTime = value;\r\n    }\r\n    \r\n    // 解析时间成00:00格式, time以秒为单位\r\n    const parseTime = (time) => {\r\n        var min = Math.floor(time / 60);\r\n        if (min < 10) {\r\n            min = '0' + min;\r\n        }\r\n        var sec = Math.floor(time % 60);\r\n        if (sec < 10) {\r\n            sec = '0' + sec;\r\n        }\r\n        return min + ':' + sec;\r\n    }\r\n    \r\n    // audio更新音量\r\n    const updateVolume = () => {\r\n        setVolume(audio1.current.volume);\r\n    }\r\n\r\n    // 静音或者音量最大\r\n    const mute = () => {\r\n        audio1.current.volume = audio1.current.volume > 0 ? 0 : 1;\r\n    }\r\n\r\n    // 拖动条改变音量\r\n    const changeVolume = (value) => {\r\n        audio1.current.volume = value;\r\n    }\r\n\r\n    const showCollectionListModal = () => {\r\n        if (!props.user) {\r\n            PubSub.publish('showLoginModal');\r\n        } else{\r\n            axios({\r\n                method: 'GET',\r\n                url: SERVER_URL + 'collection_list',\r\n                headers: {\r\n                    Authorization: getToken()\r\n                }\r\n            }).then((response) => {\r\n                if (response.data.status !== 1) {\r\n                    PubSub.publish('logout');\r\n                    PubSub.publish('showLoginModal');\r\n                } else{\r\n                    setCollectionList(response.data.data);\r\n                    setIsCollectionListModalVisible(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    const closeCollectionListModal = () => {\r\n        setIsCollectionListModalVisible(false);\r\n    }\r\n\r\n    const showNewCollectionListModal = () => {\r\n        setIsCollectionListModalVisible(false);\r\n        setIsNewCollectionListModalVisible(true);\r\n    }\r\n\r\n    const closeNewCollectionListModal = () => {\r\n        setIsNewCollectionListModalVisible(false);\r\n    }\r\n\r\n    const handleCollection = (obj) => {\r\n        if (playList[index]) {\r\n            if (obj.key === 'newList') {\r\n                showNewCollectionListModal();\r\n            } else {\r\n                insertMusicToCollectionList(obj.key, playList[index].musicId);\r\n            }\r\n        }\r\n        closeCollectionListModal();\r\n    }\r\n\r\n    const insertMusicToCollectionList = (collectionListId, musicId) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: SERVER_URL + 'collection_list/' + collectionListId + '/' + musicId,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 2) {\r\n                PubSub.publish('logout');\r\n            } else if (response.data.status === 1) {\r\n                showNotification(response.data.message);\r\n            }\r\n        })\r\n    }\r\n\r\n    const insertCollectionList = (values) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: SERVER_URL + 'collection_list/' + values.collectionListName,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 2) {\r\n                PubSub.publish('logout');\r\n            } else if (response.data.status === 1) {\r\n                showNotification(response.data.message);\r\n                PubSub.publish('getCollectionList');\r\n            }\r\n        });\r\n        closeNewCollectionListModal();\r\n    }\r\n\r\n    const showNotification = (message) => {\r\n        notification.open({\r\n            message: message,\r\n            placement: 'bottomRight',\r\n            duration: 2\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div style={{position: 'fixed', left: 0, bottom: 0, height: '60px', backgroundColor: 'black', width: '100%'}} id=\"playbar\">\r\n                <div style={{margin: '5px auto', width: '1000px', display: 'flex'}}>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playBackward}>\r\n                        <StepBackwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                    </Button>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playOrPause} size=\"large\">\r\n                        {isPaused ? <CaretRightOutlined style={{color: 'white', fontSize: '32px', marginLeft: '4px', marginTop: '-4px'}} /> : <PauseOutlined style={{color: 'white', fontSize: '32px', marginLeft: '0', marginTop: '-4.5px'}} />}\r\n                    </Button>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playForward}>\r\n                        <StepForwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                    </Button>\r\n                    {playList[index] ? \r\n                    <Link to={`/album/${playList[index].albumId}`}>\r\n                        <img alt={playList[index].musicName} src={playList[index].albumImg} style={{width: '50px', height: '50px', margin: '0 10px'}} />\r\n                    </Link> \r\n                    : <img alt=\"718音乐\" src=\"/favicon.ico\" style={{width: '50px', height: '50px', margin: '0 10px'}} />}\r\n                    <div style={{width: '550px'}}>\r\n                        <div style={{color: '#e8e8e8'}}>\r\n                            {playList[index] ? playList[index].musicName : '718音乐'}\r\n                            {playList[index] && <Link to={`/artist/${playList[index].artistId}`} style={{color: '#9b9b9b'}}><span style={{fontSize: '10px', marginLeft: '20px'}}>{playList[index].artistName}</span></Link>}\r\n                        </div>\r\n                        <div className=\"barAndTime\" style={{marginTop: '8px', width: '550px', display: 'flex'}}>\r\n                            <div className=\"bar\" style={{width: '450px', height: '10px', marginTop: '7px', display: 'flex'}}>\r\n                                {/* <input type=\"range\" max={duration} value={currentTime} style={{backgroundColor: 'red', height: '10px', width: '450px', marginBottom: '5px'}} onChange={changePlayTime} /> */}\r\n                                <Slider max={duration} value={currentTime} style={{height: '10px', width: '450px', marginTop: '-1px', marginLeft: '-1px'}} onChange={changePlayTime} />\r\n                            </div>\r\n                            <div className=\"time\" style={{color: 'white', marginLeft: '5px'}}>{parseTime(currentTime)}/{parseTime(duration)}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{margin: 'auto 5px'}}>\r\n                        <Button icon={<HeartOutlined />} title=\"收藏\" ghost size=\"small\" style={{border: '0'}} onClick={showCollectionListModal} />\r\n                    </div>\r\n                    <Dropdown overlay={createPlayList} placement=\"topCenter\" arrow>\r\n                        <Button style={{marginTop: '10px', border: '0'}} icon={<UnorderedListOutlined />} ghost />\r\n                    </Dropdown>\r\n                    <div className=\"volumeCtrl\" style={{marginLeft: '10px', display: 'flex'}}>\r\n                        <Button icon={volume !== 0 ? <i className=\"fa fa-volume-up\"></i> : <i className=\"fa fa-volume-off\"></i>} style={{marginTop: '10px', border: '0'}} ghost onClick={mute} />\r\n                        {/* <input type=\"range\" step=\"0.01\" max=\"1\" value={volume} onChange={changeVolume} /> */}\r\n                        <Slider max={1} value={volume} onChange={changeVolume} step={0.01} style={{width: '100px', marginTop: '20px'}} tooltipVisible={false} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <audio src={playList[index] ? playList[index].playUrl : ''} proload=\"auto\" onCanPlay={canPlay} onTimeUpdate={updatePlayTime} onVolumeChange={updateVolume} onEnded={playForward} ref={audio1} />\r\n            <Modal title=\"添加到歌单\" onCancel={closeCollectionListModal} visible={isCollectionListModalVisible} okText=\"确认\" cancelText=\"取消\" footer={null}>\r\n                <Menu onClick={handleCollection} style={{width: '480px', height: '400px', overflow: 'scroll', overflowX: 'hidden'}} defaultSelectedKeys=\"newList\">\r\n                    <Menu.Item key=\"newList\" icon={<PlusCircleOutlined />}>\r\n                        创建新歌单\r\n                    </Menu.Item>\r\n                    <Menu.Divider />\r\n                    {collectionList.map((list) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={list.collectionListId} style={{height: '50px'}}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <Image style={{width: '50px', height: '50px'}} src={list.collectionListImg} />\r\n                                        <div style={{width: '250px', margin: 'auto 20px'}}>{list.collectionListName}</div>\r\n                                        <div style={{width: '100px', margin: 'auto 10px'}}>{list.collectionListLength + '首'}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu> \r\n            </Modal>\r\n            <Modal title=\"创建新歌单\" onCancel={closeNewCollectionListModal} visible={isNewCollectionListModalVisible} footer={null}>\r\n                <Form onFinish={insertCollectionList}>\r\n                    <Form.Item label=\"歌单名\" name=\"collectionListName\" rules={[{ required: true, message: '歌单名不能为空' }]}>\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item wrapperCol={{ offset: 8, span: 16 }}>\r\n                        <Button type=\"primary\" htmlType=\"submit\">新建</Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}