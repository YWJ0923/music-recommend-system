{"ast":null,"code":"import _slicedToArray from\"D:/Programming/Project/Music_Recommend_System/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from'axios';import React,{useState,useEffect}from'react';import{Menu,Table,Button,Row,Col,Card}from'antd';import{Link}from'react-router-dom';import{SERVER_URL}from'../../utils/constant';import{playBarStore}from\"../../stores/playBarStore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Meta=Card.Meta;var musicColomns=[{dataIndex:'musicName',key:'musicName',title:'歌曲',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:function onClick(){playBarStore.addMusic(record);},style:{padding:'0'},children:text});},width:'300px'},{dataIndex:'artistName',key:'artistName',title:'歌手',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/artist/\".concat(record.artistId),children:text});},width:'200px'},{dataIndex:'albumName',key:'albumName',title:'专辑',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/album/\".concat(record.albumId),children:text});},width:'200px'},{dataIndex:'timeLength',key:'timeLength',title:'时长',render:function render(text){text=parseInt(text);text/=1000;var min=Math.floor(text/60);if(min<10){min='0'+min;}var sec=Math.floor(text%60);if(sec<10){sec='0'+sec;}return/*#__PURE__*/_jsx(\"span\",{children:min+':'+sec});},width:'100px'}];var albumColomns=[{dataIndex:'albumName',key:'albumName',title:'专辑',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsxs(Link,{to:\"/album/\".concat(record.albumId),style:{display:'flex'},children:[/*#__PURE__*/_jsx(\"img\",{alt:text,style:{width:'80px',height:'80px'},src:record.albumImg}),/*#__PURE__*/_jsx(\"div\",{style:{margin:'auto 20px'},children:text})]});},width:'400px'},{dataIndex:'artistName',key:'artistName',title:'歌手',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/artist/\".concat(record.artistId),children:text});},width:'200px'},{dataIndex:'albumPublishTime',key:'albumPublishTime',title:'发行时间',width:'100px'}];export default function Search(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),type=_useState4[0],setType=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),word=_useState6[0],setWord=_useState6[1];useEffect(function(){var params=new URLSearchParams(props.location.search);var type=params.get('type');var word=params.get('word');axios({method:'GET',url:SERVER_URL+'search',params:{type:type,word:word}}).then(function(response){if(response.data.status===200){setType(type);setWord(word);setData(response.data.data);}});},[props]);var handleClick=function handleClick(obj){props.history.push(\"/search?type=\".concat(obj.key,\"&word=\").concat(word));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Menu,{onClick:handleClick,mode:\"horizontal\",selectedKeys:type,children:[/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u5355\\u66F2\"},\"music\"),/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u6B4C\\u624B\"},\"artist\"),/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u4E13\\u8F91\"},\"album\")]}),type==='music'&&/*#__PURE__*/_jsx(Table,{dataSource:data,columns:musicColomns,pagination:{defaultPageSize:20},rowKey:function rowKey(record){return record.musicId;}}),type==='artist'&&(data[0]?/*#__PURE__*/_jsx(Row,{gutter:[10,5],children:data.map(function(artist,index){return/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Link,{to:\"/artist/\".concat(artist.artistId),children:/*#__PURE__*/_jsx(Card,{hoverable:true,cover:/*#__PURE__*/_jsx(\"img\",{alt:artist.artistName,src:artist.artistImg}),children:/*#__PURE__*/_jsx(Meta,{title:artist.artistName,style:{textAlign:'center'}})})})},index);})}):/*#__PURE__*/_jsx(Table,{dataSource:[],showHeader:false})),type==='album'&&/*#__PURE__*/_jsx(Table,{dataSource:data,columns:albumColomns,pagination:{defaultPageSize:20},rowKey:function rowKey(record){return record.albumId;}})]});}","map":{"version":3,"sources":["D:/Programming/Project/Music_Recommend_System/client/src/pages/Search/index.jsx"],"names":["axios","React","useState","useEffect","Menu","Table","Button","Row","Col","Card","Link","SERVER_URL","playBarStore","Meta","musicColomns","dataIndex","key","title","ellipsis","render","text","record","index","addMusic","padding","width","artistId","albumId","parseInt","min","Math","floor","sec","albumColomns","display","height","albumImg","margin","Search","props","data","setData","type","setType","word","setWord","params","URLSearchParams","location","search","get","method","url","then","response","status","handleClick","obj","history","push","defaultPageSize","musicId","map","artist","artistName","artistImg","textAlign"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport React, { useState, useEffect } from 'react'\r\nimport {Menu, Table, Button, Row, Col, Card} from 'antd';\r\nimport { Link } from 'react-router-dom';\r\nimport { SERVER_URL } from '../../utils/constant';\r\nimport {playBarStore} from \"../../stores/playBarStore\";\r\n\r\nconst {Meta} = Card;\r\nconst musicColomns = [\r\n    {\r\n        dataIndex: 'musicName',\r\n        key: 'musicName',\r\n        title: '歌曲',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Button type=\"link\" onClick={() => {\r\n                playBarStore.addMusic(record);\r\n            }} style={{padding: '0'}}>{text}</Button>);\r\n        },\r\n        width: '300px'\r\n    },\r\n    {\r\n        dataIndex: 'artistName',\r\n        key: 'artistName',\r\n        title: '歌手',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/artist/${record.artistId}`}>{text}</Link>);\r\n        },\r\n        width: '200px'\r\n    },\r\n    {\r\n        dataIndex: 'albumName',\r\n        key: 'albumName',\r\n        title: '专辑',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/album/${record.albumId}`}>{text}</Link>);\r\n        },\r\n        width: '200px'\r\n    },\r\n    {\r\n        dataIndex: 'timeLength',\r\n        key: 'timeLength',\r\n        title: '时长',\r\n        render: (text) => {\r\n            text = parseInt(text);\r\n            text /= 1000;\r\n            var min = Math.floor(text / 60);\r\n            if (min < 10) {\r\n                min = '0' + min;\r\n            }\r\n            var sec = Math.floor(text % 60);\r\n            if (sec < 10) {\r\n                sec = '0' + sec;\r\n            }\r\n            return (<span>{min + ':' + sec}</span>);\r\n        },\r\n        width: '100px'\r\n    }\r\n];\r\n\r\nconst albumColomns = [\r\n    {\r\n        dataIndex: 'albumName',\r\n        key: 'albumName',\r\n        title: '专辑',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (\r\n            <Link to={`/album/${record.albumId}`} style={{display: 'flex'}}>\r\n                <img alt={text} style={{width: '80px', height: '80px'}} src={record.albumImg} />\r\n                <div style={{margin: 'auto 20px'}}>{text}</div>\r\n            </Link>\r\n            );\r\n        },\r\n        width: '400px'\r\n    },\r\n    {\r\n        dataIndex: 'artistName',\r\n        key: 'artistName',\r\n        title: '歌手',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/artist/${record.artistId}`}>{text}</Link>);\r\n        },\r\n        width: '200px'\r\n    },\r\n    {\r\n        dataIndex: 'albumPublishTime',\r\n        key: 'albumPublishTime',\r\n        title: '发行时间',\r\n        width: '100px'\r\n    }\r\n];\r\n\r\nexport default function Search(props) {\r\n    const [data, setData] = useState([]);\r\n    const [type, setType] = useState('');\r\n    const [word, setWord] = useState('');\r\n\r\n    useEffect(() => {\r\n        const params = new URLSearchParams(props.location.search);\r\n        const type = params.get('type');\r\n        const word = params.get('word');\r\n        axios({\r\n            method: 'GET',\r\n            url: SERVER_URL + 'search',\r\n            params: {\r\n                type: type,\r\n                word: word\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 200) {\r\n                setType(type);\r\n                setWord(word);\r\n                setData(response.data.data);\r\n            }\r\n        });\r\n    }, [props]);\r\n\r\n    const handleClick = (obj) => {\r\n        props.history.push(`/search?type=${obj.key}&word=${word}`);\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Menu onClick={handleClick} mode=\"horizontal\" selectedKeys={type}>\r\n                <Menu.Item key=\"music\">单曲</Menu.Item>\r\n                <Menu.Item key=\"artist\">歌手</Menu.Item>\r\n                <Menu.Item key=\"album\">专辑</Menu.Item>\r\n            </Menu>\r\n            {type === 'music' && <Table dataSource={data} columns={musicColomns} pagination={{defaultPageSize: 20}} rowKey={record => record.musicId} />}\r\n            {type === 'artist' && (data[0] ? \r\n            <Row gutter={[10, 5]}>\r\n                {data.map((artist, index) => {\r\n                    return (<Col span={4} key={index}>\r\n                        <Link to={`/artist/${artist.artistId}`}>\r\n                                <Card hoverable cover={<img alt={artist.artistName} src={artist.artistImg} />}>\r\n                                        <Meta title={artist.artistName} style={{textAlign: 'center'}} />\r\n                                </Card>\r\n                        </Link>\r\n                    </Col>)\r\n                })}\r\n            </Row>\r\n            : <Table dataSource={[]} showHeader={false} />)}\r\n            {type === 'album' && <Table dataSource={data} columns={albumColomns} pagination={{defaultPageSize: 20}} rowKey={record => record.albumId}/>}\r\n        </>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}