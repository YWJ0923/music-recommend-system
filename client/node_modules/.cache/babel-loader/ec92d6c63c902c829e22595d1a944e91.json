{"ast":null,"code":"var _jsxFileName = \"D:\\\\Programming\\\\React\\\\Music_Recommend_System\\\\front\\\\src\\\\components\\\\PlayBar\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification, Slider } from 'antd';\nimport PubSub from 'pubsub-js';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { observer } from 'mobx-react';\nimport { getToken, removeToken } from '../../utils/auth';\nimport { SERVER_URL } from '../../utils/constant';\nimport { getPlayUrl } from \"../../utils/play\";\nimport { useStores } from '../../stores';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction PlayBar(props) {\n  _s();\n\n  // const [playList, setPlayList] = useState([]);\n  // const [index, setIndex] = useState(0);\n  const {\n    playList,\n    index,\n    setPlayList,\n    setIndex\n  } = useStores();\n  const [isPaused, setIsPaused] = useState(true);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [beginTime, setBeginTime] = useState(undefined);\n  const [duration, setDuration] = useState(0);\n  const [volume, setVolume] = useState(0.5);\n  const [collectionList, setCollectionList] = useState([]);\n  const [isCollectionListModalVisible, setIsCollectionListModalVisible] = useState(false);\n  const [isNewCollectionListModalVisible, setIsNewCollectionListModalVisible] = useState(false);\n  const [playUrl, setPlayUrl] = useState('');\n  const audio1 = useRef();\n  useEffect(() => {\n    // PubSub.subscribe('playMusic', playMusic);\n    PubSub.subscribe('addMusic', addMusic);\n    PubSub.subscribe('showNewCollectionListModal', showNewCollectionListModal); // PubSub.subscribe('playMusicList', playMusicList);\n\n    return () => {\n      PubSub.unsubscribe('addMusic'); // PubSub.unsubscribe('play');\n      // PubSub.unsubscribe('playMusicList');\n\n      PubSub.unsubscribe('showNewCollectionListModal');\n    }; // eslint-disable-next-line\n  }, []);\n  useEffect(() => {\n    if (playList[index]) {\n      setPlayUrl(getPlayUrl(playList[index]));\n    }\n  }, [playList, index]);\n\n  const addMusic = (message, musicVO) => {\n    let tmp = [...playList];\n    let i = tmp.findIndex(music => music.musicId === musicVO.musicId);\n    console.log(i);\n\n    if (i !== -1) {\n      tmp.splice(i, 1);\n    }\n\n    console.log(tmp);\n    tmp.push(musicVO);\n    console.log(tmp);\n    setPlayList(tmp);\n    setIndex(tmp.length - 1); // playMusic();\n  }; // const playMusic = () => {\n  //\n  // }\n  // 收到通知，播放音乐，data为music对象\n  // const playMusic = (message, data) => {\n  //     addPlayTimes();\n  //     // for (let i = 0; i < playList.length; i++) {\n  //     //     if (playList[i].musicId === data.musicId) {\n  //     //         setIndex(i);\n  //     //         return;\n  //     //     }\n  //     // }\n  //     let tmp = [...playList];\n  //     console.log(tmp);\n  //     let newIndex = tmp.findIndex((music) => {\n  //         return music.musicId === data.musicId;\n  //     });\n  //     let music = getMusicUrl(data);\n  //     if (newIndex !== -1) {\n  //         tmp.splice(newIndex, 1, music);\n  //         setPlayList(tmp);\n  //         setIndex(newIndex);\n  //     } else {\n  //         console.log([...tmp, music]);\n  //         setPlayList([...tmp, music]);\n  //         setIndex(tmp.length);\n  //     }\n  // }\n  // const playMusicList = (message, list) => {\n  //     let tmp = playList;\n  //     for (let i = 0; i < list.length; i++) {\n  //         let i = tmp.findIndex(music => music.musicId === list[i].musicId);\n  //         if (i !== -1) {\n  //             tmp.splice(i, 1);\n  //         }\n  //     }\n  //     let newIndex = tmp.length;\n  //     tmp.concat(list);\n  //     let music = getMusicUrl(tmp[newIndex]);\n  //     tmp.splice(newIndex, 1, music);\n  //     setPlayList(tmp);\n  //     setIndex(newIndex);\n  // }\n\n\n  const playBackward = () => {\n    addPlayTimes();\n\n    if (playList.length === 1) {\n      audio1.current.currentTime = 0;\n      audio1.current.play();\n    } else {\n      const newIndex = (index - 1 + playList.length) % playList.length;\n      setIndex(newIndex);\n    }\n  };\n\n  const playOrPause = () => {\n    isPaused ? audio1.current.play() : audio1.current.pause();\n    setIsPaused(!isPaused);\n  };\n\n  const playForward = () => {\n    addPlayTimes();\n\n    if (playList.length === 1) {\n      audio1.current.currentTime = 0;\n      audio1.current.play();\n    } else {\n      const newIndex = (index + 1) % playList.length;\n      setIndex(newIndex);\n    }\n  }; // 播放列表切换歌\n\n\n  const changeMusic = obj => {\n    // console.log(obj.key);\n    addPlayTimes();\n    const newIndex = playList.findIndex(music => {\n      return music.musicId === obj.key;\n    });\n    setIndex(newIndex);\n  }; // 播放列表\n\n\n  const createPlayList = () => {\n    if (playList[index]) {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        selectedKeys: [playList[index].musicId],\n        onClick: changeMusic,\n        style: {\n          width: '800px',\n          height: '300px',\n          overflow: 'scroll',\n          overflowX: 'hidden'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          style: {\n            width: '750px'\n          },\n          children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", playList.length, \")\"]\n        }, \"title\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this), playList.map(music => {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '450px'\n                  },\n                  children: music.musicName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '250px'\n                  },\n                  children: music.artistName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '50px'\n                  },\n                  children: parseTime(music.timeLength / 1000)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 37\n              }, this)\n            }, music.musicId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 17\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          style: {\n            width: '650px'\n          },\n          children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", playList.length, \")\"]\n        }, \"title\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }, this);\n    }\n  }; // 音乐加载完毕，可以播放\n\n\n  const canPlay = () => {\n    setIsPaused(false);\n    setBeginTime(new Date().getTime()); // console.log(beginTime);\n\n    setDuration(audio1.current.duration);\n    audio1.current.play();\n  }; // audio更新state时间\n\n\n  const updatePlayTime = () => {\n    setCurrentTime(audio1.current.currentTime);\n  }; // 停留时间超过30秒，增加播放量、用户播放量，换歌的时候执行\n\n\n  const addPlayTimes = () => {\n    if (playList[index]) {\n      const endTime = new Date().getTime(); // console.log(beginTime);\n      // console.log(endTime);\n\n      if (endTime - beginTime >= 30000) {\n        axios({\n          method: 'POST',\n          url: SERVER_URL + 'play_times/' + playList[index].musicId\n        }).then(response => {\n          console.log(response.data);\n        });\n\n        if (props.user) {\n          axios({\n            method: 'POST',\n            url: SERVER_URL + 'user/play_times/' + playList[index].musicId,\n            headers: {\n              Authorization: getToken()\n            },\n            data: {\n              time_length: endTime - beginTime\n            }\n          }).then(response => {\n            if (response.data.status === 2) {\n              removeToken();\n            }\n          });\n        }\n      }\n    }\n  }; // 拖动条改变时间\n\n\n  const changePlayTime = value => {\n    audio1.current.currentTime = value;\n  }; // 解析时间成00:00格式, time以秒为单位\n\n\n  const parseTime = time => {\n    var min = Math.floor(time / 60);\n\n    if (min < 10) {\n      min = '0' + min;\n    }\n\n    var sec = Math.floor(time % 60);\n\n    if (sec < 10) {\n      sec = '0' + sec;\n    }\n\n    return min + ':' + sec;\n  }; // audio更新音量\n\n\n  const updateVolume = () => {\n    setVolume(audio1.current.volume);\n  }; // 静音或者音量最大\n\n\n  const mute = () => {\n    audio1.current.volume = audio1.current.volume > 0 ? 0 : 1;\n  }; // 拖动条改变音量\n\n\n  const changeVolume = value => {\n    audio1.current.volume = value;\n  };\n\n  const showCollectionListModal = () => {\n    if (!props.user) {\n      PubSub.publish('showLoginModal');\n    } else {\n      axios({\n        method: 'GET',\n        url: SERVER_URL + 'collection_list',\n        headers: {\n          Authorization: getToken()\n        }\n      }).then(response => {\n        if (response.data.status !== 1) {\n          PubSub.publish('logout');\n          PubSub.publish('showLoginModal');\n        } else {\n          setCollectionList(response.data.data);\n          setIsCollectionListModalVisible(true);\n        }\n      });\n    }\n  };\n\n  const closeCollectionListModal = () => {\n    setIsCollectionListModalVisible(false);\n  };\n\n  const showNewCollectionListModal = () => {\n    setIsCollectionListModalVisible(false);\n    setIsNewCollectionListModalVisible(true);\n  };\n\n  const closeNewCollectionListModal = () => {\n    setIsNewCollectionListModalVisible(false);\n  };\n\n  const handleCollection = obj => {\n    if (playList[index]) {\n      if (obj.key === 'newList') {\n        showNewCollectionListModal();\n      } else {\n        insertMusicToCollectionList(obj.key, playList[index].musicId);\n      }\n    }\n\n    closeCollectionListModal();\n  };\n\n  const insertMusicToCollectionList = (collectionListId, musicId) => {\n    axios({\n      method: 'POST',\n      url: SERVER_URL + 'collection_list/' + collectionListId + '/' + musicId,\n      headers: {\n        Authorization: getToken()\n      }\n    }).then(response => {\n      if (response.data.status === 2) {\n        PubSub.publish('logout');\n      } else if (response.data.status === 1) {\n        showNotification(response.data.message);\n      }\n    });\n  };\n\n  const insertCollectionList = values => {\n    axios({\n      method: 'POST',\n      url: SERVER_URL + 'collection_list/' + values.collectionListName,\n      headers: {\n        Authorization: getToken()\n      }\n    }).then(response => {\n      if (response.data.status === 2) {\n        PubSub.publish('logout');\n      } else if (response.data.status === 1) {\n        showNotification(response.data.message);\n        PubSub.publish('getCollectionList');\n      }\n    });\n    closeNewCollectionListModal();\n  };\n\n  const showNotification = message => {\n    notification.open({\n      message: message,\n      placement: 'bottomRight',\n      duration: 2\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        left: 0,\n        bottom: 0,\n        height: '60px',\n        backgroundColor: 'black',\n        width: '100%'\n      },\n      id: \"playbar\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: '5px auto',\n          width: '1000px',\n          display: 'flex'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playBackward,\n          children: /*#__PURE__*/_jsxDEV(StepBackwardOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '25px',\n              marginTop: '-2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playOrPause,\n          size: \"large\",\n          children: isPaused ? /*#__PURE__*/_jsxDEV(CaretRightOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '32px',\n              marginLeft: '4px',\n              marginTop: '-4px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 37\n          }, this) : /*#__PURE__*/_jsxDEV(PauseOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '32px',\n              marginLeft: '0',\n              marginTop: '-4.5px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 143\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          shape: \"circle\",\n          style: {\n            backgroundColor: 'black',\n            margin: 'auto 5px',\n            borderWidth: '2px'\n          },\n          onClick: playForward,\n          children: /*#__PURE__*/_jsxDEV(StepForwardOutlined, {\n            style: {\n              color: 'white',\n              fontSize: '25px',\n              marginTop: '-2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 21\n        }, this), playList[index] ? /*#__PURE__*/_jsxDEV(Link, {\n          to: `/album/${playList[index].albumId}`,\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: playList[index].musicName,\n            src: playList[index].albumImg,\n            style: {\n              width: '50px',\n              height: '50px',\n              margin: '0 10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"718\\u97F3\\u4E50\",\n          src: \"/favicon.ico\",\n          style: {\n            width: '50px',\n            height: '50px',\n            margin: '0 10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '550px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#e8e8e8'\n            },\n            children: [playList[index] ? playList[index].musicName : '718音乐', playList[index] && /*#__PURE__*/_jsxDEV(Link, {\n              to: `/artist/${playList[index].artistId}`,\n              style: {\n                color: '#9b9b9b'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: '10px',\n                  marginLeft: '20px'\n                },\n                children: playList[index].artistName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 125\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 49\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"barAndTime\",\n            style: {\n              marginTop: '8px',\n              width: '550px',\n              display: 'flex'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bar\",\n              style: {\n                width: '450px',\n                height: '10px',\n                marginTop: '7px',\n                display: 'flex'\n              },\n              children: /*#__PURE__*/_jsxDEV(Slider, {\n                max: duration,\n                value: currentTime,\n                style: {\n                  height: '10px',\n                  width: '450px',\n                  marginTop: '-1px',\n                  marginLeft: '-1px'\n                },\n                onChange: changePlayTime\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"time\",\n              style: {\n                color: 'white',\n                marginLeft: '5px'\n              },\n              children: [parseTime(currentTime), \"/\", parseTime(duration)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: 'auto 5px'\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            icon: /*#__PURE__*/_jsxDEV(HeartOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 39\n            }, this),\n            title: \"\\u6536\\u85CF\",\n            ghost: true,\n            size: \"small\",\n            style: {\n              border: '0'\n            },\n            onClick: showCollectionListModal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n          overlay: createPlayList,\n          placement: \"topCenter\",\n          arrow: true,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              marginTop: '10px',\n              border: '0'\n            },\n            icon: /*#__PURE__*/_jsxDEV(UnorderedListOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 80\n            }, this),\n            ghost: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"volumeCtrl\",\n          style: {\n            marginLeft: '10px',\n            display: 'flex'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            icon: volume !== 0 ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-volume-up\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 54\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-volume-off\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 92\n            }, this),\n            style: {\n              marginTop: '10px',\n              border: '0'\n            },\n            ghost: true,\n            onClick: mute\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            max: 1,\n            value: volume,\n            onChange: changeVolume,\n            step: 0.01,\n            style: {\n              width: '100px',\n              marginTop: '20px'\n            },\n            tooltipVisible: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      src: playUrl,\n      proload: \"auto\",\n      onCanPlay: canPlay,\n      onTimeUpdate: updatePlayTime,\n      onVolumeChange: updateVolume,\n      onEnded: playForward,\n      ref: audio1\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u6DFB\\u52A0\\u5230\\u6B4C\\u5355\",\n      onCancel: closeCollectionListModal,\n      visible: isCollectionListModalVisible,\n      okText: \"\\u786E\\u8BA4\",\n      cancelText: \"\\u53D6\\u6D88\",\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(Menu, {\n        onClick: handleCollection,\n        style: {\n          width: '480px',\n          height: '400px',\n          overflow: 'scroll',\n          overflowX: 'hidden'\n        },\n        defaultSelectedKeys: \"newList\",\n        children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n          icon: /*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 52\n          }, this),\n          children: \"\\u521B\\u5EFA\\u65B0\\u6B4C\\u5355\"\n        }, \"newList\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 21\n        }, this), collectionList.map(list => {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n              style: {\n                height: '50px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Image, {\n                  style: {\n                    width: '50px',\n                    height: '50px'\n                  },\n                  src: list.collectionListImg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 406,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '250px',\n                    margin: 'auto 20px'\n                  },\n                  children: list.collectionListName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 407,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '100px',\n                    margin: 'auto 10px'\n                  },\n                  children: list.collectionListLength + '首'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 408,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 37\n              }, this)\n            }, list.collectionListId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u521B\\u5EFA\\u65B0\\u6B4C\\u5355\",\n      onCancel: closeNewCollectionListModal,\n      visible: isNewCollectionListModalVisible,\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        onFinish: insertCollectionList,\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u6B4C\\u5355\\u540D\",\n          name: \"collectionListName\",\n          rules: [{\n            required: true,\n            message: '歌单名不能为空'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          wrapperCol: {\n            offset: 8,\n            span: 16\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            children: \"\\u65B0\\u5EFA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(PlayBar, \"xVcwQoZJNHywixzU3jUEz8TRuRs=\", false, function () {\n  return [useStores];\n});\n\n_c = PlayBar;\nexport default _c2 = observer(PlayBar);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"PlayBar\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["D:/Programming/React/Music_Recommend_System/front/src/components/PlayBar/index.jsx"],"names":["React","useEffect","useState","useRef","StepBackwardOutlined","StepForwardOutlined","CaretRightOutlined","PauseOutlined","UnorderedListOutlined","HeartOutlined","PlusCircleOutlined","Button","Dropdown","Menu","Modal","Image","Form","Input","notification","Slider","PubSub","axios","Link","observer","getToken","removeToken","SERVER_URL","getPlayUrl","useStores","PlayBar","props","playList","index","setPlayList","setIndex","isPaused","setIsPaused","currentTime","setCurrentTime","beginTime","setBeginTime","undefined","duration","setDuration","volume","setVolume","collectionList","setCollectionList","isCollectionListModalVisible","setIsCollectionListModalVisible","isNewCollectionListModalVisible","setIsNewCollectionListModalVisible","playUrl","setPlayUrl","audio1","subscribe","addMusic","showNewCollectionListModal","unsubscribe","message","musicVO","tmp","i","findIndex","music","musicId","console","log","splice","push","length","playBackward","addPlayTimes","current","play","newIndex","playOrPause","pause","playForward","changeMusic","obj","key","createPlayList","width","height","overflow","overflowX","map","display","musicName","artistName","parseTime","timeLength","canPlay","Date","getTime","updatePlayTime","endTime","method","url","then","response","data","user","headers","Authorization","time_length","status","changePlayTime","value","time","min","Math","floor","sec","updateVolume","mute","changeVolume","showCollectionListModal","publish","closeCollectionListModal","closeNewCollectionListModal","handleCollection","insertMusicToCollectionList","collectionListId","showNotification","insertCollectionList","values","collectionListName","open","placement","position","left","bottom","backgroundColor","margin","borderWidth","color","fontSize","marginTop","marginLeft","albumId","albumImg","artistId","border","list","collectionListImg","collectionListLength","required","offset","span"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react'\r\nimport {StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined} from '@ant-design/icons';\r\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification, Slider } from 'antd'\r\nimport PubSub from 'pubsub-js';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport {observer} from 'mobx-react';\r\nimport { getToken, removeToken } from '../../utils/auth';\r\nimport { SERVER_URL } from '../../utils/constant';\r\nimport {getPlayUrl} from \"../../utils/play\";\r\nimport {useStores} from '../../stores';\r\n\r\nfunction PlayBar(props) {\r\n    // const [playList, setPlayList] = useState([]);\r\n    // const [index, setIndex] = useState(0);\r\n    const {playList, index, setPlayList, setIndex} = useStores();\r\n\r\n    const [isPaused, setIsPaused] = useState(true);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [beginTime, setBeginTime] = useState(undefined);\r\n    const [duration, setDuration] = useState(0);\r\n    const [volume, setVolume] = useState(0.5);\r\n    const [collectionList, setCollectionList] = useState([]);\r\n    const [isCollectionListModalVisible, setIsCollectionListModalVisible] = useState(false);\r\n    const [isNewCollectionListModalVisible, setIsNewCollectionListModalVisible] = useState(false);\r\n    const [playUrl, setPlayUrl] = useState('');\r\n\r\n    const audio1 = useRef();\r\n\r\n    useEffect(() => {\r\n        // PubSub.subscribe('playMusic', playMusic);\r\n        PubSub.subscribe('addMusic', addMusic);\r\n        PubSub.subscribe('showNewCollectionListModal', showNewCollectionListModal);\r\n        // PubSub.subscribe('playMusicList', playMusicList);\r\n        return () => {\r\n            PubSub.unsubscribe('addMusic');\r\n            // PubSub.unsubscribe('play');\r\n            // PubSub.unsubscribe('playMusicList');\r\n            PubSub.unsubscribe('showNewCollectionListModal');\r\n        }  // eslint-disable-next-line\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (playList[index]) {\r\n            setPlayUrl(getPlayUrl(playList[index]));\r\n        }\r\n    }, [playList, index]);\r\n\r\n    const addMusic = (message, musicVO) => {\r\n        let tmp = [...playList];\r\n        let i = tmp.findIndex(music => music.musicId === musicVO.musicId);\r\n        console.log(i);\r\n        if (i !== -1) {\r\n            tmp.splice(i, 1);\r\n        }\r\n        console.log(tmp);\r\n        tmp.push(musicVO);\r\n        console.log(tmp);\r\n        setPlayList(tmp);\r\n        setIndex(tmp.length - 1);\r\n        // playMusic();\r\n    }\r\n\r\n    // const playMusic = () => {\r\n    //\r\n    // }\r\n    // 收到通知，播放音乐，data为music对象\r\n    // const playMusic = (message, data) => {\r\n    //     addPlayTimes();\r\n    //     // for (let i = 0; i < playList.length; i++) {\r\n    //     //     if (playList[i].musicId === data.musicId) {\r\n    //     //         setIndex(i);\r\n    //     //         return;\r\n    //     //     }\r\n    //     // }\r\n    //     let tmp = [...playList];\r\n    //     console.log(tmp);\r\n    //     let newIndex = tmp.findIndex((music) => {\r\n    //         return music.musicId === data.musicId;\r\n    //     });\r\n    //     let music = getMusicUrl(data);\r\n    //     if (newIndex !== -1) {\r\n    //         tmp.splice(newIndex, 1, music);\r\n    //         setPlayList(tmp);\r\n    //         setIndex(newIndex);\r\n    //     } else {\r\n    //         console.log([...tmp, music]);\r\n    //         setPlayList([...tmp, music]);\r\n    //         setIndex(tmp.length);\r\n    //     }\r\n    // }\r\n\r\n    // const playMusicList = (message, list) => {\r\n    //     let tmp = playList;\r\n    //     for (let i = 0; i < list.length; i++) {\r\n    //         let i = tmp.findIndex(music => music.musicId === list[i].musicId);\r\n    //         if (i !== -1) {\r\n    //             tmp.splice(i, 1);\r\n    //         }\r\n    //     }\r\n    //     let newIndex = tmp.length;\r\n    //     tmp.concat(list);\r\n    //     let music = getMusicUrl(tmp[newIndex]);\r\n    //     tmp.splice(newIndex, 1, music);\r\n    //     setPlayList(tmp);\r\n    //     setIndex(newIndex);\r\n    // }\r\n\r\n    const playBackward = () => {\r\n        addPlayTimes();\r\n        if (playList.length === 1) {\r\n            audio1.current.currentTime = 0\r\n            audio1.current.play();\r\n        }\r\n        else {\r\n            const newIndex = (index - 1 + playList.length) % playList.length;\r\n            setIndex(newIndex);\r\n        }\r\n    }\r\n    \r\n    const playOrPause = () => {\r\n        isPaused ? audio1.current.play() : audio1.current.pause();\r\n        setIsPaused(!isPaused);\r\n    }\r\n\r\n    const playForward = () => {\r\n        addPlayTimes();\r\n        if (playList.length === 1) {\r\n            audio1.current.currentTime = 0\r\n            audio1.current.play();\r\n        }\r\n        else {\r\n            const newIndex = (index + 1) % playList.length;\r\n            setIndex(newIndex);\r\n        }\r\n    }\r\n\r\n    // 播放列表切换歌\r\n    const changeMusic = (obj) => {\r\n        // console.log(obj.key);\r\n        addPlayTimes();\r\n        const newIndex = playList.findIndex((music) => {\r\n            return music.musicId === obj.key;\r\n        });\r\n        setIndex(newIndex);\r\n    }\r\n\r\n    // 播放列表\r\n    const createPlayList = () => {\r\n        if (playList[index]) {\r\n            return (\r\n                <Menu selectedKeys={[playList[index].musicId]} onClick={changeMusic} style={{width: '800px', height: '300px', overflow: 'scroll', overflowX: 'hidden'}}>\r\n                    <Menu.Item key=\"title\" style={{width: '750px'}}>播放列表 ({playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                    {playList.map((music) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={music.musicId}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <div style={{width: '450px'}}>{music.musicName}</div>\r\n                                        <div style={{width: '250px'}}>{music.artistName}</div>\r\n                                        <div style={{width: '50px'}}>{parseTime(music.timeLength / 1000)}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu>\r\n            );\r\n        } else {\r\n            return (\r\n                <Menu>\r\n                    <Menu.Item key=\"title\" style={{width: '650px'}}>播放列表 ({playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                </Menu>\r\n            );\r\n        }\r\n        \r\n    }\r\n\r\n    // 音乐加载完毕，可以播放\r\n    const canPlay = () => {\r\n        setIsPaused(false);\r\n        setBeginTime(new Date().getTime());\r\n        // console.log(beginTime);\r\n        setDuration(audio1.current.duration);\r\n        audio1.current.play();\r\n    }\r\n\r\n    // audio更新state时间\r\n    const updatePlayTime = () => {\r\n        setCurrentTime(audio1.current.currentTime);\r\n    }\r\n\r\n    // 停留时间超过30秒，增加播放量、用户播放量，换歌的时候执行\r\n    const addPlayTimes = () => {\r\n        if (playList[index]) {\r\n            const endTime = new Date().getTime();\r\n            // console.log(beginTime);\r\n            // console.log(endTime);\r\n            if (endTime - beginTime >= 30000) {\r\n                axios({\r\n                    method: 'POST',\r\n                    url: SERVER_URL +  'play_times/' + playList[index].musicId\r\n                }).then((response) => {\r\n                    console.log(response.data);\r\n                });\r\n                if (props.user) {\r\n                    axios({\r\n                        method: 'POST',\r\n                        url: SERVER_URL +  'user/play_times/' + playList[index].musicId,\r\n                        headers: {\r\n                            Authorization: getToken()\r\n                        },\r\n                        data: {\r\n                            time_length: endTime - beginTime\r\n                        }\r\n                    }).then((response) => {\r\n                        if (response.data.status === 2) {\r\n                            removeToken();\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    // 拖动条改变时间\r\n    const changePlayTime = (value) => {\r\n        audio1.current.currentTime = value;\r\n    }\r\n    \r\n    // 解析时间成00:00格式, time以秒为单位\r\n    const parseTime = (time) => {\r\n        var min = Math.floor(time / 60);\r\n        if (min < 10) {\r\n            min = '0' + min;\r\n        }\r\n        var sec = Math.floor(time % 60);\r\n        if (sec < 10) {\r\n            sec = '0' + sec;\r\n        }\r\n        return min + ':' + sec;\r\n    }\r\n    \r\n    // audio更新音量\r\n    const updateVolume = () => {\r\n        setVolume(audio1.current.volume);\r\n    }\r\n\r\n    // 静音或者音量最大\r\n    const mute = () => {\r\n        audio1.current.volume = audio1.current.volume > 0 ? 0 : 1;\r\n    }\r\n\r\n    // 拖动条改变音量\r\n    const changeVolume = (value) => {\r\n        audio1.current.volume = value;\r\n    }\r\n\r\n    const showCollectionListModal = () => {\r\n        if (!props.user) {\r\n            PubSub.publish('showLoginModal');\r\n        } else{\r\n            axios({\r\n                method: 'GET',\r\n                url: SERVER_URL + 'collection_list',\r\n                headers: {\r\n                    Authorization: getToken()\r\n                }\r\n            }).then((response) => {\r\n                if (response.data.status !== 1) {\r\n                    PubSub.publish('logout');\r\n                    PubSub.publish('showLoginModal');\r\n                } else{\r\n                    setCollectionList(response.data.data);\r\n                    setIsCollectionListModalVisible(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    const closeCollectionListModal = () => {\r\n        setIsCollectionListModalVisible(false);\r\n    }\r\n\r\n    const showNewCollectionListModal = () => {\r\n        setIsCollectionListModalVisible(false);\r\n        setIsNewCollectionListModalVisible(true);\r\n    }\r\n\r\n    const closeNewCollectionListModal = () => {\r\n        setIsNewCollectionListModalVisible(false);\r\n    }\r\n\r\n    const handleCollection = (obj) => {\r\n        if (playList[index]) {\r\n            if (obj.key === 'newList') {\r\n                showNewCollectionListModal();\r\n            } else {\r\n                insertMusicToCollectionList(obj.key, playList[index].musicId);\r\n            }\r\n        }\r\n        closeCollectionListModal();\r\n    }\r\n\r\n    const insertMusicToCollectionList = (collectionListId, musicId) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: SERVER_URL + 'collection_list/' + collectionListId + '/' + musicId,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 2) {\r\n                PubSub.publish('logout');\r\n            } else if (response.data.status === 1) {\r\n                showNotification(response.data.message);\r\n            }\r\n        })\r\n    }\r\n\r\n    const insertCollectionList = (values) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: SERVER_URL + 'collection_list/' + values.collectionListName,\r\n            headers: {\r\n                Authorization: getToken()\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 2) {\r\n                PubSub.publish('logout');\r\n            } else if (response.data.status === 1) {\r\n                showNotification(response.data.message);\r\n                PubSub.publish('getCollectionList');\r\n            }\r\n        });\r\n        closeNewCollectionListModal();\r\n    }\r\n\r\n    const showNotification = (message) => {\r\n        notification.open({\r\n            message: message,\r\n            placement: 'bottomRight',\r\n            duration: 2\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div style={{position: 'fixed', left: 0, bottom: 0, height: '60px', backgroundColor: 'black', width: '100%'}} id=\"playbar\">\r\n                <div style={{margin: '5px auto', width: '1000px', display: 'flex'}}>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playBackward}>\r\n                        <StepBackwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                    </Button>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playOrPause} size=\"large\">\r\n                        {isPaused ? <CaretRightOutlined style={{color: 'white', fontSize: '32px', marginLeft: '4px', marginTop: '-4px'}} /> : <PauseOutlined style={{color: 'white', fontSize: '32px', marginLeft: '0', marginTop: '-4.5px'}} />}\r\n                    </Button>\r\n                    <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={playForward}>\r\n                        <StepForwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                    </Button>\r\n                    {playList[index] ? \r\n                    <Link to={`/album/${playList[index].albumId}`}>\r\n                        <img alt={playList[index].musicName} src={playList[index].albumImg} style={{width: '50px', height: '50px', margin: '0 10px'}} />\r\n                    </Link> \r\n                    : <img alt=\"718音乐\" src=\"/favicon.ico\" style={{width: '50px', height: '50px', margin: '0 10px'}} />}\r\n                    <div style={{width: '550px'}}>\r\n                        <div style={{color: '#e8e8e8'}}>\r\n                            {playList[index] ? playList[index].musicName : '718音乐'}\r\n                            {playList[index] && <Link to={`/artist/${playList[index].artistId}`} style={{color: '#9b9b9b'}}><span style={{fontSize: '10px', marginLeft: '20px'}}>{playList[index].artistName}</span></Link>}\r\n                        </div>\r\n                        <div className=\"barAndTime\" style={{marginTop: '8px', width: '550px', display: 'flex'}}>\r\n                            <div className=\"bar\" style={{width: '450px', height: '10px', marginTop: '7px', display: 'flex'}}>\r\n                                {/* <input type=\"range\" max={duration} value={currentTime} style={{backgroundColor: 'red', height: '10px', width: '450px', marginBottom: '5px'}} onChange={changePlayTime} /> */}\r\n                                <Slider max={duration} value={currentTime} style={{height: '10px', width: '450px', marginTop: '-1px', marginLeft: '-1px'}} onChange={changePlayTime} />\r\n                            </div>\r\n                            <div className=\"time\" style={{color: 'white', marginLeft: '5px'}}>{parseTime(currentTime)}/{parseTime(duration)}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div style={{margin: 'auto 5px'}}>\r\n                        <Button icon={<HeartOutlined />} title=\"收藏\" ghost size=\"small\" style={{border: '0'}} onClick={showCollectionListModal} />\r\n                    </div>\r\n                    <Dropdown overlay={createPlayList} placement=\"topCenter\" arrow>\r\n                        <Button style={{marginTop: '10px', border: '0'}} icon={<UnorderedListOutlined />} ghost />\r\n                    </Dropdown>\r\n                    <div className=\"volumeCtrl\" style={{marginLeft: '10px', display: 'flex'}}>\r\n                        <Button icon={volume !== 0 ? <i className=\"fa fa-volume-up\"></i> : <i className=\"fa fa-volume-off\"></i>} style={{marginTop: '10px', border: '0'}} ghost onClick={mute} />\r\n                        {/* <input type=\"range\" step=\"0.01\" max=\"1\" value={volume} onChange={changeVolume} /> */}\r\n                        <Slider max={1} value={volume} onChange={changeVolume} step={0.01} style={{width: '100px', marginTop: '20px'}} tooltipVisible={false} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <audio src={playUrl} proload=\"auto\" onCanPlay={canPlay} onTimeUpdate={updatePlayTime} onVolumeChange={updateVolume} onEnded={playForward} ref={audio1} />\r\n            <Modal title=\"添加到歌单\" onCancel={closeCollectionListModal} visible={isCollectionListModalVisible} okText=\"确认\" cancelText=\"取消\" footer={null}>\r\n                <Menu onClick={handleCollection} style={{width: '480px', height: '400px', overflow: 'scroll', overflowX: 'hidden'}} defaultSelectedKeys=\"newList\">\r\n                    <Menu.Item key=\"newList\" icon={<PlusCircleOutlined />}>\r\n                        创建新歌单\r\n                    </Menu.Item>\r\n                    <Menu.Divider />\r\n                    {collectionList.map((list) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={list.collectionListId} style={{height: '50px'}}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <Image style={{width: '50px', height: '50px'}} src={list.collectionListImg} />\r\n                                        <div style={{width: '250px', margin: 'auto 20px'}}>{list.collectionListName}</div>\r\n                                        <div style={{width: '100px', margin: 'auto 10px'}}>{list.collectionListLength + '首'}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu> \r\n            </Modal>\r\n            <Modal title=\"创建新歌单\" onCancel={closeNewCollectionListModal} visible={isNewCollectionListModalVisible} footer={null}>\r\n                <Form onFinish={insertCollectionList}>\r\n                    <Form.Item label=\"歌单名\" name=\"collectionListName\" rules={[{ required: true, message: '歌单名不能为空' }]}>\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item wrapperCol={{ offset: 8, span: 16 }}>\r\n                        <Button type=\"primary\" htmlType=\"submit\">新建</Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default observer(PlayBar);\r\n"]},"metadata":{},"sourceType":"module"}