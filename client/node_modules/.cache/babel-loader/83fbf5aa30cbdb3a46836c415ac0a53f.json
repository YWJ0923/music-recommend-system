{"ast":null,"code":"import _slicedToArray from\"D:/Programming/Project/Music_Recommend_System/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import{Button,Layout,Menu,Table}from\"antd\";import{Link}from\"react-router-dom\";import axios from\"axios\";import{playBarStore}from\"../../stores/playBarStore\";import{SERVER_URL}from\"../../utils/constant\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Content=Layout.Content,Sider=Layout.Sider;var SubMenu=Menu.SubMenu;var colomns=[{key:'index',render:function render(text,record,index){return index+1;},width:'50px'},{dataIndex:'musicName',key:'musicName',title:'歌曲',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsxs(Button,{type:\"link\",onClick:function onClick(){playBarStore.addMusic(record);},style:{padding:'0'},children:[/*#__PURE__*/_jsx(\"img\",{alt:text,src:record.albumImg,style:{height:'50px',width:'50px',marginRight:'10px'}}),text]});},width:'300px'},{dataIndex:'artistName',key:'artistName',title:'歌手',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/artist/\".concat(record.artistId),children:text});},width:'150px'},{dataIndex:'albumName',key:'albumName',title:'专辑',ellipsis:true,render:function render(text,record,index){return/*#__PURE__*/_jsx(Link,{to:\"/album/\".concat(record.albumId),children:text});},width:'150px'},{dataIndex:'timeLength',key:'timeLength',title:'时长',render:function render(text){text=parseInt(text);text/=1000;var min=Math.floor(text/60);if(min<10){min='0'+min;}var sec=Math.floor(text%60);if(sec<10){sec='0'+sec;}return/*#__PURE__*/_jsx(\"span\",{children:min+':'+sec});},width:'100px'}];export default function TopList(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState('type=total'),_useState4=_slicedToArray(_useState3,2),selectedKeys=_useState4[0],setSelectedKeys=_useState4[1];var _useState5=useState('总榜'),_useState6=_slicedToArray(_useState5,2),title=_useState6[0],setTitle=_useState6[1];var titleArr=['华语榜','欧美榜','日韩榜'];useEffect(function(){var params=new URLSearchParams(props.location.search);var type=params.get('type');axios({method:'GET',url:SERVER_URL+'topList',params:{type:type}}).then(function(response){if(response.data.status===200){setData(response.data.data);setSelectedKeys(\"type=\".concat(type));setTitle(type==='total'?'总榜':titleArr[parseInt(type)]);}else{props.history.push('/error');}});// eslint-disable-next-line\n},[props]);var handleClick=function handleClick(obj){props.history.push(\"/top_list?\".concat(obj.key));};var tableTitle=function tableTitle(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold',fontSize:'25px',display:'inline',marginRight:'20px'},children:title}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'15px',display:'inline'},children:\"\\u6BCF\\u65E5\\u66F4\\u65B0\"})]});};return/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsx(Sider,{style:{width:250},children:/*#__PURE__*/_jsxs(Menu,{mode:\"inline\",defaultSelectedKeys:\"type=total\",style:{height:'100%'},onClick:handleClick,defaultOpenKeys:['0','1','2'],selectedKeys:selectedKeys,children:[/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u603B\\u699C\"},\"type=total\"),/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u534E\\u8BED\\u699C\"},\"type=0\"),/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u6B27\\u7F8E\\u699C\"},\"type=1\"),/*#__PURE__*/_jsx(Menu.Item,{children:\"\\u65E5\\u97E9\\u699C\"},\"type=2\")]})}),/*#__PURE__*/_jsx(Content,{style:{minHeight:280},children:/*#__PURE__*/_jsx(Table,{dataSource:data,columns:colomns,rowKey:function rowKey(record){return record.musicId;},pagination:false,title:tableTitle})})]});}","map":{"version":3,"sources":["D:/Programming/Project/Music_Recommend_System/client/src/pages/TopList/index.jsx"],"names":["React","useEffect","useRef","useState","Button","Layout","Menu","Table","Link","axios","playBarStore","SERVER_URL","Content","Sider","SubMenu","colomns","key","render","text","record","index","width","dataIndex","title","ellipsis","addMusic","padding","albumImg","height","marginRight","artistId","albumId","parseInt","min","Math","floor","sec","TopList","props","data","setData","selectedKeys","setSelectedKeys","setTitle","titleArr","params","URLSearchParams","location","search","type","get","method","url","then","response","status","history","push","handleClick","obj","tableTitle","fontWeight","fontSize","display","minHeight","musicId"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\r\nimport {Button, Layout, Menu, Table} from \"antd\";\r\nimport {Link} from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport {playBarStore} from \"../../stores/playBarStore\";\r\nimport {SERVER_URL} from \"../../utils/constant\";\r\n\r\nconst { Content, Sider } = Layout;\r\nconst {SubMenu} = Menu;\r\n\r\nconst colomns = [\r\n    {\r\n        key: 'index',\r\n        render: (text, record, index) => {\r\n            return index + 1;\r\n        },\r\n        width: '50px'\r\n    },\r\n    {\r\n        dataIndex: 'musicName',\r\n        key: 'musicName',\r\n        title: '歌曲',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Button type=\"link\" onClick={() => {\r\n                playBarStore.addMusic(record);\r\n            }} style={{padding: '0'}}>\r\n                <img alt={text} src={record.albumImg} style={{height: '50px', width: '50px', marginRight: '10px'}} />\r\n                {text}\r\n            </Button>);\r\n        },\r\n        width: '300px'\r\n    },\r\n    {\r\n        dataIndex: 'artistName',\r\n        key: 'artistName',\r\n        title: '歌手',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/artist/${record.artistId}`}>{text}</Link>);\r\n        },\r\n        width: '150px'\r\n    },\r\n    {\r\n        dataIndex: 'albumName',\r\n        key: 'albumName',\r\n        title: '专辑',\r\n        ellipsis: true,\r\n        render: (text, record, index) => {\r\n            return (<Link to={`/album/${record.albumId}`}>{text}</Link>);\r\n        },\r\n        width: '150px'\r\n    },\r\n    {\r\n        dataIndex: 'timeLength',\r\n        key: 'timeLength',\r\n        title: '时长',\r\n        render: (text) => {\r\n            text = parseInt(text);\r\n            text /= 1000;\r\n            var min = Math.floor(text / 60);\r\n            if (min < 10) {\r\n                min = '0' + min;\r\n            }\r\n            var sec = Math.floor(text % 60);\r\n            if (sec < 10) {\r\n                sec = '0' + sec;\r\n            }\r\n            return (<span>{min + ':' + sec}</span>);\r\n        },\r\n        width: '100px'\r\n    }\r\n]\r\n\r\nexport default function TopList(props) {\r\n    const [data, setData] = useState([]);\r\n    const [selectedKeys, setSelectedKeys] = useState('type=total');\r\n    const [title, setTitle] = useState('总榜');\r\n\r\n    const titleArr = ['华语榜', '欧美榜', '日韩榜'];\r\n\r\n    useEffect(() => {\r\n        const params = new URLSearchParams(props.location.search);\r\n        const type = params.get('type');\r\n        axios({\r\n            method: 'GET',\r\n            url: SERVER_URL + 'topList',\r\n            params: {\r\n                type: type\r\n            }\r\n        }).then((response) => {\r\n            if (response.data.status === 200) {\r\n                setData(response.data.data);\r\n                setSelectedKeys(`type=${type}`);\r\n                setTitle(type === 'total' ? '总榜' : titleArr[parseInt(type)]);\r\n            } else {\r\n                props.history.push('/error');\r\n            }\r\n        });  // eslint-disable-next-line\r\n    }, [props]);\r\n\r\n    const handleClick = (obj) => {\r\n        props.history.push(`/top_list?${obj.key}`);\r\n    }\r\n\r\n    const tableTitle = () => {\r\n        return (\r\n            <>\r\n                <div style={{fontWeight: 'bold', fontSize: '25px', display: 'inline', marginRight: '20px'}}>{title}</div>\r\n                <div style={{fontSize: '15px', display: 'inline'}}>每日更新</div>\r\n            </>\r\n\r\n        )\r\n    }\r\n\r\n    return (\r\n        <Layout>\r\n            <Sider style={{width: 250}}>\r\n                <Menu mode=\"inline\" defaultSelectedKeys=\"type=total\" style={{height: '100%'}} onClick={handleClick} defaultOpenKeys={['0', '1', '2']} selectedKeys={selectedKeys}>\r\n                    <Menu.Item key=\"type=total\">总榜</Menu.Item>\r\n                    <Menu.Item key=\"type=0\">华语榜</Menu.Item>\r\n                    <Menu.Item key=\"type=1\">欧美榜</Menu.Item>\r\n                    <Menu.Item key=\"type=2\">日韩榜</Menu.Item>\r\n                </Menu>\r\n            </Sider>\r\n            <Content style={{ minHeight: 280}}>\r\n                <Table dataSource={data} columns={colomns} rowKey={record => record.musicId} pagination={false} title={tableTitle} />\r\n            </Content>\r\n        </Layout>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}