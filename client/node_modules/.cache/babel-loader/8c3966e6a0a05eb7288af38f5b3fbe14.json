{"ast":null,"code":"var _jsxFileName = \"D:\\\\Programming\\\\Project\\\\MusicRecommendSystem\\\\front\\\\src\\\\components\\\\PlayBar\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification } from 'antd';\nimport PubSub from 'pubsub-js';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { getToken } from '../../utils/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default class PlayBar extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      // 播放列表\n      playList: [],\n      // 当前播放序号\n      index: 0,\n      paused: true,\n      currentTime: 0,\n      duration: 0,\n      volume: 1,\n      beginTime: new Date().getTime(),\n      isCollectionListModalVisible: false,\n      collectionList: [],\n      isNewCollectionListModalVisible: false\n    };\n\n    this.playMusic = (msg, data) => {\n      this.addPlayTimes();\n      const playList = this.state.playList;\n\n      for (let i = 0; i < playList.length; i++) {\n        if (playList[i].musicId === data.musicId) {\n          this.setState({\n            index: i\n          });\n          return;\n        }\n      }\n\n      const newPlayList = [...playList, data];\n      this.setState({\n        playList: newPlayList,\n        index: newPlayList.length - 1\n      });\n    };\n\n    this.playBackward = () => {\n      this.addPlayTimes();\n      const newIndex = (this.state.index - 1 + this.state.playList.length) % this.state.playList.length;\n      this.setState({\n        index: newIndex\n      });\n    };\n\n    this.playOrPause = () => {\n      this.state.paused ? this.audio1.play() : this.audio1.pause();\n      this.setState(state => {\n        return {\n          paused: !state.paused\n        };\n      });\n    };\n\n    this.playForward = () => {\n      this.addPlayTimes();\n      const newIndex = (this.state.index + 1) % this.state.playList.length;\n      this.setState({\n        index: newIndex\n      });\n    };\n\n    this.changeMusic = obj => {\n      // console.log(obj.key);\n      this.addPlayTimes();\n      const index = this.state.playList.findIndex(music => {\n        return music.musicId === obj.key;\n      });\n      this.setState({\n        index\n      });\n    };\n\n    this.createPlayList = () => {\n      if (this.state.playList.length > 0) {\n        return /*#__PURE__*/_jsxDEV(Menu, {\n          selectedKeys: [this.state.playList[this.state.index].musicId],\n          onClick: this.changeMusic,\n          style: {\n            width: '800px',\n            height: '300px',\n            overflow: 'scroll',\n            overflowX: 'hidden'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n            style: {\n              width: '750px'\n            },\n            children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", this.state.playList.length, \")\"]\n          }, \"title\", true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 21\n          }, this), this.state.playList.map(music => {\n            return /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      width: '450px'\n                    },\n                    children: music.musicName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 88,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      width: '250px'\n                    },\n                    children: music.artistName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 89,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      width: '50px'\n                    },\n                    children: this.parseTime(music.timeLength / 1000)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 90,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 87,\n                  columnNumber: 37\n                }, this)\n              }, music.musicId, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 93,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 17\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(Menu, {\n          children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n            style: {\n              width: '650px'\n            },\n            children: [\"\\u64AD\\u653E\\u5217\\u8868 (\", this.state.playList.length, \")\"]\n          }, \"title\", true, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 17\n        }, this);\n      }\n    };\n\n    this.canPlay = () => {\n      this.setState({\n        duration: this.audio1.duration,\n        paused: false,\n        volume: this.audio1.volume,\n        beginTime: new Date().getTime()\n      });\n      this.audio1.play();\n    };\n\n    this.updatePlayTime = () => {\n      this.setState({\n        currentTime: this.audio1.currentTime\n      });\n    };\n\n    this.addPlayTimes = () => {\n      if (this.state.playList.length > 0) {\n        const endTime = new Date().getTime();\n\n        if (endTime - this.state.beginTime >= 60000) {\n          axios({\n            method: 'POST',\n            url: 'http://localhost:3001/server/music/play_times',\n            data: {\n              musicId: this.state.playList[this.state.index].musicId\n            }\n          }).then(response => {\n            console.log(response.data);\n          });\n        }\n      }\n    };\n\n    this.changePlayTime = event => {\n      this.audio1.currentTime = event.target.value;\n    };\n\n    this.parseTime = time => {\n      var min = Math.floor(time / 60);\n\n      if (min < 10) {\n        min = '0' + min;\n      }\n\n      var sec = Math.floor(time % 60);\n\n      if (sec < 10) {\n        sec = '0' + sec;\n      }\n\n      return min + ':' + sec;\n    };\n\n    this.updateVolume = () => {\n      this.setState({\n        volume: this.audio1.volume\n      });\n    };\n\n    this.mute = () => {\n      if (this.state.playList.length > 0) {\n        this.audio1.volume = this.audio1.volume > 0 ? 0 : 1;\n      }\n    };\n\n    this.changeVolume = event => {\n      // this.setState({volume: parseInt(event.target.value)});\n      // if (this.state.playList.length > 0) {\n      //     this.audio1.volume = event.target.value;\n      // }\n      this.audio1.volume = event.target.value;\n    };\n\n    this.showCollectionListModal = () => {\n      const token = getToken();\n\n      if (!token) {\n        PubSub.publish('showLoginModal');\n      } else {\n        axios({\n          method: 'GET',\n          url: 'http://localhost:3001/server/collection_list',\n          headers: {\n            Authorization: token\n          }\n        }).then(response => {\n          if (response.data.status !== 1) {\n            PubSub.publish('showLoginModal');\n          } else {\n            this.setState({\n              collectionList: response.data.data\n            }, () => {\n              this.setState({\n                isCollectionListModalVisible: true\n              });\n            });\n          }\n        });\n      }\n    };\n\n    this.closeCollectionListModal = () => {\n      this.setState({\n        isCollectionListModalVisible: false\n      });\n    };\n\n    this.showNewCollectionListModal = () => {\n      this.closeCollectionListModal();\n      this.setState({\n        isNewCollectionListModalVisible: true\n      });\n    };\n\n    this.closeNewCollectionListModal = () => {\n      this.setState({\n        isNewCollectionListModalVisible: false\n      });\n    };\n\n    this.handleCollection = obj => {\n      if (this.state.playList.length > 0) {\n        const music = this.state.playList[this.state.index];\n\n        if (obj.key === 'newList') {\n          this.showNewCollectionListModal();\n        } else {\n          this.insertMusicToCollectionList(obj.key, music.musicId);\n        }\n      }\n\n      this.closeCollectionListModal();\n    };\n\n    this.insertMusicToCollectionList = (collectionListId, musicId) => {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:3001/server/collection_list/music',\n        headers: {\n          Authorization: getToken()\n        },\n        data: {\n          collectionListId: collectionListId,\n          musicId: musicId\n        }\n      }).then(response => {\n        console.log(response);\n      });\n    };\n\n    this.insertCollectionList = values => {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:3001/server/collection_list',\n        headers: {\n          Authorization: getToken()\n        },\n        data: {\n          collectionListName: values.collectionListName\n        }\n      }).then(response => {\n        console.log(response);\n\n        if (response.data.status === 1) {\n          this.insertMusicToCollectionList(response.data.data, this.state.playList[this.state.index].musicId);\n        }\n      });\n      this.closeNewCollectionListModal();\n    };\n  }\n\n  componentDidMount() {\n    this.token = PubSub.subscribe('play', this.playMusic);\n  }\n\n  componentWillUnmount() {\n    PubSub.unsubscribe(this.token);\n  } // 收到通知，播放音乐，data为music对象\n\n\n  render() {\n    const {\n      currentTime,\n      duration,\n      volume,\n      playList,\n      index,\n      isCollectionListModalVisible,\n      collectionList,\n      isNewCollectionListModalVisible\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'fixed',\n          left: 0,\n          bottom: 0,\n          height: '60px',\n          backgroundColor: 'black',\n          width: '100%'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: '5px auto',\n            width: '1000px',\n            display: 'flex'\n          },\n          id: \"playBar\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            shape: \"circle\",\n            style: {\n              backgroundColor: 'black',\n              margin: 'auto 5px',\n              borderWidth: '2px'\n            },\n            onClick: this.playBackward,\n            children: /*#__PURE__*/_jsxDEV(StepBackwardOutlined, {\n              style: {\n                color: 'white',\n                fontSize: '25px',\n                marginTop: '-2px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            shape: \"circle\",\n            style: {\n              backgroundColor: 'black',\n              margin: 'auto 5px',\n              borderWidth: '2px'\n            },\n            onClick: this.playOrPause,\n            size: \"large\",\n            children: this.state.paused ? /*#__PURE__*/_jsxDEV(CaretRightOutlined, {\n              style: {\n                color: 'white',\n                fontSize: '32px',\n                marginLeft: '4px',\n                marginTop: '-4px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 50\n            }, this) : /*#__PURE__*/_jsxDEV(PauseOutlined, {\n              style: {\n                color: 'white',\n                fontSize: '32px',\n                marginLeft: '1px',\n                marginTop: '-4.5px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 156\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            shape: \"circle\",\n            style: {\n              backgroundColor: 'black',\n              margin: 'auto 5px',\n              borderWidth: '2px'\n            },\n            onClick: this.playForward,\n            children: /*#__PURE__*/_jsxDEV(StepForwardOutlined, {\n              style: {\n                color: 'white',\n                fontSize: '25px',\n                marginTop: '-2px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 25\n          }, this), playList.length > 0 ? /*#__PURE__*/_jsxDEV(Link, {\n            to: `/album/${playList[index].albumId}`,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              alt: playList[index].musicName,\n              src: playList[index].albumImg,\n              style: {\n                width: '50px',\n                height: '50px',\n                margin: '0 10px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 25\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: \"718\\u97F3\\u4E50\",\n            src: \"/favicon.ico\",\n            style: {\n              width: '50px',\n              height: '50px',\n              margin: '0 10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 27\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '550px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#e8e8e8'\n              },\n              children: [playList.length > 0 ? playList[index].musicName : '718音乐', playList.length > 0 && /*#__PURE__*/_jsxDEV(Link, {\n                to: `/artist/${playList[index].artistId}`,\n                style: {\n                  color: '#9b9b9b'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    fontSize: '10px',\n                    marginLeft: '20px'\n                  },\n                  children: playList[index].artistName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 133\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 57\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"barAndTime\",\n              style: {\n                marginTop: '8px',\n                width: '550px',\n                display: 'flex'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bar\",\n                style: {\n                  width: '450px',\n                  height: '10px',\n                  marginTop: '7px',\n                  display: 'flex'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"range\",\n                  max: duration,\n                  value: currentTime,\n                  style: {\n                    backgroundColor: 'red',\n                    height: '10px',\n                    width: '450px',\n                    marginBottom: '5px'\n                  },\n                  onChange: this.changePlayTime\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 291,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"time\",\n                style: {\n                  color: 'white',\n                  marginLeft: '5px'\n                },\n                children: [this.parseTime(currentTime), \"/\", this.parseTime(duration)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              margin: 'auto 5px'\n            },\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              icon: /*#__PURE__*/_jsxDEV(HeartOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 43\n              }, this),\n              title: \"\\u6536\\u85CF\",\n              ghost: true,\n              size: \"small\",\n              style: {\n                border: '0'\n              },\n              onClick: this.showCollectionListModal\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n            overlay: this.createPlayList,\n            placement: \"topCenter\",\n            arrow: true,\n            getPopupContainer: () => document.getElementById('playBar'),\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              style: {\n                marginTop: '10px',\n                border: '0'\n              },\n              icon: /*#__PURE__*/_jsxDEV(UnorderedListOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 84\n              }, this),\n              ghost: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"volumeCtrl\",\n            style: {\n              marginLeft: '10px',\n              display: 'flex'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              icon: volume !== 0 ? /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-volume-up\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 58\n              }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-volume-off\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 96\n              }, this),\n              style: {\n                marginTop: '10px',\n                border: '0'\n              },\n              ghost: true,\n              onClick: this.mute\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"range\",\n              step: \"0.01\",\n              max: \"1\",\n              value: volume,\n              onChange: this.changeVolume\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        src: playList.length > 0 ? playList[index].playUrl : '',\n        proload: \"auto\",\n        onCanPlay: this.canPlay,\n        onTimeUpdate: this.updatePlayTime,\n        onVolumeChange: this.updateVolume,\n        onEnded: this.playForward,\n        ref: r => this.audio1 = r\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        title: \"\\u6DFB\\u52A0\\u5230\\u6B4C\\u5355\",\n        onCancel: this.closeCollectionListModal,\n        visible: isCollectionListModalVisible,\n        okText: \"\\u786E\\u8BA4\",\n        cancelText: \"\\u53D6\\u6D88\",\n        footer: null,\n        children: /*#__PURE__*/_jsxDEV(Menu, {\n          onClick: this.handleCollection,\n          style: {\n            width: '480px',\n            height: '400px',\n            overflow: 'scroll',\n            overflowX: 'hidden'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n            icon: /*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 56\n            }, this),\n            children: \"\\u65B0\\u6B4C\\u5355\"\n          }, \"newList\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 25\n          }, this), collectionList.map(list => {\n            return /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n                style: {\n                  height: '50px'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(Image, {\n                    style: {\n                      width: '50px',\n                      height: '50px'\n                    },\n                    src: list.collectionListImg\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 321,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      width: '250px',\n                      margin: 'auto 20px'\n                    },\n                    children: list.collectionListName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 322,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      width: '100px',\n                      margin: 'auto 10px'\n                    },\n                    children: list.musicVOList.length + '首'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 323,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 41\n                }, this)\n              }, list.collectionListId, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Menu.Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        title: \"\\u65B0\\u5EFA\\u6B4C\\u5355\",\n        onCancel: this.closeNewCollectionListModal,\n        visible: isNewCollectionListModalVisible,\n        footer: null,\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          onFinish: this.insertCollectionList,\n          children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n            label: \"\\u6B4C\\u5355\\u540D\",\n            name: \"collectionListName\",\n            rules: [{\n              required: true,\n              message: '歌单名不能为空'\n            }],\n            children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n            wrapperCol: {\n              offset: 8,\n              span: 16\n            },\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"primary\",\n              htmlType: \"submit\",\n              children: \"\\u65B0\\u5EFA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n\n}","map":{"version":3,"sources":["D:/Programming/Project/MusicRecommendSystem/front/src/components/PlayBar/index.jsx"],"names":["React","Component","StepBackwardOutlined","StepForwardOutlined","CaretRightOutlined","PauseOutlined","UnorderedListOutlined","HeartOutlined","PlusCircleOutlined","Button","Dropdown","Menu","Modal","Image","Form","Input","notification","PubSub","axios","Link","getToken","PlayBar","state","playList","index","paused","currentTime","duration","volume","beginTime","Date","getTime","isCollectionListModalVisible","collectionList","isNewCollectionListModalVisible","playMusic","msg","data","addPlayTimes","i","length","musicId","setState","newPlayList","playBackward","newIndex","playOrPause","audio1","play","pause","playForward","changeMusic","obj","findIndex","music","key","createPlayList","width","height","overflow","overflowX","map","display","musicName","artistName","parseTime","timeLength","canPlay","updatePlayTime","endTime","method","url","then","response","console","log","changePlayTime","event","target","value","time","min","Math","floor","sec","updateVolume","mute","changeVolume","showCollectionListModal","token","publish","headers","Authorization","status","closeCollectionListModal","showNewCollectionListModal","closeNewCollectionListModal","handleCollection","insertMusicToCollectionList","collectionListId","insertCollectionList","values","collectionListName","componentDidMount","subscribe","componentWillUnmount","unsubscribe","render","position","left","bottom","backgroundColor","margin","borderWidth","color","fontSize","marginTop","marginLeft","albumId","albumImg","artistId","marginBottom","border","document","getElementById","playUrl","r","list","collectionListImg","musicVOList","required","message","offset","span"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport {StepBackwardOutlined, StepForwardOutlined, CaretRightOutlined, PauseOutlined, UnorderedListOutlined, HeartOutlined, PlusCircleOutlined} from '@ant-design/icons';\r\nimport { Button, Dropdown, Menu, Modal, Image, Form, Input, notification } from 'antd'\r\nimport PubSub from 'pubsub-js';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport { getToken } from '../../utils/auth';\r\n\r\nexport default class PlayBar extends Component {\r\n    state = {\r\n        // 播放列表\r\n        playList: [],\r\n        // 当前播放序号\r\n        index: 0,\r\n        paused: true,\r\n        currentTime: 0,\r\n        duration: 0,\r\n        volume: 1,\r\n        beginTime: new Date().getTime(),\r\n        isCollectionListModalVisible: false,\r\n        collectionList: [],\r\n        isNewCollectionListModalVisible: false\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.token = PubSub.subscribe('play', this.playMusic);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        PubSub.unsubscribe(this.token);\r\n    }\r\n\r\n    // 收到通知，播放音乐，data为music对象\r\n    playMusic = (msg, data) => {\r\n        this.addPlayTimes();\r\n        const playList = this.state.playList;\r\n        for (let i = 0; i < playList.length; i++) {\r\n            if (playList[i].musicId === data.musicId) {\r\n                this.setState({index: i});\r\n                return;\r\n            }\r\n        }\r\n        const newPlayList = [...playList, data];\r\n        this.setState({playList: newPlayList, index: newPlayList.length - 1});\r\n    }\r\n\r\n    playBackward = () => {\r\n        this.addPlayTimes();\r\n        const newIndex = (this.state.index - 1 + this.state.playList.length) % this.state.playList.length;\r\n        this.setState({index: newIndex});\r\n    }\r\n    \r\n    playOrPause = () => {\r\n        this.state.paused ? this.audio1.play() : this.audio1.pause();\r\n        this.setState((state) => {\r\n            return {paused: !state.paused};\r\n        });\r\n    }\r\n\r\n    playForward = () => {\r\n        this.addPlayTimes();\r\n        const newIndex = (this.state.index + 1) % this.state.playList.length;\r\n        this.setState({index: newIndex});\r\n    }\r\n\r\n    // 播放列表切换歌\r\n    changeMusic = (obj) => {\r\n        // console.log(obj.key);\r\n        this.addPlayTimes();\r\n        const index = this.state.playList.findIndex((music) => {\r\n            return music.musicId === obj.key;\r\n        });\r\n        this.setState({index});\r\n    }\r\n\r\n    // 播放列表\r\n    createPlayList = () => {\r\n        if (this.state.playList.length > 0) {\r\n            return (\r\n                <Menu selectedKeys={[this.state.playList[this.state.index].musicId]} onClick={this.changeMusic} style={{width: '800px', height: '300px', overflow: 'scroll', overflowX: 'hidden'}}>\r\n                    <Menu.Item key=\"title\" style={{width: '750px'}}>播放列表 ({this.state.playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                    {this.state.playList.map((music) => {\r\n                        return (\r\n                            <>\r\n                                <Menu.Item key={music.musicId}>\r\n                                    <div style={{display: 'flex'}}>\r\n                                        <div style={{width: '450px'}}>{music.musicName}</div>\r\n                                        <div style={{width: '250px'}}>{music.artistName}</div>\r\n                                        <div style={{width: '50px'}}>{this.parseTime(music.timeLength / 1000)}</div>\r\n                                    </div>\r\n                                </Menu.Item>\r\n                                <Menu.Divider />\r\n                            </>\r\n                        );\r\n                    })}\r\n                </Menu>\r\n            );\r\n        } else {\r\n            return (\r\n                <Menu>\r\n                    <Menu.Item key=\"title\" style={{width: '650px'}}>播放列表 ({this.state.playList.length})</Menu.Item>\r\n                    <Menu.Divider />\r\n                </Menu>\r\n            );\r\n        }\r\n        \r\n    }\r\n\r\n    // 音乐加载完毕，可以播放\r\n    canPlay = () => {\r\n        this.setState({duration: this.audio1.duration, paused: false, volume: this.audio1.volume, beginTime: new Date().getTime()});\r\n        this.audio1.play();\r\n    }\r\n\r\n    // audio更新state时间\r\n    updatePlayTime = () => {\r\n        this.setState({currentTime: this.audio1.currentTime});\r\n    }\r\n\r\n    // 停留时间超过1分钟，增加播放量，换歌的时候执行\r\n    addPlayTimes = () => {\r\n        if (this.state.playList.length > 0) {\r\n            const endTime = new Date().getTime();\r\n            if (endTime - this.state.beginTime >= 60000) {\r\n                axios({\r\n                    method: 'POST',\r\n                    url: 'http://localhost:3001/server/music/play_times',\r\n                    data: {\r\n                        musicId: this.state.playList[this.state.index].musicId\r\n                    }\r\n                }).then((response) => {\r\n                    console.log(response.data);\r\n                });\r\n            }\r\n        }\r\n    }\r\n    \r\n    // 拖动条更新时间\r\n    changePlayTime = (event) => {\r\n        this.audio1.currentTime = event.target.value;\r\n    }\r\n    \r\n    // 解析时间成00:00格式, time以秒为单位\r\n    parseTime = (time) => {\r\n        var min = Math.floor(time / 60);\r\n        if (min < 10) {\r\n            min = '0' + min;\r\n        }\r\n        var sec = Math.floor(time % 60);\r\n        if (sec < 10) {\r\n            sec = '0' + sec;\r\n        }\r\n        return min + ':' + sec;\r\n    }\r\n    \r\n    // audio更新音量\r\n    updateVolume = () => {\r\n        this.setState({volume: this.audio1.volume});\r\n    }\r\n\r\n    // 静音或者音量最大\r\n    mute = () => {\r\n        if (this.state.playList.length > 0) {\r\n            this.audio1.volume = this.audio1.volume > 0 ? 0 : 1;\r\n        }\r\n    }\r\n\r\n    changeVolume = (event) => {\r\n        // this.setState({volume: parseInt(event.target.value)});\r\n        // if (this.state.playList.length > 0) {\r\n        //     this.audio1.volume = event.target.value;\r\n        // }\r\n        this.audio1.volume = event.target.value;\r\n    }\r\n\r\n    showCollectionListModal = () => {\r\n        const token = getToken();\r\n        if (!token) {\r\n            PubSub.publish('showLoginModal');\r\n        } else{\r\n            axios({\r\n                method: 'GET',\r\n                url: 'http://localhost:3001/server/collection_list',\r\n                headers: {\r\n                    Authorization: token\r\n                }\r\n            }).then((response) => {\r\n                if (response.data.status !== 1) {\r\n                    PubSub.publish('showLoginModal');\r\n                } else{\r\n                    this.setState({collectionList: response.data.data}, () => {\r\n                        this.setState({isCollectionListModalVisible: true});\r\n                    });\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    closeCollectionListModal = () => {\r\n        this.setState({isCollectionListModalVisible: false});\r\n    }\r\n\r\n    showNewCollectionListModal = () => {\r\n        this.closeCollectionListModal();\r\n        this.setState({isNewCollectionListModalVisible: true});\r\n    }\r\n\r\n    closeNewCollectionListModal = () => {\r\n        this.setState({isNewCollectionListModalVisible: false});\r\n    }\r\n\r\n    handleCollection = (obj) => {\r\n        if (this.state.playList.length > 0) {\r\n            const music = this.state.playList[this.state.index];\r\n            if (obj.key === 'newList') {\r\n                this.showNewCollectionListModal();\r\n            } else {\r\n                this.insertMusicToCollectionList(obj.key, music.musicId);\r\n            }\r\n        }\r\n        this.closeCollectionListModal();\r\n    }\r\n\r\n    insertMusicToCollectionList = (collectionListId, musicId) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: 'http://localhost:3001/server/collection_list/music',\r\n            headers: {\r\n                Authorization: getToken()\r\n            },\r\n            data: {\r\n                collectionListId: collectionListId,\r\n                musicId: musicId\r\n            }\r\n        }).then((response) => {\r\n            console.log(response);\r\n        })\r\n    }\r\n\r\n    insertCollectionList = (values) => {\r\n        axios({\r\n            method: 'POST',\r\n            url: 'http://localhost:3001/server/collection_list',\r\n            headers: {\r\n                Authorization: getToken()\r\n            },\r\n            data: {\r\n                collectionListName: values.collectionListName\r\n            }\r\n        }).then((response) => {\r\n            console.log(response);\r\n            if (response.data.status === 1) {\r\n                this.insertMusicToCollectionList(response.data.data, this.state.playList[this.state.index].musicId);\r\n            }\r\n        });\r\n        this.closeNewCollectionListModal();\r\n    }\r\n\r\n    \r\n\r\n    \r\n\r\n    render() {\r\n        const {currentTime, duration, volume, playList, index, isCollectionListModalVisible, collectionList, isNewCollectionListModalVisible} = this.state;\r\n        return (\r\n            <>\r\n                <div style={{position: 'fixed', left: 0, bottom: 0, height: '60px', backgroundColor: 'black', width: '100%'}}>\r\n                    <div style={{margin: '5px auto', width: '1000px', display: 'flex'}} id=\"playBar\">\r\n                        <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={this.playBackward}>\r\n                            <StepBackwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                        </Button>\r\n                        <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={this.playOrPause} size=\"large\">\r\n                            {this.state.paused ? <CaretRightOutlined style={{color: 'white', fontSize: '32px', marginLeft: '4px', marginTop: '-4px'}} /> : <PauseOutlined style={{color: 'white', fontSize: '32px', marginLeft: '1px', marginTop: '-4.5px'}} />}\r\n                        </Button>\r\n                        <Button shape='circle' style={{backgroundColor: 'black', margin: 'auto 5px', borderWidth: '2px'}} onClick={this.playForward}>\r\n                            <StepForwardOutlined style={{color: 'white', fontSize: '25px', marginTop: '-2px'}} />\r\n                        </Button>\r\n                        {playList.length > 0 ? \r\n                        <Link to={`/album/${playList[index].albumId}`}>\r\n                            <img alt={playList[index].musicName} src={playList[index].albumImg} style={{width: '50px', height: '50px', margin: '0 10px'}} />\r\n                        </Link> \r\n                        : <img alt=\"718音乐\" src=\"/favicon.ico\" style={{width: '50px', height: '50px', margin: '0 10px'}} />}\r\n                        <div style={{width: '550px'}}>\r\n                            <div style={{color: '#e8e8e8'}}>\r\n                                {playList.length > 0 ? playList[index].musicName : '718音乐'}\r\n                                {playList.length > 0 && <Link to={`/artist/${playList[index].artistId}`} style={{color: '#9b9b9b'}}><span style={{fontSize: '10px', marginLeft: '20px'}}>{playList[index].artistName}</span></Link>}\r\n                            </div>\r\n                            <div className=\"barAndTime\" style={{marginTop: '8px', width: '550px', display: 'flex'}}>\r\n                                <div className=\"bar\" style={{width: '450px', height: '10px', marginTop: '7px', display: 'flex'}}>\r\n                                    <input type=\"range\" max={duration} value={currentTime} style={{backgroundColor: 'red', height: '10px', width: '450px', marginBottom: '5px'}} onChange={this.changePlayTime} />\r\n                                    {/* <Button shape=\"circle\" icon={<FireOutlined />} type=\"primary\" size=\"small\" style={{marginLeft: '-12px', marginTop: '-6px'}} /> */}\r\n                                </div>\r\n                                <div className=\"time\" style={{color: 'white', marginLeft: '5px'}}>{this.parseTime(currentTime)}/{this.parseTime(duration)}</div>\r\n                            </div>\r\n                        </div>\r\n                        <div style={{margin: 'auto 5px'}}>\r\n                            <Button icon={<HeartOutlined />} title=\"收藏\" ghost size=\"small\" style={{border: '0'}} onClick={this.showCollectionListModal} />\r\n                        </div>\r\n                        <Dropdown overlay={this.createPlayList} placement=\"topCenter\" arrow getPopupContainer={() => document.getElementById('playBar')}>\r\n                            <Button style={{marginTop: '10px', border: '0'}} icon={<UnorderedListOutlined />} ghost></Button>\r\n                        </Dropdown>\r\n                        <div className=\"volumeCtrl\" style={{marginLeft: '10px', display: 'flex'}}>\r\n                            <Button icon={volume !== 0 ? <i className=\"fa fa-volume-up\"></i> : <i className=\"fa fa-volume-off\"></i>} style={{marginTop: '10px', border: '0'}} ghost onClick={this.mute} />\r\n                            <input type=\"range\" step=\"0.01\" max=\"1\" value={volume} onChange={this.changeVolume} />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <audio src={playList.length > 0 ? playList[index].playUrl : ''} proload=\"auto\" onCanPlay={this.canPlay} onTimeUpdate={this.updatePlayTime} onVolumeChange={this.updateVolume} onEnded={this.playForward} ref={r => this.audio1 = r}></audio>\r\n                <Modal title=\"添加到歌单\" onCancel={this.closeCollectionListModal} visible={isCollectionListModalVisible} okText=\"确认\" cancelText=\"取消\" footer={null}>\r\n                    <Menu onClick={this.handleCollection} style={{width: '480px', height: '400px', overflow: 'scroll', overflowX: 'hidden'}}>\r\n                        <Menu.Item key=\"newList\" icon={<PlusCircleOutlined />}>\r\n                            新歌单\r\n                        </Menu.Item>\r\n                        <Menu.Divider />\r\n                        {collectionList.map((list) => {\r\n                            return (\r\n                                <>\r\n                                    <Menu.Item key={list.collectionListId} style={{height: '50px'}}>\r\n                                        <div style={{display: 'flex'}}>\r\n                                            <Image style={{width: '50px', height: '50px'}} src={list.collectionListImg} />\r\n                                            <div style={{width: '250px', margin: 'auto 20px'}}>{list.collectionListName}</div>\r\n                                            <div style={{width: '100px', margin: 'auto 10px'}}>{list.musicVOList.length + '首'}</div>\r\n                                        </div>\r\n                                    </Menu.Item>\r\n                                    <Menu.Divider />\r\n                                </>\r\n                            );\r\n                        })}\r\n                    </Menu> \r\n                </Modal>\r\n                <Modal title=\"新建歌单\" onCancel={this.closeNewCollectionListModal} visible={isNewCollectionListModalVisible} footer={null}>\r\n                    <Form onFinish={this.insertCollectionList}>\r\n                        <Form.Item label=\"歌单名\" name=\"collectionListName\" rules={[{ required: true, message: '歌单名不能为空' }]}>\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <Form.Item wrapperCol={{ offset: 8, span: 16 }}>\r\n                            <Button type=\"primary\" htmlType=\"submit\">新建</Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Modal>\r\n            </>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}